<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="summary"><title>VB-Note | Yun.Qi</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.png"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">VB-Note</h1><a id="logo" href="/.">Yun.Qi</a><p class="summary">Note/Diary</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/diary/"><i class="fa fa-book"> Diary</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">VB-Note</h1><div class="post-meta">2020-02-16<span> | </span><span class="category"><a href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 7,614</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 35</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#5-正式学习"><span class="toc-text">5. 正式学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-基础知识（零碎）"><span class="toc-text">5.1 基础知识（零碎）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#If-判断结构"><span class="toc-text">If 判断结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-VB-的语言成分"><span class="toc-text">5.2 VB 的语言成分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1-基本数据类型"><span class="toc-text">5.2.1 基本数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-直接常量"><span class="toc-text">5.2.2 直接常量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-3-变量"><span class="toc-text">5.2.3 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-4-模块"><span class="toc-text">5.2.4 模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-5-变量的作用域"><span class="toc-text">5.2.5 变量的作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-6-变量类型检查"><span class="toc-text">5.2.6 变量类型检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-7-运算符"><span class="toc-text">5.2.7 运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-8-常用内部函数"><span class="toc-text">5.2.8 常用内部函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-9-日期函数"><span class="toc-text">5.2.9 日期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-10-基本语句"><span class="toc-text">5.2.10 基本语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-10-1-赋值语句"><span class="toc-text">5.2.10.1 赋值语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-10-2-快速输入输出函数"><span class="toc-text">5.2.10.2 快速输入输出函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-控制结构与算法"><span class="toc-text">5.3 控制结构与算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-顺序结构"><span class="toc-text">5.3.1 顺序结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-选择结构"><span class="toc-text">5.3.2 选择结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-1-if"><span class="toc-text">5.3.2.1 if</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-2-select"><span class="toc-text">5.3.2.2 select</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-循环结构"><span class="toc-text">5.3.3 循环结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-3-1-for-next-循环"><span class="toc-text">5.3.3.1 for next 循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-3-2-do…loop-循环结构"><span class="toc-text">5.3.3.2 do…loop 循环结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-3-3-循环嵌套"><span class="toc-text">5.3.3.3 循环嵌套</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-4-goto-语句"><span class="toc-text">5.3.4 goto 语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-数组"><span class="toc-text">5.4 数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-1-数组"><span class="toc-text">5.4.1 数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-2-数组定义"><span class="toc-text">5.4.2 数组定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-1-定义形式"><span class="toc-text">5.4.2.1 定义形式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-2-动态数组的建立与使用"><span class="toc-text">5.4.2.2 动态数组的建立与使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-3-控件数组"><span class="toc-text">5.4.2.3 控件数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-4-数组元素的复制"><span class="toc-text">5.4.2.4 数组元素的复制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-5-for-each-…-next"><span class="toc-text">5.4.2.5 for each … next</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-3-数组应用举例"><span class="toc-text">5.4.3 数组应用举例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-3-1-例子-1"><span class="toc-text">5.4.3.1 例子 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-3-2-例子-2"><span class="toc-text">5.4.3.2 例子 2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-过程"><span class="toc-text">5.5 过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-1-子过程和函数过程"><span class="toc-text">5.5.1 子过程和函数过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-2-参数的传递"><span class="toc-text">5.5.2 参数的传递</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-3-代码模块"><span class="toc-text">5.5.3 代码模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-1-窗体模块"><span class="toc-text">5.5.3.1 窗体模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-2-标准模块"><span class="toc-text">5.5.3.2 标准模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-3-类模块"><span class="toc-text">5.5.3.3 类模块</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-4-过程的作用域"><span class="toc-text">5.5.4 过程的作用域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-用户界面设计"><span class="toc-text">5.6 用户界面设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-1-单选按钮和复选框"><span class="toc-text">5.6.1 单选按钮和复选框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-2-框架-Frame"><span class="toc-text">5.6.2 框架 Frame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-3-滚动条"><span class="toc-text">5.6.3 滚动条</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-4-列表框"><span class="toc-text">5.6.4 列表框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-5-组合框"><span class="toc-text">5.6.5 组合框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-6-驱动器列表框、目录列表框、文件列表框"><span class="toc-text">5.6.6 驱动器列表框、目录列表框、文件列表框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-7-通用对话框"><span class="toc-text">5.6.7 通用对话框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-8-菜单设计"><span class="toc-text">5.6.8 菜单设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-9-多重窗体"><span class="toc-text">5.6.9 多重窗体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-10-鼠标-键盘事件"><span class="toc-text">5.6.10 鼠标&#x2F;键盘事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-11-对象拖放与-OLE-拖放"><span class="toc-text">5.6.11 对象拖放与 OLE 拖放</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7-Active-X-控件"><span class="toc-text">5.7 Active X 控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-1-SSTab-选项卡控件"><span class="toc-text">5.7.1 SSTab 选项卡控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-2-ProgressBar-进度条控件"><span class="toc-text">5.7.2 ProgressBar 进度条控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-3-Slide-滑动条控件"><span class="toc-text">5.7.3 Slide 滑动条控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-4-MS-Chart-控件"><span class="toc-text">5.7.4 MS Chart 控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-5-UpDown-控件"><span class="toc-text">5.7.5 UpDown 控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-6-ActiveX-控件的创建"><span class="toc-text">5.7.6 ActiveX 控件的创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-8-文件"><span class="toc-text">5.8 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-1-顺序文件"><span class="toc-text">5.8.1 顺序文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-1-1-顺序文件打开"><span class="toc-text">5.8.1.1 顺序文件打开</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-1-2-顺序文件关闭"><span class="toc-text">5.8.1.2 顺序文件关闭</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-1-3-顺序文件的读写"><span class="toc-text">5.8.1.3 顺序文件的读写</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-2-随机文件"><span class="toc-text">5.8.2 随机文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-2-1-随机文件打开"><span class="toc-text">5.8.2.1 随机文件打开</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-2-2-随机文件关闭"><span class="toc-text">5.8.2.2 随机文件关闭</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-2-3-随机文件写"><span class="toc-text">5.8.2.3 随机文件写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8-2-4-随机文件读"><span class="toc-text">5.8.2.4 随机文件读</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-8-3-总结"><span class="toc-text">5.8.3 总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-9-绘图"><span class="toc-text">5.9 绘图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9-1-图形设计基础"><span class="toc-text">5.9.1 图形设计基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-1-1-坐标系统"><span class="toc-text">5.9.1.1 坐标系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-1-2-颜色"><span class="toc-text">5.9.1.2 颜色</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9-2-图形控件"><span class="toc-text">5.9.2 图形控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-2-1-Picture控件"><span class="toc-text">5.9.2.1 Picture控件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-2-2-Image控件"><span class="toc-text">5.9.2.2 Image控件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-2-3-Shape控件"><span class="toc-text">5.9.2.3 Shape控件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-2-4-Line控件"><span class="toc-text">5.9.2.4 Line控件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-9-3-绘图方法"><span class="toc-text">5.9.3 绘图方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-3-1-画点方法Pset"><span class="toc-text">5.9.3.1 画点方法Pset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-3-2-画线、画矩形Line"><span class="toc-text">5.9.3.2 画线、画矩形Line</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-3-3-画圆-Circle"><span class="toc-text">5.9.3.3 画圆 Circle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9-3-4-使用point方法返回指定点的颜色"><span class="toc-text">5.9.3.4 使用point方法返回指定点的颜色</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-10-高级界面设计"><span class="toc-text">5.10 高级界面设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-10-1-多文档界面MDI"><span class="toc-text">5.10.1 多文档界面MDI</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-11-开发多媒体应用程序"><span class="toc-text">5.11 开发多媒体应用程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-12-数据库访问技术"><span class="toc-text">5.12 数据库访问技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-12-1-关系型数据库"><span class="toc-text">5.12.1 关系型数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-12-2-用可视化数据管理器建立和维护数据库"><span class="toc-text">5.12.2 用可视化数据管理器建立和维护数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-13-总复习"><span class="toc-text">5.13 总复习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-13-1-同心圆"><span class="toc-text">5.13.1 同心圆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-13-2-两圆转动"><span class="toc-text">5.13.2 两圆转动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-13-3-密码输入，文本框飘动"><span class="toc-text">5.13.3 密码输入，文本框飘动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-13-4-网络连接计时"><span class="toc-text">5.13.4 网络连接计时</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-课程学习过程中练习"><span class="toc-text">6. 课程学习过程中练习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-勾选要求变量声明（初学）"><span class="toc-text">2.1 勾选要求变量声明（初学）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-字符判断"><span class="toc-text">2.2 字符判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-inputbox-amp-keypress"><span class="toc-text">2.3 inputbox &amp; keypress</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-DIY"><span class="toc-text">3.1 DIY</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-for"><span class="toc-text">3.2 for</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-for-与-if-可以互换"><span class="toc-text">3.3 for 与 if 可以互换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-求积"><span class="toc-text">4.1 求积</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-控件数组–将五个-shape-从上到下移动"><span class="toc-text">4.2 控件数组–将五个 shape 从上到下移动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-所有控件的移动"><span class="toc-text">4.3 所有控件的移动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-模块、多窗口"><span class="toc-text">4.4 模块、多窗口</span></a></li></ol></li></ol></div></div><div class="post-content"><h1 id="5-正式学习"><a href="#5-正式学习" class="headerlink" title="5. 正式学习"></a>5. <strong>正式学习</strong></h1><h2 id="5-1-基础知识（零碎）"><a href="#5-1-基础知识（零碎）" class="headerlink" title="5.1 基础知识（零碎）"></a>5.1 基础知识（零碎）</h2><p>对象：数据和数据操作方式的综合体，如窗体、控件</p>
<p>对象三要素：属性、事件、方法</p>
<ul>
<li><p>属性：<br><code>对象.属性= 属性值</code></p>
</li>
<li><p>事件：</p>
</li>
</ul>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> 对象名_事件过程名[参数列表]</span><br><span class="line"><span class="comment">' click load ----</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>方法：</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">对象.方法[参数名表]</span><br><span class="line">Form1.Print "avb"</span><br><span class="line">Text1.SetFocus</span><br></pre></td></tr></tbody></table></figure>

<p>暂停程序 Stop<br>结束程序 End</p>
<p>命令按钮改变背景必须变两个属性-bg 和 style<br>其他的只需改变 bg 就行了</p>
<h3 id="If-判断结构"><a href="#If-判断结构" class="headerlink" title="If 判断结构"></a>If 判断结构</h3><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 表达式 <span class="keyword">then</span></span><br><span class="line">  语句<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  语句<span class="number">2</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>example：密码输入，限制输入 3 次</strong></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span> <span class="comment">' 定义一个整型变量</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    <span class="keyword">If</span> Text1 = <span class="string">"buct"</span> <span class="keyword">Then</span></span><br><span class="line">        Text2.Visible = <span class="literal">True</span></span><br><span class="line">        Label2.Visible = <span class="literal">True</span></span><br><span class="line">        Command1.Visible = <span class="literal">True</span></span><br><span class="line">        Text1.Visible = <span class="literal">False</span></span><br><span class="line">        Label1.Visible = <span class="literal">False</span></span><br><span class="line">        Command2.Visible = <span class="literal">False</span></span><br><span class="line">        Label3.Visible = <span class="literal">False</span></span><br><span class="line">        Text2.SetFocus</span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">       <span class="comment">' Text1 = ""</span></span><br><span class="line">       <span class="comment">' Label3.Visible = True</span></span><br><span class="line">       <span class="comment">' Label3 = "密码错误，请重新输入"</span></span><br><span class="line">       <span class="comment">' Text1.SetFocus</span></span><br><span class="line">        i = i +<span class="number">1</span></span><br><span class="line">        <span class="keyword">If</span> i &gt;= <span class="number">3</span> <span class="keyword">Then</span> <span class="keyword">End</span></span><br><span class="line">        Text1 = <span class="string">""</span></span><br><span class="line">        Text1.SetFocus</span><br><span class="line">        MsgBox <span class="string">"密码输入错误，请重新输入"</span> <span class="comment">' 弹出一个框</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Form_Load()</span><br><span class="line">    Text2.Visible = <span class="literal">False</span></span><br><span class="line">    Label2.Visible = <span class="literal">False</span></span><br><span class="line">    Command1.Visible = <span class="literal">False</span></span><br><span class="line">    Label3.Visible = <span class="literal">False</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="5-2-VB-的语言成分"><a href="#5-2-VB-的语言成分" class="headerlink" title="5.2 VB 的语言成分"></a>5.2 VB 的语言成分</h2><p>编码规则：</p>
<ul>
<li>不区分字母大小写</li>
<li>语句书写自由:同一行可以写多条语句用<code>:</code>分开、一条语句多行写用<code>_</code>连接</li>
<li>代码注释： <code>'</code>或者<code>Rem</code>引导注释内容、快注释-视窗-工具栏-编辑-快注释</li>
<li>VB 的命名约定：字母或汉字开头，长度不超过 255 个字符，控件不超过 40 个字符<ul>
<li>不用 VB 关键字:<code>if loop</code></li>
<li>不能包含空格，小数点，其他声明字符<code>$ % &amp;</code></li>
</ul>
</li>
</ul>
<h3 id="5-2-1-基本数据类型"><a href="#5-2-1-基本数据类型" class="headerlink" title="5.2.1 基本数据类型"></a>5.2.1 基本数据类型</h3><p><img src="/img/VB/sjlx.png" alt="VB数据类型"></p>
<h3 id="5-2-2-直接常量"><a href="#5-2-2-直接常量" class="headerlink" title="5.2.2 直接常量"></a>5.2.2 直接常量</h3><p><img src="/img/VB/zjcl.png" alt="VB直接常量"></p>
<h3 id="5-2-3-变量"><a href="#5-2-3-变量" class="headerlink" title="5.2.3 变量"></a>5.2.3 变量</h3><ol>
<li>变量隐式声明：使用的变量未作声明，所有变量均为 Variant 类型</li>
<li>变量显式声明：</li>
</ol>
<ul>
<li>使用类型标示符直接声明变量 <code>MyName$ ="David"</code>–字符串型</li>
<li>使用 Dim 语句<ul>
<li>格式 1：Dim 变量名 As 数据类型[,变量名 As 数据类型，…..0]</li>
<li>格式 2：Dim 变量名 + 类型标识符</li>
</ul>
</li>
</ul>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> A <span class="keyword">As</span> <span class="built_in">Integer</span>, B <span class="keyword">As</span> <span class="built_in">Double</span></span><br><span class="line"><span class="keyword">Dim</span> A%,B<span class="meta">#</span></span><br><span class="line"><span class="keyword">Dim</span> MyName1 <span class="keyword">As</span> <span class="built_in">String</span> , Myname2 <span class="keyword">As</span> <span class="built_in">String</span>*<span class="number">5</span> <span class="comment">'字符串只能是五个字符</span></span><br><span class="line"><span class="keyword">Dim</span> Vp1, Vp2 <span class="keyword">As</span> <span class="built_in">Single</span></span><br></pre></td></tr></tbody></table></figure>

<ol start="3">
<li>变量的强制声明：在每个模块开始处自动加一条”Option Explicit”语句，所有变量需要指定数据类型</li>
</ol>
<p>工具菜单- 选项命令 - 选中编辑器中的要求变量声明</p>
<h3 id="5-2-4-模块"><a href="#5-2-4-模块" class="headerlink" title="5.2.4 模块"></a>5.2.4 模块</h3><p>VB 代码存储在模块中<br>三种模块：窗体模块、标准模块、类模块<br><img src="/img/VB/mk.png" alt="VB模块"></p>
<h3 id="5-2-5-变量的作用域"><a href="#5-2-5-变量的作用域" class="headerlink" title="5.2.5 变量的作用域"></a>5.2.5 变量的作用域</h3><ul>
<li>全局变量：在窗体或标准模块中声明 Public<ul>
<li><code>Public 变量名 As 数据类型</code></li>
</ul>
</li>
<li>模块级变量：在模块的声明部分使用 Dim 或 Private 声明<ul>
<li><code>Dim 变量名 As 数据类型</code></li>
</ul>
</li>
<li>局部变量：在过程中由 Dim 或 Static 关键字声明<ul>
<li><code>Static 变量名 As 数据类型</code></li>
</ul>
</li>
</ul>
<p>变量的作用域<br><img src="/img/VB/zyy.png" alt="变量的作用域及使用规则"></p>
<ul>
<li>内部常量：控件常量、语言常量、对象常量、用户界面常量</li>
<li>用户定义常量：用 Const 语句和赋值</li>
</ul>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Const</span> PI <span class="keyword">As</span> <span class="built_in">Double</span> = <span class="number">3.14159265</span>...</span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> Msg <span class="keyword">As</span> <span class="built_in">String</span> = <span class="string">"hello world"</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Const</span> Msg <span class="keyword">As</span> <span class="built_in">String</span> = <span class="string">"天安门"</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>静态变量：每次调用一个过程时保留上次的调用值</li>
</ul>
<p><code>Static 变量名 As 数据类型,变量名 As 数据类型....</code></p>
<h3 id="5-2-6-变量类型检查"><a href="#5-2-6-变量类型检查" class="headerlink" title="5.2.6 变量类型检查"></a>5.2.6 变量类型检查</h3><p><img src="/img/VB/bllxjc.png" alt="变量的类型检查"></p>
<p><img src="/img/VB/sjlxflpd.png" alt="数据类型分类判断"></p>
<h3 id="5-2-7-运算符"><a href="#5-2-7-运算符" class="headerlink" title="5.2.7 运算符"></a>5.2.7 运算符</h3><p><img src="/img/VB/ysf.png" alt="运算符"></p>
<h3 id="5-2-8-常用内部函数"><a href="#5-2-8-常用内部函数" class="headerlink" title="5.2.8 常用内部函数"></a>5.2.8 常用内部函数</h3><p><img src="/img/VB/cyhs.png" alt="常用内部函数、数学函数"><br><img src="/img/VB/cyzhhs.png" alt="常用转换函数"><br><img src="/img/VB/zfchs.png" alt="字符串函数"></p>
<p><img src="/img/VB/sszfclz.png" alt="字符串函数例子"></p>
<h3 id="5-2-9-日期函数"><a href="#5-2-9-日期函数" class="headerlink" title="5.2.9 日期函数"></a>5.2.9 日期函数</h3><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">'Time Date Now DateDiff DateAdd</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Dim</span> d1 <span class="keyword">As</span> <span class="built_in">Date</span>, d2 <span class="keyword">As</span> <span class="built_in">Date</span></span><br><span class="line">    Print Now, <span class="built_in">Date</span>, Time</span><br><span class="line">    Print Time, Hour(Time), Minute(Time), Second(Time)</span><br><span class="line">    Print <span class="built_in">Date</span>, Year(<span class="built_in">Date</span>), Month(<span class="built_in">Date</span>), Day(<span class="built_in">Date</span>)</span><br><span class="line">    Print <span class="string">"=---------------------="</span></span><br><span class="line">    Print DateDiff(<span class="string">"d"</span>, Now, <span class="meta">#10/1/2009#); #10/1/2009# - Date</span></span><br><span class="line">    Print <span class="built_in">Date</span> + Time; <span class="string">"***"</span>; DateAdd(<span class="string">"h"</span>, <span class="number">5</span>, Now); <span class="string">"***"</span>;</span><br><span class="line">    Print DateAdd(<span class="string">"s"</span>, <span class="number">5</span>, Time), vbCrLf</span><br><span class="line">    d1 = <span class="string">"2004-07-16 05:00:00"</span></span><br><span class="line">    d2 = <span class="string">"2004-08-20 23:00:00"</span></span><br><span class="line">    Print <span class="meta">#8/20/2004# - #7/16/2004#, d2 - d1, (d2 - d1) * 24</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/VB/rqlz.png" alt="日期函数例子"></p>
<p><strong>格式输出函数</strong><br><code>Format$(表达式[,格式字符串])</code></p>
<blockquote>
<p>关于日期的格式详情，参考<a href="https://blog.csdn.net/bigheadsheep/article/details/12013267" target="_blank" rel="noopener">Format 函数</a>这篇文章</p>
</blockquote>
<p><strong>Shell 函数</strong><br><img src="/img/VB/shellhs.png" alt="shell函数"></p>
<h3 id="5-2-10-基本语句"><a href="#5-2-10-基本语句" class="headerlink" title="5.2.10 基本语句"></a>5.2.10 基本语句</h3><h4 id="5-2-10-1-赋值语句"><a href="#5-2-10-1-赋值语句" class="headerlink" title="5.2.10.1 赋值语句"></a>5.2.10.1 赋值语句</h4><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Let</span> 变量名 = 表达式  <span class="comment">'普通变量</span></span><br><span class="line"><span class="keyword">Set</span> 变量名 = 表达式  <span class="comment">' 对象型变量</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Let</span> A = <span class="number">5</span></span><br><span class="line"><span class="keyword">Set</span> Obj1 = Command1</span><br><span class="line"></span><br><span class="line">Text1.<span class="keyword">text</span> = <span class="string">"ok"</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="5-2-10-2-快速输入输出函数"><a href="#5-2-10-2-快速输入输出函数" class="headerlink" title="5.2.10.2 快速输入输出函数"></a>5.2.10.2 快速输入输出函数</h4><p><img src="/img/VB/kssrschs.png" alt="InputBox函数"></p>
<p><img src="/img/VB/msgbox.png" alt="MsgBox函数"></p>
<p><img src="/img/VB/msgboxlz.png" alt="MsgBox例子"></p>
<h2 id="5-3-控制结构与算法"><a href="#5-3-控制结构与算法" class="headerlink" title="5.3 控制结构与算法"></a>5.3 控制结构与算法</h2><h3 id="5-3-1-顺序结构"><a href="#5-3-1-顺序结构" class="headerlink" title="5.3.1 顺序结构"></a>5.3.1 顺序结构</h3><p>语句 1→→→ 语句 2→→→ 语句 3</p>
<h3 id="5-3-2-选择结构"><a href="#5-3-2-选择结构" class="headerlink" title="5.3.2 选择结构"></a>5.3.2 选择结构</h3><h4 id="5-3-2-1-if"><a href="#5-3-2-1-if" class="headerlink" title="5.3.2.1 if"></a>5.3.2.1 if</h4><p><strong>1</strong><code>if 表达式 then 语句</code></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> 表达式 <span class="keyword">then</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="keyword">if</span> 表达式 <span class="keyword">then</span></span><br><span class="line">    语句块<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    语句块<span class="number">2</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="keyword">if</span> 表达式 <span class="keyword">then</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">else</span> : 语句</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> 表达式 <span class="keyword">then</span> 语句<span class="number">1</span> <span class="keyword">else</span> 语句<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="keyword">if</span> 表达式<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">    语句块<span class="number">1</span></span><br><span class="line"><span class="keyword">elseif</span> 表达式<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">    语句块<span class="number">2</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>例子：</strong><br><img src="/img/VB/cfex.png" alt="摄氏度与华氏度提示"></p>
<h4 id="5-3-2-2-select"><a href="#5-3-2-2-select" class="headerlink" title="5.3.2.2 select"></a>5.3.2.2 select</h4><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> 变量或表达式</span><br><span class="line">    <span class="keyword">case</span> 表达式列表<span class="number">1</span>    <span class="comment">'is 关系运算表达式</span></span><br><span class="line">        语句块<span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> 表达式列表<span class="number">2</span></span><br><span class="line">        语句块<span class="number">2</span></span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">else</span></span><br><span class="line">        语句块</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">select</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>例子：</strong></p>
<p><img src="/img/VB/yex.png" alt="求函数Y的值"></p>
<h3 id="5-3-3-循环结构"><a href="#5-3-3-循环结构" class="headerlink" title="5.3.3 循环结构"></a>5.3.3 循环结构</h3><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 循环变量=初值 <span class="keyword">to</span> 终值 [<span class="keyword">step</span>步长]</span><br><span class="line">    语句块</span><br><span class="line">    [<span class="keyword">exit</span> <span class="keyword">for</span>]</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">next</span> 循环变量</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> 元素变量 <span class="keyword">in</span> 数组或集合</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">next</span> 元素变量</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">先判断后执行</span><br><span class="line"><span class="keyword">do</span> <span class="keyword">while</span> 条件</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> <span class="keyword">until</span> 条件</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line"></span><br><span class="line">先执行后判断</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span> <span class="keyword">while</span> 条件</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span> <span class="keyword">until</span> 条件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span> <span class="keyword">do</span> 退出循环体</span><br></pre></td></tr></tbody></table></figure>

<h4 id="5-3-3-1-for-next-循环"><a href="#5-3-3-1-for-next-循环" class="headerlink" title="5.3.3.1 for next 循环"></a>5.3.3.1 for next 循环</h4><ul>
<li>循环变量是数之变量</li>
<li>初值、终值、步长可以是数之表达式</li>
<li>步长可正可负，但不能为 0 、为 1 是省略</li>
<li>exit for 退出循环，经常放到条件语句中</li>
<li>next 后的循环变量应与 for 语句中的循环变量一致，可以省略</li>
</ul>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 循环变量=初值 <span class="keyword">to</span> 终值 [<span class="keyword">step</span>步长]</span><br><span class="line">    语句块</span><br><span class="line">    [<span class="keyword">exit</span> <span class="keyword">for</span>]</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">next</span> 循环变量</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">'--求1+2+3+4+...+n--</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">sub</span> command1_click()</span><br><span class="line">    <span class="keyword">dim</span> n <span class="keyword">as</span> <span class="built_in">integer</span> , i <span class="keyword">as</span> <span class="built_in">integer</span> , s <span class="keyword">as</span> <span class="built_in">integer</span></span><br><span class="line">    n = val(text1.<span class="keyword">text</span>)</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span> <span class="keyword">to</span> n</span><br><span class="line">        s = s + i</span><br><span class="line">    <span class="keyword">next</span> i</span><br><span class="line">    label3.caption = s</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>for each ... in ... next 循环</code></p>
<p>For Each…In…Next 循环结构中元素变量是 变体型变量</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> 元素变量 <span class="keyword">in</span> 数组或集合</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">next</span> 元素变量</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/VB/foreach.png" alt="控件颜色"></p>
<h4 id="5-3-3-2-do…loop-循环结构"><a href="#5-3-3-2-do…loop-循环结构" class="headerlink" title="5.3.3.2 do…loop 循环结构"></a>5.3.3.2 do…loop 循环结构</h4><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> <span class="keyword">while</span> 条件</span><br><span class="line">    语句组<span class="number">1</span></span><br><span class="line">    <span class="keyword">exit</span> <span class="keyword">do</span></span><br><span class="line">    语句组<span class="number">2</span></span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line"></span><br><span class="line">细节------------------</span><br><span class="line">先判断后执行---当</span><br><span class="line"><span class="keyword">do</span> <span class="keyword">while</span> 条件</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> <span class="keyword">until</span> 条件</span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line"></span><br><span class="line">先执行后判断---直到</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span> <span class="keyword">while</span> 条件</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">loop</span> <span class="keyword">until</span> 条件</span><br></pre></td></tr></tbody></table></figure>

<p>while true 则循环<br>until false 则循环</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">' 1^2+2^2+....小于n的最大值</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">sub</span> command1_click()</span><br><span class="line">    <span class="keyword">dim</span> n <span class="keyword">as</span> <span class="built_in">long</span> , s <span class="keyword">as</span> <span class="built_in">long</span>, i <span class="keyword">as</span> <span class="built_in">integer</span></span><br><span class="line">    n = val(text1.<span class="keyword">text</span>)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">do</span> <span class="keyword">while</span> s &lt; n</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">        s = s + i * i</span><br><span class="line">    <span class="keyword">loop</span></span><br><span class="line">    text2.<span class="keyword">text</span> = s - i * i</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="5-3-3-3-循环嵌套"><a href="#5-3-3-3-循环嵌套" class="headerlink" title="5.3.3.3 循环嵌套"></a>5.3.3.3 循环嵌套</h4><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">'----------eg:</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">for</span> j = <span class="number">5</span> <span class="keyword">to</span> <span class="number">7</span></span><br><span class="line">        print i , j</span><br><span class="line">    <span class="keyword">next</span> j</span><br><span class="line"><span class="keyword">next</span> i</span><br><span class="line"></span><br><span class="line"><span class="keyword">or</span></span><br><span class="line"><span class="keyword">next</span> j,i</span><br></pre></td></tr></tbody></table></figure>

<h3 id="5-3-4-goto-语句"><a href="#5-3-4-goto-语句" class="headerlink" title="5.3.4 goto 语句"></a>5.3.4 goto 语句</h3><p><code>goto{标号|行号}</code></p>
<p><img src="/img/VB/gotoex.png" alt="goto例子"></p>
<h2 id="5-4-数组"><a href="#5-4-数组" class="headerlink" title="5.4 数组"></a>5.4 数组</h2><h3 id="5-4-1-数组"><a href="#5-4-1-数组" class="headerlink" title="5.4.1 数组"></a>5.4.1 数组</h3><p><img src="/img/VB/szgn.png" alt="数组概念"></p>
<p>如：<code>A(8)</code>,<code>B(I)</code>,<code>A(A(5))</code><br><code>a(1,3)</code>-二维数组</p>
<h3 id="5-4-2-数组定义"><a href="#5-4-2-数组定义" class="headerlink" title="5.4.2 数组定义"></a>5.4.2 数组定义</h3><p><code>Public|Private|Dim 数组名 维数定义 AS 类型</code><br><code>Dim A(-4 TO 10) As Integer</code><br><code>Dim A(0 TO 8,0 to 3) As Integer</code> = <code>Dim a(8,3) as integer</code></p>
<h4 id="5-4-2-1-定义形式"><a href="#5-4-2-1-定义形式" class="headerlink" title="5.4.2.1 定义形式"></a>5.4.2.1 定义形式</h4><p><code>dim 数组名 ([下界 to]上界) as 数据类型</code><br>下界默认为 0，也可以在 <code>option base n</code> 来修改默认下界</p>
<h4 id="5-4-2-2-动态数组的建立与使用"><a href="#5-4-2-2-动态数组的建立与使用" class="headerlink" title="5.4.2.2 动态数组的建立与使用"></a>5.4.2.2 动态数组的建立与使用</h4><p><code>dim 数组名() [as 数据类型]</code>先不给大小<br><code>redim 数组名 (8,8,)</code>具体使用时在给出大小<br><code>redim preserve 数组名(8,newvalue)</code>改变数组大小，可用 preserve 保留原来的数据</p>
<h4 id="5-4-2-3-控件数组"><a href="#5-4-2-3-控件数组" class="headerlink" title="5.4.2.3 控件数组"></a>5.4.2.3 控件数组</h4><p>在窗体上画出控件，进行属性设置</p>
<ul>
<li>复制粘贴，建立控件数组</li>
<li>编程时哟个 load 方法</li>
</ul>
<p><img src="/img/VB/dtszdsy.png" alt="动态数组的使用"></p>
<p><img src="/img/VB/fxsc.png" alt="输入10个单词，反序输出"><br><img src="/img/VB/fxsc1.png" alt="输出10个单词，反序输出2"><br><img src="/img/VB/fxsc2.png" alt="输出10个单词，反序输出3"></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array 数组输入</span><br><span class="line">数组下界到数组上界</span><br><span class="line">ubound(A) <span class="keyword">to</span> lbound(A)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="5-4-2-4-数组元素的复制"><a href="#5-4-2-4-数组元素的复制" class="headerlink" title="5.4.2.4 数组元素的复制"></a>5.4.2.4 数组元素的复制</h4><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">option</span> base <span class="number">1</span></span><br><span class="line">    <span class="keyword">dim</span> a(<span class="number">15</span>),b(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> j = <span class="number">1</span> <span class="keyword">to</span> <span class="number">5</span></span><br><span class="line">        b(i,j) = a((i<span class="number">-1</span>) * <span class="number">5</span> +j)</span><br><span class="line">        <span class="keyword">next</span> j</span><br><span class="line">    <span class="keyword">next</span> i</span><br></pre></td></tr></tbody></table></figure>

<h4 id="5-4-2-5-for-each-…-next"><a href="#5-4-2-5-for-each-…-next" class="headerlink" title="5.4.2.5 for each … next"></a>5.4.2.5 for each … next</h4><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">打印一堆数组x中所有元素</span><br><span class="line"><span class="keyword">dim</span> x(<span class="number">15</span>)</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> a <span class="keyword">in</span> x</span><br><span class="line">    print a;</span><br><span class="line"><span class="keyword">next</span> a</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">求二维数组y的所有元素之和</span><br><span class="line"><span class="keyword">dim</span> y(<span class="number">10</span>,<span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> a <span class="keyword">in</span> y</span><br><span class="line">    sum = sum + a</span><br><span class="line"><span class="keyword">next</span> a</span><br><span class="line">print sum</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/VB/blsznr.png" alt="保留动态数组的内容"></p>
<h3 id="5-4-3-数组应用举例"><a href="#5-4-3-数组应用举例" class="headerlink" title="5.4.3 数组应用举例"></a>5.4.3 数组应用举例</h3><h4 id="5-4-3-1-例子-1"><a href="#5-4-3-1-例子-1" class="headerlink" title="5.4.3.1 例子 1"></a>5.4.3.1 例子 1</h4><p>例:生成 20 个 10 到 100 之间的随机整数,存于一维整型数组 A 中,同时显示于第一个文本框中,单击窗体将这 20 个数以相反的次序显示于另一个文本框中<br><img src="/img/VB/szlz.png" alt="数组应用"></p>
<h4 id="5-4-3-2-例子-2"><a href="#5-4-3-2-例子-2" class="headerlink" title="5.4.3.2 例子 2"></a>5.4.3.2 例子 2</h4><p><img src="/img/VB/szlz1.png" alt="控件数组"></p>
<h2 id="5-5-过程"><a href="#5-5-过程" class="headerlink" title="5.5 过程"></a>5.5 过程</h2><ul>
<li>过程的引入:使同类的操作不重复(操作方法相同、参数不同)</li>
<li>过程:完成一段独立功能,可供其他过程使用(调用)。过程又称为子程序</li>
<li>调用过程:调用其他过程的过程</li>
</ul>
<p>过程：</p>
<ul>
<li>sub 子过程</li>
<li>function 函数过程</li>
<li>property 属性过程</li>
<li>event 事件过程</li>
</ul>
<h3 id="5-5-1-子过程和函数过程"><a href="#5-5-1-子过程和函数过程" class="headerlink" title="5.5.1 子过程和函数过程"></a>5.5.1 子过程和函数过程</h3><p><img src="/img/VB/zgchsgc.png" alt="子过程和函数过程"></p>
<p>调用：</p>
<ul>
<li><p>子过程名[参数列表]</p>
</li>
<li><p>Call 子过程名 (参数列表)</p>
</li>
<li><p>变量名 = 函数过程名([参数列表])</p>
</li>
<li><p>public 所有模块的所有其他过程</p>
</li>
<li><p>private 只有本模块的其他过程</p>
</li>
<li><p>static 过程中所有的局部变量都为静态变量</p>
</li>
<li><p>函数过程名：function 过程的名称</p>
</li>
<li><p>形参表：调用时要传递给 function 的参数变量列表</p>
</li>
</ul>
<p><img src="/img/VB/gclz.png" alt="过程例子"></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">定义求阶乘的函数Fact</span><br><span class="line"><span class="keyword">Function</span> Fact(n <span class="keyword">As</span> <span class="built_in">Integer</span>) <span class="keyword">As</span> <span class="built_in">Double</span></span><br><span class="line">    <span class="keyword">Dim</span> F <span class="keyword">As</span> <span class="built_in">Double</span>, i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    F=<span class="number">1</span></span><br><span class="line">    <span class="keyword">For</span> i=<span class="number">1</span> <span class="keyword">To</span> n</span><br><span class="line">        F=F * i</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line">    Fact =F</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Dim</span> m <span class="keyword">As</span> <span class="built_in">Integer</span>, n <span class="keyword">As</span> <span class="built_in">Integer</span>, c <span class="keyword">As</span> <span class="built_in">Double</span></span><br><span class="line">    m= Val(TextI.<span class="keyword">Text</span>)</span><br><span class="line">    n= Val(Text2.<span class="keyword">Text</span>)</span><br><span class="line">    c=Fact(m)/(Fact(n)*(Fact(m-n)))<span class="comment">'调用Fact</span></span><br><span class="line">    Text3.<span class="keyword">Text</span>= Trim(Str(c))</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>◆Sub 过程的建立方法与 Function 过程的建立方法相同。</li>
<li>◆&lt;过程名&gt;不具有值的意义,在 Sub 过程中不能给&lt;过程名&gt;赋<br>值,也不能给&lt;过程名&gt;定义类型。</li>
<li>◆Sub 过程通过&lt;形参表&gt;中的参数返回值。</li>
</ul>
<p><img src="/img/VB/subgclz.png" alt="sub过程"></p>
<h3 id="5-5-2-参数的传递"><a href="#5-5-2-参数的传递" class="headerlink" title="5.5.2 参数的传递"></a>5.5.2 参数的传递</h3><p><img src="/img/VB/cscd.png" alt="参数传递"></p>
<h3 id="5-5-3-代码模块"><a href="#5-5-3-代码模块" class="headerlink" title="5.5.3 代码模块"></a>5.5.3 代码模块</h3><p><img src="/img/VB/dmmk.png" alt="代码模块"></p>
<h4 id="5-5-3-1-窗体模块"><a href="#5-5-3-1-窗体模块" class="headerlink" title="5.5.3.1 窗体模块"></a>5.5.3.1 窗体模块</h4><p>事件过程、通用过程、通用声明</p>
<h4 id="5-5-3-2-标准模块"><a href="#5-5-3-2-标准模块" class="headerlink" title="5.5.3.2 标准模块"></a>5.5.3.2 标准模块</h4><p><img src="/img/VB/bzmk.png" alt="标准模块"></p>
<h4 id="5-5-3-3-类模块"><a href="#5-5-3-3-类模块" class="headerlink" title="5.5.3.3 类模块"></a>5.5.3.3 类模块</h4><p>在类模块中编写代码建立新对象</p>
<h3 id="5-5-4-过程的作用域"><a href="#5-5-4-过程的作用域" class="headerlink" title="5.5.4 过程的作用域"></a>5.5.4 过程的作用域</h3><p><img src="/img/VB/gczyy.png" alt="过程作用域"></p>
<p><img src="/img/VB/gczyylz.png" alt="过程作用域例子"><br><img src="/img/VB/gczyylz1.png" alt="过程作用域例子"></p>
<p><img src="/img/VB/gczyysygz.png" alt="过程作用域及使用规则"></p>
<h2 id="5-6-用户界面设计"><a href="#5-6-用户界面设计" class="headerlink" title="5.6 用户界面设计"></a>5.6 用户界面设计</h2><h3 id="5-6-1-单选按钮和复选框"><a href="#5-6-1-单选按钮和复选框" class="headerlink" title="5.6.1 单选按钮和复选框"></a>5.6.1 单选按钮和复选框</h3><p>单选框只能选一个（Option）<br>复选框可以选多个（Check）<br><code>click动作</code><br><code>check.value = true</code> 则为被选中</p>
<p><img src="/img/VB/checklz.png" alt="例子"></p>
<h3 id="5-6-2-框架-Frame"><a href="#5-6-2-框架-Frame" class="headerlink" title="5.6.2 框架 Frame"></a>5.6.2 框架 Frame</h3><p>框架之间可以隔开单选按钮<br><code>fontname</code> <code>fontsize</code> <code>forecolor</code><br>属性</p>
<h3 id="5-6-3-滚动条"><a href="#5-6-3-滚动条" class="headerlink" title="5.6.3 滚动条"></a>5.6.3 滚动条</h3><p>HScroll Bar 、 VScroll Bar<br>水平、竖直滚动条</p>
<ul>
<li>属性<br>MIN 默认 0<br>MAX 默认 32767</li>
</ul>
<p>Value ：设置滚动块在滚动条中的位置值<br>Smallchange ：最小变动值属性<br>Largechange ：最大——</p>
<ul>
<li>事件<br>Scroll ：当鼠标拖动滚动块时，触发<br>Change ： 当改变 value 值时出发</li>
</ul>
<p>eg：在 text 中显示最大最小值</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">text1 = HScroll1.Min</span><br><span class="line">text2 = HScroll2.Max</span><br><span class="line">text3 = HScroll3.Value</span><br><span class="line"></span><br><span class="line">HScroll <span class="comment">' 横向</span></span><br><span class="line">VScroll <span class="comment">' 纵向</span></span><br></pre></td></tr></tbody></table></figure>

<p>RGB 函数：<br>颜色值的取间是 0~255</p>
<p>随机数 Rnd() 返回小于 1 大于或等于 0 的值<br>Rnd[()]</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">sub</span> form_click()</span><br><span class="line">    text1.forecolor = RGB(<span class="number">255</span> * Rnd , <span class="number">255</span> * Rnd , <span class="number">255</span> * Rnd)</span><br><span class="line">    form1.backcolor = RGB(<span class="number">255</span> * Rnd , <span class="number">255</span> * Rnd , <span class="number">255</span> * Rnd)</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<p>返回小于 1 但大于或等于 0 的值。 Number 的值决定了 Rnd 生成随机数的方式。<br>在调用 Rnd 之前,先使用无参数的 Randomize 语句初始化随机函数生成器,该<br>生成器具有根据系统计时器得到的种子。<br>如果 number 的值是 Randomize 生成。<br>小于 0,每次都使用 number 作为随机数种子得到相同结果<br>大于 0,以上一个随机数为种子产生下一个随机数;<br>等于 0,产生与最近生成的随机数相同的随机数。<br>省略,以上一个随机数为种子产生下一个随机数<br>例,Int((上限下限+1)*Rnd+下限),生成上限与下限之间的随机整数。</p>
<h3 id="5-6-4-列表框"><a href="#5-6-4-列表框" class="headerlink" title="5.6.4 列表框"></a>5.6.4 列表框</h3><p>只能在程序中设置的属性：<br>Listindex 执行时选中的列表项的序号<br>Listcount 项目数量 从 0 开始<br>Selected True 表示选中相应的项<br>Text 表示选中列表项文本内容</p>
<p>Additem ： 增加项<br>Removeitem ： 删除项<br>Clear ： 清除</p>
<p>属性 style : 1 时为多选框<br>属性 columns: 几列</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List1.AddItem <span class="string">"1"</span></span><br><span class="line">List1.AddItem <span class="string">"2"</span></span><br><span class="line">province = Array(<span class="string">"a"</span>,<span class="string">"b"</span>) <span class="comment">' 一维数组</span></span><br><span class="line"></span><br><span class="line">Province(List1.ListIndex) <span class="comment">'数组中数据</span></span><br><span class="line">List1.List(List.ListIndex) = text1</span><br><span class="line"></span><br><span class="line"><span class="comment">' 判断是否选中</span></span><br><span class="line"><span class="keyword">if</span> list1.selected(i) <span class="keyword">Then</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="5-6-5-组合框"><a href="#5-6-5-组合框" class="headerlink" title="5.6.5 组合框"></a>5.6.5 组合框</h3><p>style 属性：<br>0 下拉式<br>1 简单组合框<br>2 下拉式列表框</p>
<h3 id="5-6-6-驱动器列表框、目录列表框、文件列表框"><a href="#5-6-6-驱动器列表框、目录列表框、文件列表框" class="headerlink" title="5.6.6 驱动器列表框、目录列表框、文件列表框"></a>5.6.6 驱动器列表框、目录列表框、文件列表框</h3><p>DriveListBox<br>DirectoryListBox<br>FileListBox</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> index</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span></span><br><span class="line">        语句<span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span></span><br><span class="line">        语句<span class="number">2</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">select</span></span><br><span class="line"></span><br><span class="line"><span class="comment">' 打开程序</span></span><br><span class="line">Retval = shell(dir1.path + <span class="string">"\"</span> + file1.filename,<span class="number">1</span>)</span><br><span class="line">Retval = shell(<span class="string">"C:\user\.."</span>,<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="5-6-7-通用对话框"><a href="#5-6-7-通用对话框" class="headerlink" title="5.6.7 通用对话框"></a>5.6.7 通用对话框</h3><p>打开、另存为、颜色、字体、打印机、帮助<br>工程–部件–Microsoft Comm Dialog Control 6.0 选择通用对话框</p>
<p><code>对象.Action = 1</code> 打开文件对话框<br><code>对象.ShowOpen</code> 打开文件对话框</p>
<p><img src="/img/VB/tongyong.png" alt="通用对话框例子"></p>
<h3 id="5-6-8-菜单设计"><a href="#5-6-8-菜单设计" class="headerlink" title="5.6.8 菜单设计"></a>5.6.8 菜单设计</h3><p>普通的菜单设计<br>工具–菜单编辑器–逐一填写</p>
<p>弹出菜单<br>对象.PopupMenu 菜单名，标值，x，y<br><code>PopupMenu Cal2,2</code></p>
<h3 id="5-6-9-多重窗体"><a href="#5-6-9-多重窗体" class="headerlink" title="5.6.9 多重窗体"></a>5.6.9 多重窗体</h3><p>工程–添加窗体–打开<br>load 窗体名称 将窗体装入内存，但不显示<br>unload 窗体名称</p>
<p>窗体名称.show 显示窗体<br>窗体名称.hide 隐藏窗体<br><code>form2.show</code>显示 form1 窗体</p>
<h3 id="5-6-10-鼠标-键盘事件"><a href="#5-6-10-鼠标-键盘事件" class="headerlink" title="5.6.10 鼠标/键盘事件"></a>5.6.10 鼠标/键盘事件</h3><p><img src="/img/VB/sbsj.png" alt="鼠标事件"></p>
<p>键盘事件：KeyPress ， KeyUp ， KeyDown</p>
<h3 id="5-6-11-对象拖放与-OLE-拖放"><a href="#5-6-11-对象拖放与-OLE-拖放" class="headerlink" title="5.6.11 对象拖放与 OLE 拖放"></a>5.6.11 对象拖放与 OLE 拖放</h3><p>对象拖放：用鼠标将对象从一个地方拖动到另一个地方</p>
<p>拖放方式属性：DragMode 为 1 自动 0 手动<br>拖放图标属性可以在设计时设置，也可在程序中设置<br><code>控件名.DragIcon = 图像控件.picture</code><br><code>控件名.DragIcon = LoadPicture("C:\Icons\mail.ico")</code></p>
<p>拖放事件</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sub</span> form_dragdrop(source <span class="keyword">as</span> control , x <span class="keyword">as</span> <span class="built_in">single</span> , y <span class="keyword">as</span> <span class="built_in">single</span>)</span><br><span class="line">    source.move x,y</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<p>OLE 拖放 ：将数据从一个控件或应用程序中移动到另一个控件或应用程序。<br><strong>OLEDragMode</strong>属性—决定是自动还是手动实现“拖”操作<br><strong>OLEDropMode</strong>属性—决定是自动还是手动实现“放”操作<br>注:并不是所有的控件都有此二属性,有的只有其一。</p>
<ul>
<li>OLEDragDrop 事件—在目标控件上进行“放”操作时发生的事件。</li>
<li>OLEStartDrag 事件一源控件 OLEDrag 方法被执行或用户做“拖”，操作时发生的事件</li>
<li>OLEDragOver 事件—在拖动时,经某控件时在该控件上发生的事件</li>
</ul>
<h2 id="5-7-Active-X-控件"><a href="#5-7-Active-X-控件" class="headerlink" title="5.7 Active X 控件"></a>5.7 Active X 控件</h2><h3 id="5-7-1-SSTab-选项卡控件"><a href="#5-7-1-SSTab-选项卡控件" class="headerlink" title="5.7.1 SSTab 选项卡控件"></a>5.7.1 SSTab 选项卡控件</h3><p>工程–部件–选中 Microsoft Tabbed Dialog Control 6.0</p>
<p>style 属性：选项卡样式–0/1：office 风格/windows 风格<br>Tabs 属性：控制控件上选项卡的数目<br>Tab 属性 ：决定控件上当前被选定的项</p>
<h3 id="5-7-2-ProgressBar-进度条控件"><a href="#5-7-2-ProgressBar-进度条控件" class="headerlink" title="5.7.2 ProgressBar 进度条控件"></a>5.7.2 ProgressBar 进度条控件</h3><p>工程–部件–选中 Microsoft Windows Common Control 6.0</p>
<p>Max 属性：进度条上限<br>Min 属性：进度条下限<br>Value ：进度值<br>Scrolling ： 卷动方向形式<br>Orientation ： 纵横滚动定位<br>MousePoint ：鼠标指针</p>
<h3 id="5-7-3-Slide-滑动条控件"><a href="#5-7-3-Slide-滑动条控件" class="headerlink" title="5.7.3 Slide 滑动条控件"></a>5.7.3 Slide 滑动条控件</h3><p>工程–部件–选中 Microsoft Windows Common Control 6.0</p>
<p>TickStyle ： 决定控件上滑块及刻度的显示样式<br>TickFrequency ： 决定控件上刻度点的疏密<br>ToolTipText：指针停在该控件上时显示提示信息<br>Orientation ：决定控件在窗体上水平或垂直放置</p>
<h3 id="5-7-4-MS-Chart-控件"><a href="#5-7-4-MS-Chart-控件" class="headerlink" title="5.7.4 MS Chart 控件"></a>5.7.4 MS Chart 控件</h3><p>工程–部件–选中 Microsoft Chart Control 6.0(OLEDB)</p>
<p>BorderStyle ： 决定图表是否有外框线<br>ColumnCount ： 每一格的列数<br>RowCount ： 每一行的列数<br>ChartType ： 选择图表类型<br>TitleText ： 图题<br>ChartData 返回一个数组，该数组包含将要被该图表显示的值</p>
<p><code>MSChart1.ChartData = 数组</code></p>
<p><img src="/img/VB/tubiao.png" alt="图表控件"></p>
<h3 id="5-7-5-UpDown-控件"><a href="#5-7-5-UpDown-控件" class="headerlink" title="5.7.5 UpDown 控件"></a>5.7.5 UpDown 控件</h3><p>工程–部件–选中 Microsoft Windows Common Control-2 6.0</p>
<p>一对箭头按钮控件，单击按钮，增减数值<br>UpDown 通常与 Textbox 绑定</p>
<p>Max/Min 最大值最小值<br>Increment 指定每次单击上箭头或下箭头时 Value 的变化量</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">sub</span> updown1_downclick()</span><br><span class="line">    text1.updown1.value</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">sub</span> updow n1_upclick()</span><br><span class="line">    text1.updown1.value</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="5-7-6-ActiveX-控件的创建"><a href="#5-7-6-ActiveX-控件的创建" class="headerlink" title="5.7.6 ActiveX 控件的创建"></a>5.7.6 ActiveX 控件的创建</h3><p>ActiveX 是 Microsoft 对于一系列策略性面向对象程序技术和工具称呼,其中主要的技术是组件对象模型(COM)。</p>
<p><img src="/img/VB/activex.png" alt="ActiveX的三种表现形式"></p>
<p>ActiveX 部件：可执行代码：exe、dll、ocx 文件</p>
<p>ActiveX 控件标准和非标准文件：以 ocx 后缀保存在 Windows\System 目录下<br>ActiveX 控件分为：控件和插入对象 、可插入对象就是一个应用程序，如 MIcrosoft Word</p>
<p>创造自己的 ActiveX 控件</p>
<ul>
<li>启动 VB，打开 ActiveX 控件</li>
<li>UserControl 对象，为 AX 控件名称，在此进行控件制作</li>
<li>在代码窗口利用工具中的添加过程，为新的 ActiveX 控件添加共有的属性、时间等</li>
<li>界面与代码设计好后，在指定目录生成指定的 ocx，完成自制 AX 控件的工作</li>
<li>另打开 VB，通过增加部件找到所自制的 AX 控件，放在工具箱上即可使用</li>
</ul>
<h2 id="5-8-文件"><a href="#5-8-文件" class="headerlink" title="5.8 文件"></a>5.8 文件</h2><p><img src="/img/VB/file.png" alt="基本概念"></p>
<h3 id="5-8-1-顺序文件"><a href="#5-8-1-顺序文件" class="headerlink" title="5.8.1 顺序文件"></a>5.8.1 顺序文件</h3><p>ASCII 文件，由任何字处理文件建立，在 VB 中建立，只能按顺序存取记录</p>
<p>打开文件–读或写文件–关闭文件</p>
<h4 id="5-8-1-1-顺序文件打开"><a href="#5-8-1-1-顺序文件打开" class="headerlink" title="5.8.1.1 顺序文件打开"></a>5.8.1.1 顺序文件打开</h4><p>格式 Open &lt;文件名&gt; for 方式 as [#]&lt;文件号&gt;</p>
<p>Input 只读 / Output 写 / Append 添加方式</p>
<p>文件号 1 到 511 之间的整数</p>
<p><code>opnn "C:\Data\Stud.dat" For Output As #1</code></p>
<h4 id="5-8-1-2-顺序文件关闭"><a href="#5-8-1-2-顺序文件关闭" class="headerlink" title="5.8.1.2 顺序文件关闭"></a>5.8.1.2 顺序文件关闭</h4><p>Close 文件号列表</p>
<p><code>Close #1</code><br><code>Close #1,2,#8</code><br><code>Close</code> 关闭所有</p>
<h4 id="5-8-1-3-顺序文件的读写"><a href="#5-8-1-3-顺序文件的读写" class="headerlink" title="5.8.1.3 顺序文件的读写"></a>5.8.1.3 顺序文件的读写</h4><p><strong>① 写</strong></p>
<ol>
<li>Write #文件号,[输出列表]</li>
</ol>
<p><code>Write #1,A1,A2,A3</code></p>
<p>说明</p>
<ul>
<li>&lt;输出列表&gt;中各项之间要用逗号分开</li>
<li>&lt;输出列表&gt;每一项可以是常量、变量或表达式</li>
<li>写到文件中的各数据间自动插入逗号,字符串自动加上双引号</li>
<li>所有数据写完后,在最后加入一个回车换行符</li>
<li>不含&lt;输出列表&gt;时,将在文件中写入一空行</li>
</ul>
<p><strong>学号、姓名、成绩 1、2</strong>保存到文件中</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line">Dim no, na, g1, g2 As Variant</span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    no = Text1.<span class="keyword">Text</span>: na = Text2.<span class="keyword">Text</span></span><br><span class="line">    g1 = Val(Text3.<span class="keyword">Text</span>): g2 = Val(Text4.<span class="keyword">Text</span>)</span><br><span class="line">    Write <span class="meta">#2, no, na, g1, g2</span></span><br><span class="line">    Text1.<span class="keyword">Text</span> = <span class="string">""</span>: Text2.<span class="keyword">Text</span> = <span class="string">""</span>: Text3.<span class="keyword">Text</span> = <span class="string">""</span>: Text4.<span class="keyword">Text</span> = <span class="string">""</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    Close <span class="meta">#2</span></span><br><span class="line">    <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Form_Load()</span><br><span class="line">    CommonDialog1.ShowSave</span><br><span class="line">    Open CommonDialog1.FileName <span class="keyword">For</span> Append <span class="keyword">As</span> <span class="meta">#2</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<ol start="2">
<li>print #文件号，输出列表</li>
</ol>
<p><code>print #2, no ,na, g1, g2</code><br><code>print #2, no; na; g1; g2</code></p>
<p>将输出列表中的内容写入指定文件<br>说明</p>
<ul>
<li>当&lt;输出列表&gt;用逗号分隔时,采用分区格式输出</li>
<li>当&lt;输出列表&gt;用分号分隔时,采用紧凑格式输出</li>
<li>所有项将在一行内输出,输出后将自动换行</li>
<li>可以使用 Spc()函数和 Tab()函数</li>
</ul>
<p><img src="/img/VB/writeprint.png" alt="两者区别"></p>
<p><strong>② 读</strong></p>
<ol>
<li>input #文件号,变量列表</li>
<li>Line input #文件号，变量名</li>
<li>eof(文件号) 函数</li>
</ol>
<p><strong>读取文件中的程序，计算平均成绩</strong></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Dim</span> num, nam, s1, s2, ave</span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    CommonDialog1.ShowOpen</span><br><span class="line">    Open CommonDialog1.FileName <span class="keyword">For</span> Input <span class="keyword">As</span> <span class="meta">#3</span></span><br><span class="line">    Text1.<span class="keyword">Text</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">Do</span> <span class="keyword">While</span> <span class="keyword">Not</span> EOF(<span class="number">3</span>)</span><br><span class="line">   <span class="comment">' 装入用Wite# 语句生成的文件</span></span><br><span class="line">        Input <span class="meta">#3, num, nam, s1, s2</span></span><br><span class="line">        ave = (s1 + s2) / <span class="number">2</span></span><br><span class="line">        Text1.<span class="keyword">Text</span> = Text1.<span class="keyword">Text</span> &amp; num &amp; <span class="string">"   "</span> &amp; nam _</span><br><span class="line">                        &amp; <span class="string">"   "</span> &amp; Str(s1) &amp; <span class="string">"    "</span> &amp; Str(s2) &amp; _</span><br><span class="line">                        <span class="string">"  "</span> &amp; Str(ave) &amp; Chr(<span class="number">13</span>) &amp; Chr(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">Loop</span></span><br><span class="line">    Close <span class="meta">#3</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>计算每个同学的平均成绩，并同时将结果与原数据保存到另一个文件</strong></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Dim</span> num(<span class="number">100</span>) <span class="keyword">As</span> <span class="built_in">String</span>, nam(<span class="number">100</span>) <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line"><span class="keyword">Dim</span> g(<span class="number">100</span>, <span class="number">2</span>) <span class="keyword">As</span> <span class="built_in">Integer</span>, n <span class="keyword">As</span> <span class="built_in">Integer</span>, ave, sum1, sum2, i</span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    CommonDialog1.ShowOpen</span><br><span class="line">    Open CommonDialog1.FileName <span class="keyword">For</span> Input <span class="keyword">As</span> <span class="meta">#3</span></span><br><span class="line">        n = <span class="number">0</span></span><br><span class="line">        <span class="keyword">Do</span> <span class="keyword">While</span> <span class="keyword">Not</span> EOF(<span class="number">3</span>)</span><br><span class="line">            n = n + <span class="number">1</span></span><br><span class="line">            Input <span class="meta">#3, num(n), nam(n), g(n, 1), g(n, 2)</span></span><br><span class="line">        Text1.<span class="keyword">Text</span> = Text1.<span class="keyword">Text</span> &amp; <span class="string">"   "</span> &amp; num(n) &amp; _</span><br><span class="line">        <span class="string">"   "</span> &amp; nam(n) &amp; <span class="string">"    "</span> &amp; Str(g(n, <span class="number">1</span>)) &amp; _</span><br><span class="line">        <span class="string">"   "</span> &amp; Str(g(n, <span class="number">2</span>)) &amp; <span class="string">"    "</span> &amp; Chr(<span class="number">13</span>) &amp; Chr(<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">Loop</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    CommonDialog1.ShowSave</span><br><span class="line">    Open CommonDialog1.FileName <span class="keyword">For</span> Output <span class="keyword">As</span> <span class="meta">#4</span></span><br><span class="line">    sum1 = <span class="number">0</span></span><br><span class="line">    sum2 = <span class="number">0</span></span><br><span class="line">    Text2.<span class="keyword">Text</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> n</span><br><span class="line">        ave = (g(i, <span class="number">1</span>) + g(i, <span class="number">2</span>)) / <span class="number">2</span></span><br><span class="line">        Write <span class="meta">#4, num(i), nam(i), g(i, 1), g(i, 2), ave</span></span><br><span class="line">        Text2.<span class="keyword">Text</span> = Text2.<span class="keyword">Text</span> &amp; <span class="string">"   "</span> &amp; num(i) &amp; _</span><br><span class="line">        <span class="string">"   "</span> &amp; nam(i) &amp; <span class="string">"   "</span> &amp; Str(g(i, <span class="number">1</span>)) &amp; <span class="string">"   "</span> &amp; _</span><br><span class="line">        Str(g(i, <span class="number">2</span>)) &amp; <span class="string">"   "</span> &amp; Str(ave) &amp; vbCrLf</span><br><span class="line">        sum1 = sum1 + g(i, <span class="number">1</span>): sum2 = sum2 + g(i, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line">    Text2.<span class="keyword">Text</span> = Text2.<span class="keyword">Text</span> &amp; <span class="string">"average"</span> &amp; <span class="string">" "</span> &amp; _</span><br><span class="line">    Str(sum1 / n) &amp; <span class="string">"   "</span> &amp; Str(sum2 / n)</span><br><span class="line">    Write <span class="meta">#4, "总平均", sum1 / n, sum2 / n</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command3_Click()</span><br><span class="line">    Close <span class="meta">#3, #4</span></span><br><span class="line">    <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="5-8-2-随机文件"><a href="#5-8-2-随机文件" class="headerlink" title="5.8.2 随机文件"></a>5.8.2 随机文件</h3><p>读写次序任意，记录长度相等，随机文件中的记录常定义为用户自定义类型</p>
<p><strong>自定义数据类型操作</strong></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span>/<span class="keyword">public</span> type 自定义类型名</span><br><span class="line">    元素名 下标 <span class="keyword">as</span> 类型</span><br><span class="line"><span class="keyword">end</span> type</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/VB/sjwjsm1.png" alt=""><br><img src="/img/VB/sjwjsm2.png" alt="说明"></p>
<p><img src="/img/VB/sjwjex.png" alt="例子"><br><img src="/img/VB/sjwjex1.png" alt="例子"></p>
<h4 id="5-8-2-1-随机文件打开"><a href="#5-8-2-1-随机文件打开" class="headerlink" title="5.8.2.1 随机文件打开"></a>5.8.2.1 随机文件打开</h4><p><code>open 文件名 [for random] as 文件号 len= 记录长度</code><br>for random 可以省略<br>记录长度：就是自定义类型的大小，可以用 len 获得<br>若文件不存在，则建立新的文件</p>
<h4 id="5-8-2-2-随机文件关闭"><a href="#5-8-2-2-随机文件关闭" class="headerlink" title="5.8.2.2 随机文件关闭"></a>5.8.2.2 随机文件关闭</h4><p><code>close #2</code></p>
<h4 id="5-8-2-3-随机文件写"><a href="#5-8-2-3-随机文件写" class="headerlink" title="5.8.2.3 随机文件写"></a>5.8.2.3 随机文件写</h4><p><code>put 文件号，记录号，变量名</code></p>
<p><img src="/img/VB/sjwjxie.png" alt="写文件"></p>
<h4 id="5-8-2-4-随机文件读"><a href="#5-8-2-4-随机文件读" class="headerlink" title="5.8.2.4 随机文件读"></a>5.8.2.4 随机文件读</h4><p><code>get #文件号， 记录号， 变量名</code><br>功能： 将一个一打开的随机文件读入一个变量之中</p>
<p><img src="/img/VB/sjwjdxex0.png" alt="例子"></p>
<p><img src="/img/VB/sjwjdxex.png" alt="例子"><br><img src="/img/VB/sjwjdxex1.png" alt="例子"></p>
<h3 id="5-8-3-总结"><a href="#5-8-3-总结" class="headerlink" title="5.8.3 总结"></a>5.8.3 总结</h3><p><img src="/img/VB/filezongjie.png" alt="文件操作总结"></p>
<p>开闭 写读</p>
<ul>
<li>open 语句</li>
<li>close 语句</li>
<li>write\print 语句</li>
<li>input\line input 语句 ， input 函数</li>
</ul>
<hr>
<ul>
<li>open 语句</li>
<li>close 语句</li>
<li>put 语句</li>
<li>get 语句</li>
</ul>
<h2 id="5-9-绘图"><a href="#5-9-绘图" class="headerlink" title="5.9 绘图"></a>5.9 绘图</h2><h3 id="5-9-1-图形设计基础"><a href="#5-9-1-图形设计基础" class="headerlink" title="5.9.1 图形设计基础"></a>5.9.1 图形设计基础</h3><h4 id="5-9-1-1-坐标系统"><a href="#5-9-1-1-坐标系统" class="headerlink" title="5.9.1.1 坐标系统"></a>5.9.1.1 坐标系统</h4><p>左上角（0，0）横向 x，纵向 y</p>
<ol>
<li>刻度单位</li>
</ol>
<p><img src="/img/VB/kddw.png" alt="刻度单位"></p>
<ol start="2">
<li>改变坐标系</li>
</ol>
<p><strong>自定义坐标体系</strong></p>
<p><img src="/img/VB/zdyzbx.png" alt="自定义坐标体系"></p>
<p><code>ScaleLeft</code> <code>ScaleTop</code>属性 ， 窗体左边的坐标，上边的坐标</p>
<p><code>ScaleWidth</code> <code>ScaleHeight</code>属性 ，容器对象内部的宽度和高度，将</p>
<p><img src="/img/VB/zbxex1.png" alt="例子"></p>
<p><img src="/img/VB/zbxex2.png" alt="例子"></p>
<p><img src="/img/VB/zbxex3.png" alt="例子"></p>
<p>Scale 方法：<br><code>对象名.Scale[(x1,y1)-(x2,y2)]</code></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> picture1_click()</span><br><span class="line">    <span class="keyword">dim</span> a(<span class="number">5</span>,<span class="number">5</span>) <span class="keyword">as</span> <span class="built_in">integer</span>, i <span class="keyword">as</span> <span class="built_in">integer</span> , j <span class="keyword">as</span> <span class="built_in">integer</span></span><br><span class="line">    picture1.scale (<span class="number">0</span>,<span class="number">0</span>)-(<span class="number">6</span>,<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">1</span> <span class="keyword">to</span> <span class="number">5</span></span><br><span class="line">        picture1.currenty = i</span><br><span class="line">        <span class="keyword">for</span> j=<span class="number">1</span> <span class="keyword">to</span> <span class="number">5</span></span><br><span class="line">            <span class="keyword">if</span> i = j <span class="keyword">then</span> a(i,j) = <span class="number">1</span> <span class="keyword">else</span> a(i,j) = <span class="number">0</span></span><br><span class="line">            picture1.currentx = j</span><br><span class="line">            picture1.print a(i,j);</span><br><span class="line">    <span class="keyword">next</span> j,i</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">sub</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/VB/scale.png" alt="例子"></p>
<ol start="3">
<li>当前坐标</li>
</ol>
<p><code>currentx</code> <code>currenty</code></p>
<ol start="4">
<li>位置大小相关属性</li>
</ol>
<p><img src="/img/VB/wzdxxg.png" alt="例子"></p>
<h4 id="5-9-1-2-颜色"><a href="#5-9-1-2-颜色" class="headerlink" title="5.9.1.2 颜色"></a>5.9.1.2 颜色</h4><p>颜色值：四字节，长整型<br>RGB    每个字节取值：00-FF （或0-255）</p>
<ol>
<li>设计阶段设置</li>
<li>运行阶段设置</li>
</ol>
<p>RGB函数：<code>RGB(red,green,blue)</code><br>eg:<code>form1.backcolor = RGB(255,0,0)</code></p>
<p>或者</p>
<p>QBColor函数： <code>QbColor(value)</code><br>value ： 0-7颜色加亮、 8-15<br>0黑1蓝2绿3青4红5紫红6黄7浅灰色</p>
<p>或者</p>
<p>使用颜色常量<br><code>vbblack</code> <code>vbred</code> <code>vbgreen</code> <code>vbyellow</code> <code>vbwhite</code><br><code>vbblue</code>  <code>vbmagenta洋红</code> <code>vbcyan青色</code> </p>
<p>或者</p>
<p>使用颜色的十六进制 <code>&amp;H00BBGGRR&amp;</code></p>
<p>使用系统颜色 <code>vbscrollbars &amp;H80000000</code>滚动条颜色</p>
<h3 id="5-9-2-图形控件"><a href="#5-9-2-图形控件" class="headerlink" title="5.9.2 图形控件"></a>5.9.2 图形控件</h3><h4 id="5-9-2-1-Picture控件"><a href="#5-9-2-1-Picture控件" class="headerlink" title="5.9.2.1 Picture控件"></a>5.9.2.1 Picture控件</h4><p>可以显示图片，可以作为其他控件的容器</p>
<ul>
<li>设计阶段</li>
<li>程序运行中：<code>LoadPicture()</code></li>
</ul>
<p><code>Autosize</code>为True时 自动调整大小与显示的图片匹配</p>
<h4 id="5-9-2-2-Image控件"><a href="#5-9-2-2-Image控件" class="headerlink" title="5.9.2.2 Image控件"></a>5.9.2.2 Image控件</h4><p>可以显示图像，内存占用小<br>Stretch属性 拉伸位图和图标，适应图像框的大小</p>
<h4 id="5-9-2-3-Shape控件"><a href="#5-9-2-3-Shape控件" class="headerlink" title="5.9.2.3 Shape控件"></a>5.9.2.3 Shape控件</h4><p>属性：Shape、FillStyle、BackColor、FillColor等属性</p>
<p>方法：<code>object.Move left[,top[,width[,height]]]</code></p>
<p><img src="/img/VB/shapeex.png" alt="例子"></p>
<h4 id="5-9-2-4-Line控件"><a href="#5-9-2-4-Line控件" class="headerlink" title="5.9.2.4 Line控件"></a>5.9.2.4 Line控件</h4><p>设计时再窗体上绘制直线</p>
<p><code>BorderStyle</code> 、 <code>BorderWidth</code></p>
<h3 id="5-9-3-绘图方法"><a href="#5-9-3-绘图方法" class="headerlink" title="5.9.3 绘图方法"></a>5.9.3 绘图方法</h3><p><img src="/img/VB/htff.png" alt="绘图方法"></p>
<h4 id="5-9-3-1-画点方法Pset"><a href="#5-9-3-1-画点方法Pset" class="headerlink" title="5.9.3.1 画点方法Pset"></a>5.9.3.1 画点方法Pset</h4><p><code>对象名.Pset[step](x,y)[,颜色]</code><br>在对象指定位置，用给定的颜色画点</p>
<ul>
<li>Step 可选，指定相对于又currentx和y 属性提供的坐标</li>
<li>x，y 点的水平和垂直坐标</li>
<li>颜色 绘制该店的RGB颜色</li>
</ul>
<p><img src="/img/VB/psetex.png" alt="例子1"></p>
<p><img src="/img/VB/psetex1.png" alt="例子2"><br><img src="/img/VB/psetex2.png" alt="例子2"></p>
<h4 id="5-9-3-2-画线、画矩形Line"><a href="#5-9-3-2-画线、画矩形Line" class="headerlink" title="5.9.3.2 画线、画矩形Line"></a>5.9.3.2 画线、画矩形Line</h4><p><code>对象名.Line[step][(x1,y1)]-[step]\(x2,y2)[,color[,B[F]]]</code></p>
<p><img src="/img/VB/line.png" alt="Line"></p>
<p><img src="/img/VB/lineex1.png" alt="例子1"></p>
<p><img src="/img/VB/lineex2.png" alt="例子2"></p>
<p><img src="/img/VB/lineex3.png" alt="例子3"><br><img src="/img/VB/lineex4.png" alt="例子3"></p>
<h4 id="5-9-3-3-画圆-Circle"><a href="#5-9-3-3-画圆-Circle" class="headerlink" title="5.9.3.3 画圆 Circle"></a>5.9.3.3 画圆 Circle</h4><p><img src="/img/VB/circle.png" alt="画圆"></p>
<p><img src="/img/VB/circleex.png" alt="画圆例子"></p>
<p><img src="/img/VB/circleex1.png" alt="画圆例子1"><br><img src="/img/VB/circleex2.png" alt="画圆例子1"></p>
<h4 id="5-9-3-4-使用point方法返回指定点的颜色"><a href="#5-9-3-4-使用point方法返回指定点的颜色" class="headerlink" title="5.9.3.4 使用point方法返回指定点的颜色"></a>5.9.3.4 使用point方法返回指定点的颜色</h4><p><img src="/img/VB/pointex.png" alt="Point例子"></p>
<h2 id="5-10-高级界面设计"><a href="#5-10-高级界面设计" class="headerlink" title="5.10 高级界面设计"></a>5.10 高级界面设计</h2><h3 id="5-10-1-多文档界面MDI"><a href="#5-10-1-多文档界面MDI" class="headerlink" title="5.10.1 多文档界面MDI"></a>5.10.1 多文档界面MDI</h3><p><img src="/img/VB/mdi.png" alt="MDI"></p>
<h2 id="5-11-开发多媒体应用程序"><a href="#5-11-开发多媒体应用程序" class="headerlink" title="5.11 开发多媒体应用程序"></a>5.11 开发多媒体应用程序</h2><p>概述：MMControl控件<br><strong>播放动作的5个步骤</strong></p>
<ul>
<li>选择播放设备 DeviceType</li>
<li>选择播放文件名 FileName</li>
<li>打开文件 Open</li>
<li>播放文件 Play</li>
<li>关闭 Close</li>
</ul>
<p><img src="/img/VB/mci.png" alt="MCI控件"></p>
<p><strong>MM控件的主要属性和事件</strong></p>
<p><img src="/img/VB/mmcontrol.png" alt="MMControl"></p>
<p><img src="/img/VB/mmccommand.png" alt="MMCommand"></p>
<p><img src="/img/VB/mmcothers.png" alt="其他属性"></p>
<p><img src="/img/VB/mmcmake.png" alt="制作播放器1"></p>
<p><img src="/img/VB/mmcmake2.png" alt="制作播放器2"></p>
<p><img src="/img/VB/api.png" alt="使用API多媒体函数实现播放"></p>
<p><img src="/img/VB/apiuse.png" alt="使用API多媒体函数实现播放"></p>
<p><img src="/img/VB/apiuse2.png" alt="使用API多媒体函数实现播放"></p>
<p><img src="/img/VB/apiuse3.png" alt="使用API多媒体函数实现播放"></p>
<p><em>直接搜API浏览器，打开文件，然后选择需要的函数，拷贝</em></p>
<p><strong>拷贝内容</strong></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> sndPlaySound <span class="keyword">Lib</span> <span class="string">"winmm.dll"</span> <span class="keyword">Alias</span> <span class="string">"sndPlaySoundA"</span> (<span class="keyword">ByVal</span> lpszSoundName <span class="keyword">As</span> <span class="built_in">String</span>, <span class="keyword">ByVal</span> uFlags <span class="keyword">As</span> <span class="built_in">Long</span>) <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> SND_ASYNC = &amp;H1         <span class="comment">'  play asynchronously</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> SND_LOOP = &amp;H8         <span class="comment">'  loop the sound until next sndPlaySound</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> SND_SYNC = &amp;H0         <span class="comment">'  play synchronously (default)</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/VB/apiex.png" alt="使用API多媒体函数实现播放例子"></p>
<p><img src="/img/VB/apiex1.png" alt="使用API多媒体函数实现播放例子"></p>
<p><img src="/img/VB/apiex2.png" alt="使用API多媒体函数实现播放例子"></p>
<h2 id="5-12-数据库访问技术"><a href="#5-12-数据库访问技术" class="headerlink" title="5.12 数据库访问技术"></a>5.12 数据库访问技术</h2><p><img src="/img/VB/sjk.png" alt="数据库概念"></p>
<p><strong>数据库管理系统</strong><br>有：Access Interbase SQLServer DB2 MySql 等等</p>
<h3 id="5-12-1-关系型数据库"><a href="#5-12-1-关系型数据库" class="headerlink" title="5.12.1 关系型数据库"></a>5.12.1 关系型数据库</h3><p>表、记录与字段、关键字、表间关系、外部键、索引</p>
<p><img src="/img/VB/gxxsjk.png" alt="关系型数据库概念"></p>
<p><img src="/img/VB/gxxsjk1.png" alt="关系型数据库字段、记录、关键字"></p>
<p><img src="/img/VB/gxxsjk2.png" alt="关系型数据库表间关系"></p>
<p><img src="/img/VB/gxxsjk3.png" alt="关系型数据库外部键、索引"></p>
<h3 id="5-12-2-用可视化数据管理器建立和维护数据库"><a href="#5-12-2-用可视化数据管理器建立和维护数据库" class="headerlink" title="5.12.2 用可视化数据管理器建立和维护数据库"></a>5.12.2 用可视化数据管理器建立和维护数据库</h3><p><img src="/img/VB/kshsjglq.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq1.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq2.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq3.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq4.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq5.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq6.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq7.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq8.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq9.png" alt="可视化数据管理器"></p>
<h2 id="5-13-总复习"><a href="#5-13-总复习" class="headerlink" title="5.13 总复习"></a>5.13 总复习</h2><h3 id="5-13-1-同心圆"><a href="#5-13-1-同心圆" class="headerlink" title="5.13.1 同心圆"></a>5.13.1 同心圆</h3><p><img src="/img/VB/txy.png" alt="案例1"><br><img src="/img/VB/txy2.png" alt="案例1"></p>
<h3 id="5-13-2-两圆转动"><a href="#5-13-2-两圆转动" class="headerlink" title="5.13.2 两圆转动"></a>5.13.2 两圆转动</h3><p><img src="/img/VB/yzyd.png" alt="案例2"><br><img src="/img/VB/yzyd2.png" alt="案例2"></p>
<h3 id="5-13-3-密码输入，文本框飘动"><a href="#5-13-3-密码输入，文本框飘动" class="headerlink" title="5.13.3 密码输入，文本框飘动"></a>5.13.3 密码输入，文本框飘动</h3><p><img src="/img/VB/mimayd.png" alt="案例3"></p>
<h3 id="5-13-4-网络连接计时"><a href="#5-13-4-网络连接计时" class="headerlink" title="5.13.4 网络连接计时"></a>5.13.4 网络连接计时</h3><p><img src="/img/VB/wlljjs.png" alt="案例4"><br><img src="/img/VB/wlljjs2.png" alt="案例4"></p>
<h1 id="6-课程学习过程中练习"><a href="#6-课程学习过程中练习" class="headerlink" title="6. 课程学习过程中练习"></a>6. 课程学习过程中练习</h1><p>第几次课.第几道练习</p>
<h2 id="2-1-勾选要求变量声明（初学）"><a href="#2-1-勾选要求变量声明（初学）" class="headerlink" title="2.1 勾选要求变量声明（初学）"></a>2.1 勾选要求变量声明（初学）</h2><p>然后每次使用必须先定义变量</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Dim</span> B <span class="keyword">As</span> <span class="built_in">Integer</span>, A <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    B = <span class="number">10</span></span><br><span class="line">    A = A + B</span><br><span class="line">    Print B, A</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="comment">'10 10</span></span><br><span class="line"><span class="comment">'10 10</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Static</span> B <span class="keyword">As</span> <span class="built_in">Integer</span>, A <span class="keyword">As</span> <span class="built_in">Integer</span>     <span class="comment">'静态变量</span></span><br><span class="line">    B = <span class="number">10</span></span><br><span class="line">    A = A + B</span><br><span class="line">    Print B, A</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="comment">'10 10</span></span><br><span class="line"><span class="comment">'10 20</span></span><br><span class="line"><span class="comment">'10 30</span></span><br></pre></td></tr></tbody></table></figure>

<p>Dim 和 Static 都是局部变量可以将其拉到窗体级全局变量</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line">    <span class="keyword">Dim</span> B <span class="keyword">As</span> <span class="built_in">Integer</span>, A <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line"></span><br><span class="line">    B = <span class="number">10</span></span><br><span class="line">    A = A + B</span><br><span class="line">    Print B, A</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    Print B, A</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-2-字符判断"><a href="#2-2-字符判断" class="headerlink" title="2.2 字符判断"></a>2.2 字符判断</h2><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Text1_Change()</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> IsNumeric(Text1) <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">"Text1 输入非法数字，请重新输入"</span></span><br><span class="line">        Text1.<span class="keyword">Text</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-3-inputbox-amp-keypress"><a href="#2-3-inputbox-amp-keypress" class="headerlink" title="2.3 inputbox &amp; keypress"></a>2.3 inputbox &amp; keypress</h2><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Label2_Click()</span><br><span class="line">    Text3 = Val(Text1) + Val(Text2)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Text1_KeyPress(KeyAscii <span class="keyword">As</span> <span class="built_in">Integer</span>)</span><br><span class="line">    <span class="keyword">If</span> KeyAscii = <span class="number">13</span> <span class="keyword">Then</span> Text2 = InputBox(<span class="string">"请输入"</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Text3_GotFocus()</span><br><span class="line">    Text1 = <span class="string">""</span></span><br><span class="line">    Text2 = <span class="string">""</span></span><br><span class="line">    Text3 = <span class="string">""</span></span><br><span class="line">    Text1.SetFocus</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-1-DIY"><a href="#3-1-DIY" class="headerlink" title="3.1 DIY"></a>3.1 DIY</h2><p><strong>换行 text 的 multline 属性要为 true</strong><br><code>chr(13) + chr(10)</code><br><code>vbcrlf</code></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Dim</span> ID <span class="keyword">As</span> <span class="built_in">Boolean</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    ID = <span class="literal">True</span></span><br><span class="line">    Timer1.Interval = <span class="number">600</span></span><br><span class="line">    Text1 = <span class="string">"DIY"</span> + Chr(<span class="number">13</span>) + Chr(<span class="number">10</span>) + <span class="string">"程序设计"</span>  <span class="comment">'回车换行</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    ID = <span class="literal">False</span></span><br><span class="line">    Text1.Alignment = <span class="number">0</span> <span class="comment">'居左</span></span><br><span class="line">    Text1.FontSize = <span class="number">50</span></span><br><span class="line">    Text1 = <span class="string">"1111"</span> &amp; vbCrLf _</span><br><span class="line">    &amp; <span class="string">"fads"</span> + vbCrLf _</span><br><span class="line">    &amp; <span class="string">"7777"</span> + Chr(<span class="number">13</span>) + Chr(<span class="number">10</span>)  <span class="comment">'回车加换行</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Timer1_Timer()</span><br><span class="line">    <span class="keyword">Dim</span> A <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    Randomize</span><br><span class="line">    A = Rnd * <span class="number">4</span>      <span class="comment">'rnd 0-1</span></span><br><span class="line">    Text1.ForeColor = RGB(Rnd * <span class="number">250</span>, Rnd * <span class="number">250</span>, Rnd * <span class="number">250</span>)</span><br><span class="line">    <span class="keyword">If</span> ID <span class="keyword">Then</span></span><br><span class="line">        Text1.FontSize = Rnd * <span class="number">260</span></span><br><span class="line">        Text1.FontBold = <span class="literal">True</span>   <span class="comment">'粗体字</span></span><br><span class="line">        <span class="keyword">Select</span> <span class="keyword">Case</span> A</span><br><span class="line">        <span class="keyword">Case</span> <span class="number">0</span></span><br><span class="line">            Text1.FontName = <span class="string">"隶书"</span></span><br><span class="line">            Text1.Alignment = <span class="number">0</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="number">1</span></span><br><span class="line">            Text1.FontName = <span class="string">"黑体"</span></span><br><span class="line">            Text1.Alignment = <span class="number">1</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="number">2</span></span><br><span class="line">            Text1.FontName = <span class="string">"楷体"</span></span><br><span class="line">            Text1.Alignment = <span class="number">2</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-2-for"><a href="#3-2-for" class="headerlink" title="3.2 for"></a>3.2 for</h2><p><code>cls</code>清屏</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span>, j <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span></span><br><span class="line">        <span class="keyword">For</span> j = <span class="number">5</span> <span class="keyword">To</span> <span class="number">7</span></span><br><span class="line">            Print i, j</span><br><span class="line">        <span class="keyword">Next</span> j</span><br><span class="line">        Print <span class="string">"---------"</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    <span class="keyword">Dim</span> a       <span class="comment">'必须用变体</span></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> a <span class="keyword">In</span> Form1.Controls</span><br><span class="line">        a.BackColor = vbRed</span><br><span class="line">    <span class="keyword">Next</span> a</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command3_Click()</span><br><span class="line">    Cls</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-3-for-与-if-可以互换"><a href="#3-3-for-与-if-可以互换" class="headerlink" title="3.3 for 与 if 可以互换"></a>3.3 for 与 if 可以互换</h2><p><code>goto 111</code></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="comment">'Dim i As Integer, s As Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> i, a, j, b</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">100</span></span><br><span class="line">        a = a + i</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="number">111</span> <span class="keyword">If</span> j &lt;= <span class="number">100</span> <span class="keyword">Then</span></span><br><span class="line">        b = b + j</span><br><span class="line">        j = j + <span class="number">1</span></span><br><span class="line">        <span class="keyword">GoTo</span> <span class="number">111</span></span><br><span class="line">    E</span><br><span class="line">    Print a</span><br><span class="line">    Print b</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-1-求积"><a href="#4-1-求积" class="headerlink" title="4.1 求积"></a>4.1 求积</h2><p><img src="/img/VB/kclx4_1.png" alt="例子"></p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Form DblClick</span><br><span class="line">    <span class="keyword">Dim</span> a (<span class="number">1</span> <span class="keyword">To</span> <span class="number">5</span>) <span class="keyword">As</span> <span class="built_in">integer</span>, b (<span class="number">3</span> <span class="keyword">To</span> <span class="number">8</span>)<span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    <span class="keyword">For</span> i=<span class="number">1</span> <span class="keyword">to</span> <span class="number">5</span></span><br><span class="line">        a(i) = i</span><br><span class="line">        picture3.Print a(i)</span><br><span class="line">    <span class="keyword">For</span> i=<span class="number">3</span> <span class="keyword">to</span> <span class="number">8</span></span><br><span class="line">        b(i) = i</span><br><span class="line">        Picture4.Print b(i)</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line">    MsgBox<span class="string">"开始计算"</span></span><br><span class="line">    Text1= tim(a())</span><br><span class="line">    Text2= tim(b())</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">sub</span></span><br><span class="line"><span class="keyword">Function</span> tim(x() <span class="keyword">As</span> <span class="built_in">Integer</span>)</span><br><span class="line">    <span class="keyword">Dim</span> t <span class="keyword">As</span> <span class="built_in">double</span>, i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    t=<span class="number">1</span></span><br><span class="line">    <span class="keyword">For</span> i= LBound (x) <span class="keyword">To</span> UBound(x)</span><br><span class="line">        t= t*x(i)</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line">    tim = t</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">function</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-2-控件数组–将五个-shape-从上到下移动"><a href="#4-2-控件数组–将五个-shape-从上到下移动" class="headerlink" title="4.2 控件数组–将五个 shape 从上到下移动"></a>4.2 控件数组–将五个 shape 从上到下移动</h2><p>设置好属性—复制，粘贴，名称一样的控件数组</p>
<p>shape1 重命名为 S1</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    Timer1.Interval = <span class="number">50</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Timer1_Timer()</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">4</span></span><br><span class="line">        <span class="comment">' 改变颜色  ---不同颜色</span></span><br><span class="line">        <span class="comment">' S1(i).BackColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)</span></span><br><span class="line">        <span class="comment">' S1(i).BorderColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)</span></span><br><span class="line">        <span class="keyword">If</span> S1(i).Top + S1(i).Height &gt; Form1.ScaleHeight <span class="keyword">Then</span></span><br><span class="line">            S1(i).Top = <span class="number">0</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            S1(i).Top = S1(i).Top + <span class="number">100</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    Timer1.Interval = <span class="number">50</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Timer1_Timer()</span><br><span class="line">    <span class="keyword">Dim</span> A</span><br><span class="line">    A = RGB(Rnd * <span class="number">250</span>, Rnd * <span class="number">250</span>, Rnd * <span class="number">250</span>)  <span class="comment">' 相同颜色</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">4</span></span><br><span class="line">        S1(i).BackColor = A</span><br><span class="line">        S1(i).BorderColor = A</span><br><span class="line">        <span class="comment">' S1(i).BackColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)</span></span><br><span class="line">        <span class="comment">' S1(i).BorderColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)</span></span><br><span class="line">        <span class="keyword">If</span> S1(i).Top + S1(i).Height &gt; Form1.ScaleHeight <span class="keyword">Then</span></span><br><span class="line">            S1(i).Top = <span class="number">0</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            S1(i).Top = S1(i).Top + <span class="number">100</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-3-所有控件的移动"><a href="#4-3-所有控件的移动" class="headerlink" title="4.3 所有控件的移动"></a>4.3 所有控件的移动</h2><figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line">    Dim i As Variant  ' 变体型变量</span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> i <span class="keyword">In</span> Form1.Controls</span><br><span class="line">        <span class="keyword">If</span> i.Top + i.Height &gt; Form1.ScaleHeight <span class="keyword">Then</span></span><br><span class="line">            i.Top = <span class="number">0</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            i.Top = i.Top + <span class="number">500</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-4-模块、多窗口"><a href="#4-4-模块、多窗口" class="headerlink" title="4.4 模块、多窗口"></a>4.4 模块、多窗口</h2><p><code>form2.show</code>打开 form2<br>新建 module，然后将子过程放入 module，可以在 form1 中调用</p>
<figure class="highlight vb"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">' module1:</span></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> fact(n <span class="keyword">As</span> <span class="built_in">Integer</span>, f <span class="keyword">As</span> <span class="built_in">Long</span>)</span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">    f = <span class="number">1</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> n</span><br><span class="line">        f = f * i</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">' form1</span></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Dim</span> s <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">        <span class="keyword">Call</span> fact(Val(Text1), s)</span><br><span class="line">        Print Val(Text1); s</span><br><span class="line">        Text1.SetFocus</span><br><span class="line">        Text1 = <span class="string">""</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command2_Click()</span><br><span class="line">    Form2.Show</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">' form2</span></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line">    <span class="keyword">Dim</span> s <span class="keyword">As</span> <span class="built_in">Long</span></span><br><span class="line">    <span class="keyword">Call</span> fact(<span class="number">8</span>, s)</span><br><span class="line">    Print <span class="number">8</span>; s</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="tags"><a href="/tags/Note/"><i class="fa fa-tag"></i>Note</a><a href="/tags/VB/"><i class="fa fa-tag"></i>VB</a></div><div class="post-nav"><a class="pre" href="/2020/02/16/learn-vb/">Learn-VB</a><a class="next" href="/2020/02/15/note-java/">Java-Note</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15px;">前端</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Bilibili/" style="font-size: 15px;">Bilibili</a> <a href="/tags/Spider/" style="font-size: 15px;">Spider</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Note/" style="font-size: 15px;">Note</a> <a href="/tags/Compete/" style="font-size: 15px;">Compete</a> <a href="/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/tags/Jsoup/" style="font-size: 15px;">Jsoup</a> <a href="/tags/VB/" style="font-size: 15px;">VB</a> <a href="/tags/Server/" style="font-size: 15px;">Server</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/C/" style="font-size: 15px;">C#</a> <a href="/tags/Questions/" style="font-size: 15px;">Questions</a> <a href="/tags/Api/" style="font-size: 15px;">Api</a> <a href="/tags/Source/" style="font-size: 15px;">Source</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Life/" style="font-size: 15px;">Life</a> <a href="/tags/Imagination/" style="font-size: 15px;">Imagination</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a><span class="category-list-count">32</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%83%B3%E8%B1%A1%E5%8A%9B/">想象力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%8A%9B/">技术力</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A0%E5%8A%9B/">无力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B5%84%E6%BA%90%E5%8A%9B/">资源力</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/07/review-vb/">VB的作业和复习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/26/css-project-study/">CSS学习中跟着老师做的几个项目</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/09/learn-ks/">快捷键——让学习更高效</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/08/note-cs/">C#-Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/python-threading/">Python多线程学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/yq-fund/">理财笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/02/python-pyqt/">Python中PyQt库的学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/31/python-schedule/">Python中schedule库的学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/31/python-pil/">Python中PIL库的学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/25/note-hcj/">前端开发的基础知识</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Yun.Qi.</a> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> | Theme by<a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Maupassant</a><br/><span class="footer-birthday-text">Birthday</span><span class="footer-birthday-date">2020/02/04</span></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>