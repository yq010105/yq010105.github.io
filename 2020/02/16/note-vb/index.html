<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="VB-Note, Yun.Qi">
    <meta name="description" content="VB语言学习过程，这个学期开始学习VB，提前作预习，VB笔记本">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>VB-Note | Yun.Qi</title>
    <link rel="icon" type="image/png" href="/favicon3.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/blog.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Yun.Qi</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="https://yq010105.github.io/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/APP" class="waves-effect waves-light">
      
      <i class="fab fa-artstation" style="zoom: 0.6;"></i>
      
      <span>APP</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/diary" class="waves-effect waves-light">
      
      <i class="fas fa-book" style="zoom: 0.6;"></i>
      
      <span>Diary</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/blog.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Yun.Qi</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="https://yq010105.github.io/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/APP" class="waves-effect waves-light">
			
			    <i class="fa-fw fab fa-artstation"></i>
			
			APP
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/diary" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-book"></i>
			
			Diary
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/yq010105/yq010105.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #F062A7 ;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/yq010105/yq010105.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入密码')).toString(CryptoJS.enc.Hex)) {
                alert('あなたは私のマスターではありません');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/img/cover/vb.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">VB-Note</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Note/">
                                <span class="chip bg-color">Note</span>
                            </a>
                        
                            <a href="/tags/VB/">
                                <span class="chip bg-color">VB</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/" class="post-category">
                                学习力
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2020-02-16
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2020-04-21
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    11,749
                </div>
                

                

                
            </div>

        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><strong>VB 语言学习笔记</strong></p>
<blockquote>
<p><a href="https://www.vbtutor.net/chinese/vbtutor_Chinese.html" target="_blank" rel="noopener">参考教程</a> _ Visual Basic 是一种相当容易学习的高阶程序语言，它可使你编写几乎任何的程序_</p>
</blockquote>
<a id="more"></a>

<h1 id="1-第一个-VB-程序Hello-World"><a href="#1-第一个-VB-程序Hello-World" class="headerlink" title="1. 第一个 VB 程序Hello World"></a>1. 第一个 VB 程序<code>Hello World</code></h1><pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Load ( )

Form1.show

Print "Hello World"

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="1-1-几个小例子"><a href="#1-1-几个小例子" class="headerlink" title="1.1 几个小例子"></a>1.1 几个小例子</h2><pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Activate ( )

Print 20 + 10
Print 20 - 10
Print 20 * 10
Print 20 / 10

End Sub

# or

Private Sub Form_Activate ( )

Print 20 + 10, 20 ?10, 20 * 10, 20 / 10

End Sub

# or

Private Sub Form_Activate ( )

x = 20
y = 10
Print x + y
Print x - y
Print x * y
Print x / y

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="1-2-让程序窗口固定不变"><a href="#1-2-让程序窗口固定不变" class="headerlink" title="1.2 让程序窗口固定不变"></a>1.2 让程序窗口固定不变</h2><table>
<thead>
<tr>
<th align="center">属性窗口</th>
<th align="center">设置为</th>
</tr>
</thead>
<tbody><tr>
<td align="center">BorderStyle</td>
<td align="center">Fixed Single</td>
</tr>
<tr>
<td align="center">MaxButton</td>
<td align="center">False</td>
</tr>
<tr>
<td align="center">minButton</td>
<td align="center">True</td>
</tr>
</tbody></table>
<h1 id="2-控件-amp-控件的属性"><a href="#2-控件-amp-控件的属性" class="headerlink" title="2. 控件&amp;控件的属性"></a>2. 控件&amp;控件的属性</h1><h2 id="2-1-控件的属性"><a href="#2-1-控件的属性" class="headerlink" title="2.1 控件的属性"></a>2.1 控件的属性</h2><ul>
<li>可以在属性窗口里修改<br><img src="/img/VB/VB2_1.jpg" alt="属性窗口"></li>
<li>也可以在代码中实现修改</li>
</ul>
<pre class="line-numbers language-VB"><code class="language-VB">Private Sub Form_Load()
Form1.Show
Form1.BackColor = &H000000FF&
End Sub
## 窗口背景颜色<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Load()
Shape1.Shape = 3
End Sub
## shape控件形状<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-2-常见控件"><a href="#2-2-常见控件" class="headerlink" title="2.2 常见控件"></a>2.2 常见控件</h2><p><img src="/img/VB/VB2_2.jpg" alt="控件介绍"></p>
<h3 id="2-2-1-文本框-TextBox"><a href="#2-2-1-文本框-TextBox" class="headerlink" title="2.2.1 文本框(TextBox)"></a>2.2.1 文本框(TextBox)</h3><p>文本框是是用来接收用户输入的控件，以及作为显示器输出。它可以处理字符串（纯文字）和数字数据，但不能处理图象或图片。一个文本框中的文字可以用 Val 函数来转换为数字和数据</p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_Click()

‘把文本框1和文本框2的值加起来

Sum = Val(Text1.Text) + Val(Text2.Text)

‘中标签上显示答案

Label1.Caption = Sum

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-2-标签-Label"><a href="#2-2-2-标签-Label" class="headerlink" title="2.2.2 标签(Label)"></a>2.2.2 标签(Label)</h3><ul>
<li>标签是一个非常有用处的控件，因为它不仅是用来提供指示和指导，它也可以被用来显示输出。它的一个最重要的特性是标题</li>
<li>利用语法 Label.Caption ，它可以显示文字和数字数据。你可以在属性窗口或在运行时改变它的标题</li>
</ul>
<h3 id="2-2-3-命令按钮-CommandButton"><a href="#2-2-3-命令按钮-CommandButton" class="headerlink" title="2.2.3 命令按钮(CommandButton)"></a>2.2.3 命令按钮(CommandButton)</h3><p>命令按钮是一个很重要的控件，因为它被户点击它时可以执行命令去运作一个程序</p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_Click ()

Statements

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-4-图片框-PictureBox"><a href="#2-2-4-图片框-PictureBox" class="headerlink" title="2.2.4 图片框(PictureBox)"></a>2.2.4 图片框(PictureBox)</h3><p>图片框可用来处理图形。你可以下载一个图片，在设计阶段就在属性窗口从选定的文件夹选择图片。您也可以在程序运行时加载图片，其指令是 LoadPicture</p>
<pre class="line-numbers language-vb"><code class="language-vb">Picture1.Picture=LoadPicture ("C:\VB program\Images\grape.gif")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="2-2-5-图像方框-Image"><a href="#2-2-5-图像方框-Image" class="headerlink" title="2.2.5 图像方框(Image)"></a>2.2.5 图像方框(Image)</h3><p>图像方框 是另一个处理图象和照片的控件。它和图片框的功能几乎是相同的。不过，其中有一个重大的区别，它可以调整大小,它也可以用 LoadPicture 方法来加载图片</p>
<h3 id="2-2-6-列表框-ListBox"><a href="#2-2-6-列表框-ListBox" class="headerlink" title="2.2.6 列表框(ListBox)"></a>2.2.6 列表框(ListBox)</h3><p>列表框的功能是陈列一个项目清单以便用户可以通过点击来选择项目。如果要增加项目，我们可以利用 additem 方法</p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Load ( )

List1.AddItem “第一课”

List1.AddItem “第二课”

List1.AddItem “第三课”

List1.AddItem “第四课”

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-7-组合框-ComboBox"><a href="#2-2-7-组合框-ComboBox" class="headerlink" title="2.2.7 组合框(ComboBox)"></a>2.2.7 组合框(ComboBox)</h3><p>组合框展现一个下拉式项目清单。用户可以通过点击来选择项目，从名单上。为了增添项目名单，我们可以利用 AddItem `这方法</p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Load ( )

Combo1.AddItem “Item1”

Combo1.AddItem “Item2”

Combo1.AddItem “Item3”

Combo1.AddItem “Item4”

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-8-复选框-CheckBox"><a href="#2-2-8-复选框-CheckBox" class="headerlink" title="2.2.8 复选框(CheckBox)"></a>2.2.8 复选框(CheckBox)</h3><ul>
<li>复选框让用户可以选择或取消选择一个选项。当复选框被选中时，其值是设定为 1。如不被选中，其值设定为 0_</li>
<li>你可以用程序来设定复选框的属性，如键入 check1.value = 1 ，就表示它被选中，check1.value = 0 就表示它不被选中，并用它来执行某些动作</li>
</ul>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Check1_Click ()

If Check1.Value = 0 Then

Form1.BackColor = vbRed

ElseIf Check1.Value = 1 Then

Form1.BackColor = vbBlue

End If

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-9-选项框-OptionButton"><a href="#2-2-9-选项框-OptionButton" class="headerlink" title="2.2.9 选项框(OptionButton)"></a>2.2.9 选项框(OptionButton)</h3><p>选项框也可以让用户自由选择一个项目。但是，在同一时间中只有一个选项框可被选择。当一个选项框被选定时，其价值被设定为”True”时，反之则其价值被设定为”False</p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Option1_Click ( )

Shape1.Shape = 0

End Sub

Private Sub Option2_Click()

Shape1.Shape = 1

End Sub

Private Sub Option3_Click()

Shape1.Shape = 2

End Sub

Private Sub Option4_Click()

Shape1.Shape = 3

End Sub

Private Sub Option5_Click()

Shape1.Shape = 4

End Sub

Private Sub Option6_Click()

Shape1.Shape = 5

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-10-驱动器列表框-DriveListBox"><a href="#2-2-10-驱动器列表框-DriveListBox" class="headerlink" title="2.2.10 驱动器列表框(DriveListBox)"></a>2.2.10 驱动器列表框(DriveListBox)</h3><p>驱动器列表框，是用来显示在您的计算机上所有的驱动器。当你把这个控件纳入表格然后去运行程序，你将能够选择不同的驱动器</p>
<h3 id="2-2-11-目录列表框-DirListBox"><a href="#2-2-11-目录列表框-DirListBox" class="headerlink" title="2.2.11 目录列表框(DirListBox)"></a>2.2.11 目录列表框(DirListBox)</h3><p>目录列表框是用来显示清单目录或文件夹中选择一个驱动器。当你把这个控件纳入表格然后去运行程序，你将能够从所选驱动器中选择不同的目录</p>
<h3 id="2-2-12-文件列表框-FileListBox"><a href="#2-2-12-文件列表框-FileListBox" class="headerlink" title="2.2.12 文件列表框(FileListBox)"></a>2.2.12 文件列表框(FileListBox)</h3><p>文件列表框是用来显示文件列表在选定的目录或文件夹。当你把这个控件纳入表格然后去运行程序，你将能够从文件的列表中选择一个目录</p>
<h1 id="3-编写-VB-的程序代码"><a href="#3-编写-VB-的程序代码" class="headerlink" title="3. 编写 VB 的程序代码"></a>3. 编写 VB 的程序代码</h1><pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_Click
  程序代码
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><em>Sub 实际上是整个程序的一部分, 也称为子程序</em><br>用来设定一个对象的属性或传递价值于它的语法是：<code>object.property</code> <em>对象和属性是以一个点来分开</em><br>举例</p>
<ul>
<li>form1.show 的意思是显示表 1</li>
<li>label1.visible =true 的意思是把 label1 设置为可被显示</li>
<li>Text1.text = “ VB6” ，目的就是要把 VB6 显示于 text1 的文本框中</li>
<li>Text2.text = 100 ，是把 100 的数目显示于 text2 文本框中</li>
<li>Timer1.enabled =false，是要禁用 Timer1 计时器</li>
</ul>
<p><strong>几个例子</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_click

Label1.Visible=false

Label2.Visible=True

Text1.Text=”你是正确的!”

End sub
----
Private Sub Command1_click

Label1.Caption=” 欢迎”

Image1.visible=true

End sub
----
Private Sub Command1_click

Pictuire1.Show=true

Timer1.Enabled=True

Lable1.Caption=”开始计数“

End sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>两个重要的 VB 函数：VAL 和 STR</strong><br><em>VAL 的作用把键入文本框的文字转换成数值， 而 STR 刚好相反，它是把数值转换成字串</em></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Activate()

  Text3.text=text1.text+text2.text

End Sub
# 输入 12 ， 3
# 得到 123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form_Activate()

  Text3.text=val(text1.text)+val(text2.text)

End Sub
# 输入 12 ，3
# 得到 15<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="4-VB-数据处理"><a href="#4-VB-数据处理" class="headerlink" title="4. VB 数据处理"></a>4. VB 数据处理</h1><h2 id="4-1-VB-基本数据"><a href="#4-1-VB-基本数据" class="headerlink" title="4.1 VB 基本数据"></a>4.1 VB 基本数据</h2><h3 id="4-1-1-数字数据"><a href="#4-1-1-数字数据" class="headerlink" title="4.1.1 数字数据"></a>4.1.1 数字数据</h3><p>数字数据是由数目构成的数据，可以进行数字运算，如加，减，乘，除等</p>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">取值范围</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Byte</td>
<td align="center">0 至 255</td>
</tr>
<tr>
<td align="center">Integer</td>
<td align="center">-32,768 至 32,767</td>
</tr>
<tr>
<td align="center">Long</td>
<td align="center">-2,147,483,648 至 2,147,483,648</td>
</tr>
<tr>
<td align="center">Single</td>
<td align="center">-3.402823E+38 至 -1.401298E-45 负 &amp;&amp;&amp;&amp; 1.401298E-45 至 3.402823E+38 正数.</td>
</tr>
<tr>
<td align="center">Double</td>
<td align="center">-1.79769313486232e+308 至 -4.94065645841247E-324 负数 &amp;&amp;&amp;&amp; 4.94065645841247E-324 至 1.79769313486232e+308 正数.</td>
</tr>
<tr>
<td align="center">Currency</td>
<td align="center">-922,337,203,685,477.5808 至 922,337,203,685,477.5807</td>
</tr>
<tr>
<td align="center">Decimal</td>
<td align="center">+/- 79,228,162,514,264,337,593,543,950,335 如果没有小数点 &amp;&amp;&amp;&amp; +/- 7.9228162514264337593543950335 (28 个小数点）.</td>
</tr>
</tbody></table>
<h3 id="4-1-2-非数据类型"><a href="#4-1-2-非数据类型" class="headerlink" title="4.1.2 非数据类型"></a>4.1.2 非数据类型</h3><table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">范围</th>
</tr>
</thead>
<tbody><tr>
<td align="center">String(fixed length)</td>
<td align="center">1 to 65,400 字符</td>
</tr>
<tr>
<td align="center">String(variable length)</td>
<td align="center">0 to 20 亿 字符</td>
</tr>
<tr>
<td align="center">Date</td>
<td align="center">公元 100 年正月一日至 9999 年十二月三十一日</td>
</tr>
<tr>
<td align="center">Boolean</td>
<td align="center">True 或 False（对或错）</td>
</tr>
<tr>
<td align="center">Object</td>
<td align="center">任何嵌入对象</td>
</tr>
<tr>
<td align="center">Variant(numeric)</td>
<td align="center">任何价值大如 Double</td>
</tr>
<tr>
<td align="center">Variant(text)</td>
<td align="center">与 variable-length string 相同</td>
</tr>
</tbody></table>
<h3 id="4-1-3-后缀文的符号"><a href="#4-1-3-后缀文的符号" class="headerlink" title="4.1.3 后缀文的符号"></a>4.1.3 后缀文的符号</h3><p>后缀文是让你把数字转让给一个数据. 在某些情况下，我们需要在一个字的后面增加一个后缀文，使 VB 可以计算得更准确</p>
<table>
<thead>
<tr>
<th align="center">后缀</th>
<th align="center">数据类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center">&amp;</td>
<td align="center">Long</td>
</tr>
<tr>
<td align="center">!</td>
<td align="center">Single</td>
</tr>
<tr>
<td align="center">#</td>
<td align="center">Double</td>
</tr>
<tr>
<td align="center">@</td>
<td align="center">Currency</td>
</tr>
</tbody></table>
<p>此外，我们需要把字符串文字用开关引号 “ “ 围起来，日期和时间则用#标志围起来。字符串可以包含任何字符，包括数字</p>
<pre class="line-numbers language-vb"><code class="language-vb">memberName="Turban, John."
TelNumber="1800-900-888-777"
LastDay=#31-Dec-00#
ExpTime=#12:00 am#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="4-2-变数的管理-变量"><a href="#4-2-变数的管理-变量" class="headerlink" title="4.2 变数的管理(变量)"></a>4.2 变数的管理(变量)</h2><h3 id="4-2-1-变数名称"><a href="#4-2-1-变数名称" class="headerlink" title="4.2.1 变数名称"></a>4.2.1 变数名称</h3><p><strong>为变数命名时的规则</strong></p>
<ul>
<li>它必须小于 255 个字符</li>
<li>不得有间隔</li>
<li>不能以号码来开始</li>
<li>不能用点</li>
</ul>
<h3 id="4-2-2-变数的宣示"><a href="#4-2-2-变数的宣示" class="headerlink" title="4.2.2 变数的宣示"></a>4.2.2 变数的宣示</h3><p><code>Dim variableName as DataType</code></p>
<pre class="line-numbers language-vb"><code class="language-vb">Dim password As String
Dim yourName As String
Dim firstnum As Integer
Dim secondnum As Integer
Dim total As Integer
Dim doDate As Date

# or

Dim password As String,  yourName As String, firstnum As Integer,.............<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>假如我们没有特别指明数据类型， VB 将自动宣告变数的类型<br>要宣示字符串，有两种可能的方式，一为可变长度的字符串，另一个为固定长度字符串。为可变长度的字符串，只是用同样的格式<br>对于固定长度字符串，你必须使用如下的格式:Dim VariableName as String _ n<br>如：<code>Dim yourName as String _ 10</code></p>
<h2 id="4-3-VB-的常数和变数"><a href="#4-3-VB-的常数和变数" class="headerlink" title="4.3 VB 的常数和变数"></a>4.3 VB 的常数和变数</h2><h3 id="4-3-1-常数"><a href="#4-3-1-常数" class="headerlink" title="4.3.1 常数"></a>4.3.1 常数</h3><p>常数代表固定不变的数据，它可能是数字或文字。在使用常数时，我们必须预先宣示它们<br>宣示常数的格式是：<code>Const constantname As datatype=initializer</code><br>constantname 是我们自己制定的名称，datatype 是资料类型而 initializer 则是初始设定值</p>
<p>如下例子</p>
<pre class="line-numbers language-vb"><code class="language-vb">Const  Num  As Integer = 9.8

Const Pi As Single  = 3.142

Const SchoolName As String  = "中华中学“<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-3-2-变数"><a href="#4-3-2-变数" class="headerlink" title="4.3.2 变数"></a>4.3.2 变数</h3><p>变数是在程序运送时会改变的数据，而常数在运算时是固定不变的。虽然我们在开始时可给于变数一个数值（初始值），但在程序运作时它的数值是可以改变的<br>变数的宣告格式如下：<code>Dim VariableName as Datatype[=initializer]</code></p>
<p>如下例字</p>
<pre class="line-numbers language-vb"><code class="language-vb">Dim Num As Single=1.234

Dim Num1,Num2  As Integer

Dim yourName As String

Dim starName As String="刘翔”<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以 Dim 宣告各种变数 之后, 我们可以用以下的格式 赋值于这些变数 Variable=Expression</p>
<p>变数可以是一个已宣布的变数或控件的属性值. 它也可以是一个数学表达式, 一个字符串, 一个 布尔值 (对或错) 等等</p>
<h3 id="4-3-3-VB-运算符"><a href="#4-3-3-VB-运算符" class="headerlink" title="4.3.3 VB 运算符"></a>4.3.3 VB 运算符</h3><table>
<thead>
<tr>
<th align="center">运算符</th>
<th align="center">数学函数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">^</td>
<td align="center">指数</td>
</tr>
<tr>
<td align="center">*</td>
<td align="center">乘法</td>
</tr>
<tr>
<td align="center">/</td>
<td align="center">除法</td>
</tr>
<tr>
<td align="center">Mod</td>
<td align="center">整除后的余数</td>
</tr>
<tr>
<td align="center">\</td>
<td align="center">整数除法 19\4=4</td>
</tr>
<tr>
<td align="center">+or&amp;</td>
<td align="center">字串串连”v”&amp;”b”=”vb”</td>
</tr>
</tbody></table>
<p><strong>几个例子</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Dim firstName As String

Dim secondName As String

Dim yourName As String

Private Sub Command1_Click()

firstName = Text1.Text

secondName = Text2.Text

yourName = secondName + "  " + firstName

Label1.Caption = yourName

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">Dim number1, number2, number3 as Integer

Dim total, average as variant

Private sub Form_Click

number1=val(Text1.Text)
number2=val(Text2.Text)
number3= val(Text3.Text)

Total=number1+number2+number3

Average=Total/5

Label1.Caption=Total

Label2.Caption=Average

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<hr>
<h1 id="5-正式学习"><a href="#5-正式学习" class="headerlink" title="5. 正式学习"></a>5. <strong>正式学习</strong></h1><h2 id="5-1-基础知识（零碎）"><a href="#5-1-基础知识（零碎）" class="headerlink" title="5.1 基础知识（零碎）"></a>5.1 基础知识（零碎）</h2><p>对象：数据和数据操作方式的综合体，如窗体、控件</p>
<p>对象三要素：属性、事件、方法</p>
<ul>
<li><p>属性：<br><code>对象.属性= 属性值</code></p>
</li>
<li><p>事件：</p>
</li>
</ul>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub 对象名_事件过程名[参数列表]
' click load ----
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>方法：</li>
</ul>
<pre><code>对象.方法[参数名表]
Form1.Print "avb"
Text1.SetFocus</code></pre><p>暂停程序 Stop<br>结束程序 End</p>
<p>命令按钮改变背景必须变两个属性-bg 和 style<br>其他的只需改变 bg 就行了</p>
<h3 id="If-判断结构"><a href="#If-判断结构" class="headerlink" title="If 判断结构"></a>If 判断结构</h3><pre class="line-numbers language-vb"><code class="language-vb">if 表达式 then
  语句1
else
  语句2
end if<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>example：密码输入，限制输入 3 次</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Dim i As Integer ' 定义一个整型变量
Private Sub Command2_Click()
    If Text1 = "buct" Then
        Text2.Visible = True
        Label2.Visible = True
        Command1.Visible = True
        Text1.Visible = False
        Label1.Visible = False
        Command2.Visible = False
        Label3.Visible = False
        Text2.SetFocus
    Else
       ' Text1 = ""
       ' Label3.Visible = True
       ' Label3 = "密码错误，请重新输入"
       ' Text1.SetFocus
        i = i +1
        If i >= 3 Then End
        Text1 = ""
        Text1.SetFocus
        MsgBox "密码输入错误，请重新输入" ' 弹出一个框
    End If
End Sub

Private Sub Form_Load()
    Text2.Visible = False
    Label2.Visible = False
    Command1.Visible = False
    Label3.Visible = False
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="5-2-VB-的语言成分"><a href="#5-2-VB-的语言成分" class="headerlink" title="5.2 VB 的语言成分"></a>5.2 VB 的语言成分</h2><p>编码规则：</p>
<ul>
<li>不区分字母大小写</li>
<li>语句书写自由:同一行可以写多条语句用<code>:</code>分开、一条语句多行写用<code>_</code>连接</li>
<li>代码注释： <code>'</code>或者<code>Rem</code>引导注释内容、快注释-视窗-工具栏-编辑-快注释</li>
<li>VB 的命名约定：字母或汉字开头，长度不超过 255 个字符，控件不超过 40 个字符<ul>
<li>不用 VB 关键字:<code>if loop</code></li>
<li>不能包含空格，小数点，其他声明字符<code>$ % &amp;</code></li>
</ul>
</li>
</ul>
<h3 id="5-2-1-基本数据类型"><a href="#5-2-1-基本数据类型" class="headerlink" title="5.2.1 基本数据类型"></a>5.2.1 基本数据类型</h3><p><img src="/img/VB/sjlx.png" alt="VB数据类型"></p>
<h3 id="5-2-2-直接常量"><a href="#5-2-2-直接常量" class="headerlink" title="5.2.2 直接常量"></a>5.2.2 直接常量</h3><p><img src="/img/VB/zjcl.png" alt="VB直接常量"></p>
<h3 id="5-2-3-变量"><a href="#5-2-3-变量" class="headerlink" title="5.2.3 变量"></a>5.2.3 变量</h3><ol>
<li>变量隐式声明：使用的变量未作声明，所有变量均为 Variant 类型</li>
<li>变量显式声明：</li>
</ol>
<ul>
<li>使用类型标示符直接声明变量 <code>MyName$ ="David"</code>–字符串型</li>
<li>使用 Dim 语句<ul>
<li>格式 1：Dim 变量名 As 数据类型[,变量名 As 数据类型，…..0]</li>
<li>格式 2：Dim 变量名 + 类型标识符</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-vb"><code class="language-vb">Dim A As Integer, B As Double
Dim A%,B#
Dim MyName1 As String , Myname2 As String*5 '字符串只能是五个字符
Dim Vp1, Vp2 As Single<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>变量的强制声明：在每个模块开始处自动加一条”Option Explicit”语句，所有变量需要指定数据类型</li>
</ol>
<p>工具菜单- 选项命令 - 选中编辑器中的要求变量声明</p>
<h3 id="5-2-4-模块"><a href="#5-2-4-模块" class="headerlink" title="5.2.4 模块"></a>5.2.4 模块</h3><p>VB 代码存储在模块中<br>三种模块：窗体模块、标准模块、类模块<br><img src="/img/VB/mk.png" alt="VB模块"></p>
<h3 id="5-2-5-变量的作用域"><a href="#5-2-5-变量的作用域" class="headerlink" title="5.2.5 变量的作用域"></a>5.2.5 变量的作用域</h3><ul>
<li>全局变量：在窗体或标准模块中声明 Public<ul>
<li><code>Public 变量名 As 数据类型</code></li>
</ul>
</li>
<li>模块级变量：在模块的声明部分使用 Dim 或 Private 声明<ul>
<li><code>Dim 变量名 As 数据类型</code></li>
</ul>
</li>
<li>局部变量：在过程中由 Dim 或 Static 关键字声明<ul>
<li><code>Static 变量名 As 数据类型</code></li>
</ul>
</li>
</ul>
<p>变量的作用域<br><img src="/img/VB/zyy.png" alt="变量的作用域及使用规则"></p>
<ul>
<li>内部常量：控件常量、语言常量、对象常量、用户界面常量</li>
<li>用户定义常量：用 Const 语句和赋值</li>
</ul>
<pre class="line-numbers language-vb"><code class="language-vb">Const PI As Double = 3.14159265...
Private Const Msg As String = "hello world"
Public Const Msg As String = "天安门"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>静态变量：每次调用一个过程时保留上次的调用值</li>
</ul>
<p><code>Static 变量名 As 数据类型,变量名 As 数据类型....</code></p>
<h3 id="5-2-6-变量类型检查"><a href="#5-2-6-变量类型检查" class="headerlink" title="5.2.6 变量类型检查"></a>5.2.6 变量类型检查</h3><p><img src="/img/VB/bllxjc.png" alt="变量的类型检查"></p>
<p><img src="/img/VB/sjlxflpd.png" alt="数据类型分类判断"></p>
<h3 id="5-2-7-运算符"><a href="#5-2-7-运算符" class="headerlink" title="5.2.7 运算符"></a>5.2.7 运算符</h3><p><img src="/img/VB/ysf.png" alt="运算符"></p>
<h3 id="5-2-8-常用内部函数"><a href="#5-2-8-常用内部函数" class="headerlink" title="5.2.8 常用内部函数"></a>5.2.8 常用内部函数</h3><p><img src="/img/VB/cyhs.png" alt="常用内部函数、数学函数"><br><img src="/img/VB/cyzhhs.png" alt="常用转换函数"><br><img src="/img/VB/zfchs.png" alt="字符串函数"></p>
<p><img src="/img/VB/sszfclz.png" alt="字符串函数例子"></p>
<h3 id="5-2-9-日期函数"><a href="#5-2-9-日期函数" class="headerlink" title="5.2.9 日期函数"></a>5.2.9 日期函数</h3><pre class="line-numbers language-vb"><code class="language-vb">'Time Date Now DateDiff DateAdd
Private Sub Command1_Click()
    Dim d1 As Date, d2 As Date
    Print Now, Date, Time
    Print Time, Hour(Time), Minute(Time), Second(Time)
    Print Date, Year(Date), Month(Date), Day(Date)
    Print "=---------------------="
    Print DateDiff("d", Now, #10/1/2009#); #10/1/2009# - Date
    Print Date + Time; "***"; DateAdd("h", 5, Now); "***";
    Print DateAdd("s", 5, Time), vbCrLf
    d1 = "2004-07-16 05:00:00"
    d2 = "2004-08-20 23:00:00"
    Print #8/20/2004# - #7/16/2004#, d2 - d1, (d2 - d1) * 24
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/VB/rqlz.png" alt="日期函数例子"></p>
<p><strong>格式输出函数</strong><br><code>Format$(表达式[,格式字符串])</code></p>
<blockquote>
<p>关于日期的格式详情，参考<a href="https://blog.csdn.net/bigheadsheep/article/details/12013267" target="_blank" rel="noopener">Format 函数</a>这篇文章</p>
</blockquote>
<p><strong>Shell 函数</strong><br><img src="/img/VB/shellhs.png" alt="shell函数"></p>
<h3 id="5-2-10-基本语句"><a href="#5-2-10-基本语句" class="headerlink" title="5.2.10 基本语句"></a>5.2.10 基本语句</h3><h4 id="5-2-10-1-赋值语句"><a href="#5-2-10-1-赋值语句" class="headerlink" title="5.2.10.1 赋值语句"></a>5.2.10.1 赋值语句</h4><pre class="line-numbers language-vb"><code class="language-vb">Let 变量名 = 表达式  '普通变量
Set 变量名 = 表达式  ' 对象型变量

Let A = 5
Set Obj1 = Command1

Text1.text = "ok"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-2-10-2-快速输入输出函数"><a href="#5-2-10-2-快速输入输出函数" class="headerlink" title="5.2.10.2 快速输入输出函数"></a>5.2.10.2 快速输入输出函数</h4><p><img src="/img/VB/kssrschs.png" alt="InputBox函数"></p>
<p><img src="/img/VB/msgbox.png" alt="MsgBox函数"></p>
<p><img src="/img/VB/msgboxlz.png" alt="MsgBox例子"></p>
<h2 id="5-3-控制结构与算法"><a href="#5-3-控制结构与算法" class="headerlink" title="5.3 控制结构与算法"></a>5.3 控制结构与算法</h2><h3 id="5-3-1-顺序结构"><a href="#5-3-1-顺序结构" class="headerlink" title="5.3.1 顺序结构"></a>5.3.1 顺序结构</h3><p>语句 1→→→ 语句 2→→→ 语句 3</p>
<h3 id="5-3-2-选择结构"><a href="#5-3-2-选择结构" class="headerlink" title="5.3.2 选择结构"></a>5.3.2 选择结构</h3><h4 id="5-3-2-1-if"><a href="#5-3-2-1-if" class="headerlink" title="5.3.2.1 if"></a>5.3.2.1 if</h4><p><strong>1</strong><code>if 表达式 then 语句</code></p>
<pre class="line-numbers language-vb"><code class="language-vb">2
if 表达式 then
    语句块
end if

3
if 表达式 then
    语句块1
else
    语句块2
end if

4
if 表达式 then
    语句块
else : 语句
end if

5
if 表达式 then 语句1 else 语句2

6
if 表达式1 then
    语句块1
elseif 表达式2 then
    语句块2
else
    语句块
end if<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>例子：</strong><br><img src="/img/VB/cfex.png" alt="摄氏度与华氏度提示"></p>
<h4 id="5-3-2-2-select"><a href="#5-3-2-2-select" class="headerlink" title="5.3.2.2 select"></a>5.3.2.2 select</h4><pre class="line-numbers language-vb"><code class="language-vb">select case 变量或表达式
    case 表达式列表1    'is 关系运算表达式
        语句块1
    case 表达式列表2
        语句块2
    case else
        语句块
end select<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>例子：</strong></p>
<p><img src="/img/VB/yex.png" alt="求函数Y的值"></p>
<h3 id="5-3-3-循环结构"><a href="#5-3-3-循环结构" class="headerlink" title="5.3.3 循环结构"></a>5.3.3 循环结构</h3><pre class="line-numbers language-vb"><code class="language-vb">for 循环变量=初值 to 终值 [step步长]
    语句块
    [exit for]
    语句块
next 循环变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">for each 元素变量 in 数组或集合
    语句块
next 元素变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">先判断后执行
do while 条件
    语句块
loop

do until 条件
    语句块
loop

先执行后判断
do
    语句块
loop while 条件

do
    语句块
loop until 条件


exit do 退出循环体<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-3-3-1-for-next-循环"><a href="#5-3-3-1-for-next-循环" class="headerlink" title="5.3.3.1 for next 循环"></a>5.3.3.1 for next 循环</h4><ul>
<li>循环变量是数之变量</li>
<li>初值、终值、步长可以是数之表达式</li>
<li>步长可正可负，但不能为 0 、为 1 是省略</li>
<li>exit for 退出循环，经常放到条件语句中</li>
<li>next 后的循环变量应与 for 语句中的循环变量一致，可以省略</li>
</ul>
<pre class="line-numbers language-vb"><code class="language-vb">for 循环变量=初值 to 终值 [step步长]
    语句块
    [exit for]
    语句块
next 循环变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">'--求1+2+3+4+...+n--
private sub command1_click()
    dim n as integer , i as integer , s as integer
    n = val(text1.text)
    s = 0
    for i = 1 to n
        s = s + i
    next i
    label3.caption = s
end sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>for each ... in ... next 循环</code></p>
<p>For Each…In…Next 循环结构中元素变量是 变体型变量</p>
<pre class="line-numbers language-vb"><code class="language-vb">for each 元素变量 in 数组或集合
    语句块
next 元素变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/VB/foreach.png" alt="控件颜色"></p>
<h4 id="5-3-3-2-do…loop-循环结构"><a href="#5-3-3-2-do…loop-循环结构" class="headerlink" title="5.3.3.2 do…loop 循环结构"></a>5.3.3.2 do…loop 循环结构</h4><pre class="line-numbers language-vb"><code class="language-vb">do while 条件
    语句组1
    exit do
    语句组2
loop

细节------------------
先判断后执行---当
do while 条件
    语句块
loop

do until 条件
    语句块
loop

先执行后判断---直到
do
    语句块
loop while 条件

do
    语句块
loop until 条件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>while true 则循环<br>until false 则循环</p>
<pre class="line-numbers language-vb"><code class="language-vb">' 1^2+2^2+....小于n的最大值
private sub command1_click()
    dim n as long , s as long, i as integer
    n = val(text1.text)
    i = 0
    s = 0
    do while s < n
        i = i + 1
        s = s + i * i
    loop
    text2.text = s - i * i
end sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-3-3-3-循环嵌套"><a href="#5-3-3-3-循环嵌套" class="headerlink" title="5.3.3.3 循环嵌套"></a>5.3.3.3 循环嵌套</h4><pre class="line-numbers language-vb"><code class="language-vb">'----------eg:
for i = 1 to 3
    for j = 5 to 7
        print i , j
    next j
next i

or
next j,i<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-3-4-goto-语句"><a href="#5-3-4-goto-语句" class="headerlink" title="5.3.4 goto 语句"></a>5.3.4 goto 语句</h3><p><code>goto{标号|行号}</code></p>
<p><img src="/img/VB/gotoex.png" alt="goto例子"></p>
<h2 id="5-4-数组"><a href="#5-4-数组" class="headerlink" title="5.4 数组"></a>5.4 数组</h2><h3 id="5-4-1-数组"><a href="#5-4-1-数组" class="headerlink" title="5.4.1 数组"></a>5.4.1 数组</h3><p><img src="/img/VB/szgn.png" alt="数组概念"></p>
<p>如：<code>A(8)</code>,<code>B(I)</code>,<code>A(A(5))</code><br><code>a(1,3)</code>-二维数组</p>
<h3 id="5-4-2-数组定义"><a href="#5-4-2-数组定义" class="headerlink" title="5.4.2 数组定义"></a>5.4.2 数组定义</h3><p><code>Public|Private|Dim 数组名 维数定义 AS 类型</code><br><code>Dim A(-4 TO 10) As Integer</code><br><code>Dim A(0 TO 8,0 to 3) As Integer</code> = <code>Dim a(8,3) as integer</code></p>
<h4 id="5-4-2-1-定义形式"><a href="#5-4-2-1-定义形式" class="headerlink" title="5.4.2.1 定义形式"></a>5.4.2.1 定义形式</h4><p><code>dim 数组名 ([下界 to]上界) as 数据类型</code><br>下界默认为 0，也可以在 <code>option base n</code> 来修改默认下界</p>
<h4 id="5-4-2-2-动态数组的建立与使用"><a href="#5-4-2-2-动态数组的建立与使用" class="headerlink" title="5.4.2.2 动态数组的建立与使用"></a>5.4.2.2 动态数组的建立与使用</h4><p><code>dim 数组名() [as 数据类型]</code>先不给大小<br><code>redim 数组名 (8,8,)</code>具体使用时在给出大小<br><code>redim preserve 数组名(8,newvalue)</code>改变数组大小，可用 preserve 保留原来的数据</p>
<h4 id="5-4-2-3-控件数组"><a href="#5-4-2-3-控件数组" class="headerlink" title="5.4.2.3 控件数组"></a>5.4.2.3 控件数组</h4><p>在窗体上画出控件，进行属性设置</p>
<ul>
<li>复制粘贴，建立控件数组</li>
<li>编程时哟个 load 方法</li>
</ul>
<p><img src="/img/VB/dtszdsy.png" alt="动态数组的使用"></p>
<p><img src="/img/VB/fxsc.png" alt="输入10个单词，反序输出"><br><img src="/img/VB/fxsc1.png" alt="输出10个单词，反序输出2"><br><img src="/img/VB/fxsc2.png" alt="输出10个单词，反序输出3"></p>
<pre class="line-numbers language-vb"><code class="language-vb">array 数组输入
数组下界到数组上界
ubound(A) to lbound(A)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="5-4-2-4-数组元素的复制"><a href="#5-4-2-4-数组元素的复制" class="headerlink" title="5.4.2.4 数组元素的复制"></a>5.4.2.4 数组元素的复制</h4><pre class="line-numbers language-vb"><code class="language-vb">option base 1
    dim a(15),b(3,5)
    for i = 1 to 3
        for j = 1 to 5
        b(i,j) = a((i-1) * 5 +j)
        next j
    next i<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-4-2-5-for-each-…-next"><a href="#5-4-2-5-for-each-…-next" class="headerlink" title="5.4.2.5 for each … next"></a>5.4.2.5 for each … next</h4><pre class="line-numbers language-vb"><code class="language-vb">打印一堆数组x中所有元素
dim x(15)
for each a in x
    print a;
next a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">求二维数组y的所有元素之和
dim y(10,10)
for each a in y
    sum = sum + a
next a
print sum<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/VB/blsznr.png" alt="保留动态数组的内容"></p>
<h3 id="5-4-3-数组应用举例"><a href="#5-4-3-数组应用举例" class="headerlink" title="5.4.3 数组应用举例"></a>5.4.3 数组应用举例</h3><h4 id="5-4-3-1-例子-1"><a href="#5-4-3-1-例子-1" class="headerlink" title="5.4.3.1 例子 1"></a>5.4.3.1 例子 1</h4><p>例:生成 20 个 10 到 100 之间的随机整数,存于一维整型数组 A 中,同时显示于第一个文本框中,单击窗体将这 20 个数以相反的次序显示于另一个文本框中<br><img src="/img/VB/szlz.png" alt="数组应用"></p>
<h4 id="5-4-3-2-例子-2"><a href="#5-4-3-2-例子-2" class="headerlink" title="5.4.3.2 例子 2"></a>5.4.3.2 例子 2</h4><p><img src="/img/VB/szlz1.png" alt="控件数组"></p>
<h2 id="5-5-过程"><a href="#5-5-过程" class="headerlink" title="5.5 过程"></a>5.5 过程</h2><ul>
<li>过程的引入:使同类的操作不重复(操作方法相同、参数不同)</li>
<li>过程:完成一段独立功能,可供其他过程使用(调用)。过程又称为子程序</li>
<li>调用过程:调用其他过程的过程</li>
</ul>
<p>过程：</p>
<ul>
<li>sub 子过程</li>
<li>function 函数过程</li>
<li>property 属性过程</li>
<li>event 事件过程</li>
</ul>
<h3 id="5-5-1-子过程和函数过程"><a href="#5-5-1-子过程和函数过程" class="headerlink" title="5.5.1 子过程和函数过程"></a>5.5.1 子过程和函数过程</h3><p><img src="/img/VB/zgchsgc.png" alt="子过程和函数过程"></p>
<p>调用：</p>
<ul>
<li><p>子过程名[参数列表]</p>
</li>
<li><p>Call 子过程名 (参数列表)</p>
</li>
<li><p>变量名 = 函数过程名([参数列表])</p>
</li>
<li><p>public 所有模块的所有其他过程</p>
</li>
<li><p>private 只有本模块的其他过程</p>
</li>
<li><p>static 过程中所有的局部变量都为静态变量</p>
</li>
<li><p>函数过程名：function 过程的名称</p>
</li>
<li><p>形参表：调用时要传递给 function 的参数变量列表</p>
</li>
</ul>
<p><img src="/img/VB/gclz.png" alt="过程例子"></p>
<pre class="line-numbers language-vb"><code class="language-vb">定义求阶乘的函数Fact
Function Fact(n As Integer) As Double
    Dim F As Double, i As Integer
    F=1
    For i=1 To n
        F=F * i
    Next i
    Fact =F
End function

Private Sub Command1_Click()
    Dim m As Integer, n As Integer, c As Double
    m= Val(TextI.Text)
    n= Val(Text2.Text)
    c=Fact(m)/(Fact(n)*(Fact(m-n)))'调用Fact
    Text3.Text= Trim(Str(c))
End sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>◆Sub 过程的建立方法与 Function 过程的建立方法相同。</li>
<li>◆&lt;过程名&gt;不具有值的意义,在 Sub 过程中不能给&lt;过程名&gt;赋<br>值,也不能给&lt;过程名&gt;定义类型。</li>
<li>◆Sub 过程通过&lt;形参表&gt;中的参数返回值。</li>
</ul>
<p><img src="/img/VB/subgclz.png" alt="sub过程"></p>
<h3 id="5-5-2-参数的传递"><a href="#5-5-2-参数的传递" class="headerlink" title="5.5.2 参数的传递"></a>5.5.2 参数的传递</h3><p><img src="/img/VB/cscd.png" alt="参数传递"></p>
<h3 id="5-5-3-代码模块"><a href="#5-5-3-代码模块" class="headerlink" title="5.5.3 代码模块"></a>5.5.3 代码模块</h3><p><img src="/img/VB/dmmk.png" alt="代码模块"></p>
<h4 id="5-5-3-1-窗体模块"><a href="#5-5-3-1-窗体模块" class="headerlink" title="5.5.3.1 窗体模块"></a>5.5.3.1 窗体模块</h4><p>事件过程、通用过程、通用声明</p>
<h4 id="5-5-3-2-标准模块"><a href="#5-5-3-2-标准模块" class="headerlink" title="5.5.3.2 标准模块"></a>5.5.3.2 标准模块</h4><p><img src="/img/VB/bzmk.png" alt="标准模块"></p>
<h4 id="5-5-3-3-类模块"><a href="#5-5-3-3-类模块" class="headerlink" title="5.5.3.3 类模块"></a>5.5.3.3 类模块</h4><p>在类模块中编写代码建立新对象</p>
<h3 id="5-5-4-过程的作用域"><a href="#5-5-4-过程的作用域" class="headerlink" title="5.5.4 过程的作用域"></a>5.5.4 过程的作用域</h3><p><img src="/img/VB/gczyy.png" alt="过程作用域"></p>
<p><img src="/img/VB/gczyylz.png" alt="过程作用域例子"><br><img src="/img/VB/gczyylz1.png" alt="过程作用域例子"></p>
<p><img src="/img/VB/gczyysygz.png" alt="过程作用域及使用规则"></p>
<h2 id="5-6-用户界面设计"><a href="#5-6-用户界面设计" class="headerlink" title="5.6 用户界面设计"></a>5.6 用户界面设计</h2><h3 id="5-6-1-单选按钮和复选框"><a href="#5-6-1-单选按钮和复选框" class="headerlink" title="5.6.1 单选按钮和复选框"></a>5.6.1 单选按钮和复选框</h3><p>单选框只能选一个（Option）<br>复选框可以选多个（Check）<br><code>click动作</code><br><code>check.value = true</code> 则为被选中</p>
<p><img src="/img/VB/checklz.png" alt="例子"></p>
<h3 id="5-6-2-框架-Frame"><a href="#5-6-2-框架-Frame" class="headerlink" title="5.6.2 框架 Frame"></a>5.6.2 框架 Frame</h3><p>框架之间可以隔开单选按钮<br><code>fontname</code> <code>fontsize</code> <code>forecolor</code><br>属性</p>
<h3 id="5-6-3-滚动条"><a href="#5-6-3-滚动条" class="headerlink" title="5.6.3 滚动条"></a>5.6.3 滚动条</h3><p>HScroll Bar 、 VScroll Bar<br>水平、竖直滚动条</p>
<ul>
<li>属性<br>MIN 默认 0<br>MAX 默认 32767</li>
</ul>
<p>Value ：设置滚动块在滚动条中的位置值<br>Smallchange ：最小变动值属性<br>Largechange ：最大——</p>
<ul>
<li>事件<br>Scroll ：当鼠标拖动滚动块时，触发<br>Change ： 当改变 value 值时出发</li>
</ul>
<p>eg：在 text 中显示最大最小值</p>
<pre class="line-numbers language-vb"><code class="language-vb">text1 = HScroll1.Min
text2 = HScroll2.Max
text3 = HScroll3.Value

HScroll ' 横向
VScroll ' 纵向<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>RGB 函数：<br>颜色值的取间是 0~255</p>
<p>随机数 Rnd() 返回小于 1 大于或等于 0 的值<br>Rnd[()]</p>
<pre class="line-numbers language-vb"><code class="language-vb">private sub form_click()
    text1.forecolor = RGB(255 * Rnd , 255 * Rnd , 255 * Rnd)
    form1.backcolor = RGB(255 * Rnd , 255 * Rnd , 255 * Rnd)
end sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>返回小于 1 但大于或等于 0 的值。 Number 的值决定了 Rnd 生成随机数的方式。<br>在调用 Rnd 之前,先使用无参数的 Randomize 语句初始化随机函数生成器,该<br>生成器具有根据系统计时器得到的种子。<br>如果 number 的值是 Randomize 生成。<br>小于 0,每次都使用 number 作为随机数种子得到相同结果<br>大于 0,以上一个随机数为种子产生下一个随机数;<br>等于 0,产生与最近生成的随机数相同的随机数。<br>省略,以上一个随机数为种子产生下一个随机数<br>例,Int((上限下限+1)*Rnd+下限),生成上限与下限之间的随机整数。</p>
<h3 id="5-6-4-列表框"><a href="#5-6-4-列表框" class="headerlink" title="5.6.4 列表框"></a>5.6.4 列表框</h3><p>只能在程序中设置的属性：<br>Listindex 执行时选中的列表项的序号<br>Listcount 项目数量 从 0 开始<br>Selected True 表示选中相应的项<br>Text 表示选中列表项文本内容</p>
<p>Additem ： 增加项<br>Removeitem ： 删除项<br>Clear ： 清除</p>
<p>属性 style : 1 时为多选框<br>属性 columns: 几列</p>
<pre class="line-numbers language-vb"><code class="language-vb">List1.AddItem "1"
List1.AddItem "2"
province = Array("a","b") ' 一维数组

Province(List1.ListIndex) '数组中数据
List1.List(List.ListIndex) = text1

' 判断是否选中
if list1.selected(i) Then<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-6-5-组合框"><a href="#5-6-5-组合框" class="headerlink" title="5.6.5 组合框"></a>5.6.5 组合框</h3><p>style 属性：<br>0 下拉式<br>1 简单组合框<br>2 下拉式列表框</p>
<h3 id="5-6-6-驱动器列表框、目录列表框、文件列表框"><a href="#5-6-6-驱动器列表框、目录列表框、文件列表框" class="headerlink" title="5.6.6 驱动器列表框、目录列表框、文件列表框"></a>5.6.6 驱动器列表框、目录列表框、文件列表框</h3><p>DriveListBox<br>DirectoryListBox<br>FileListBox</p>
<pre class="line-numbers language-vb"><code class="language-vb">select case index
    case 0
        语句1
    case 1
        语句2
end select

' 打开程序
Retval = shell(dir1.path + "\" + file1.filename,1)
Retval = shell("C:\user\..",1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-6-7-通用对话框"><a href="#5-6-7-通用对话框" class="headerlink" title="5.6.7 通用对话框"></a>5.6.7 通用对话框</h3><p>打开、另存为、颜色、字体、打印机、帮助<br>工程–部件–Microsoft Comm Dialog Control 6.0 选择通用对话框</p>
<p><code>对象.Action = 1</code> 打开文件对话框<br><code>对象.ShowOpen</code> 打开文件对话框</p>
<p><img src="/img/VB/tongyong.png" alt="通用对话框例子"></p>
<h3 id="5-6-8-菜单设计"><a href="#5-6-8-菜单设计" class="headerlink" title="5.6.8 菜单设计"></a>5.6.8 菜单设计</h3><p>普通的菜单设计<br>工具–菜单编辑器–逐一填写</p>
<p>弹出菜单<br>对象.PopupMenu 菜单名，标值，x，y<br><code>PopupMenu Cal2,2</code></p>
<h3 id="5-6-9-多重窗体"><a href="#5-6-9-多重窗体" class="headerlink" title="5.6.9 多重窗体"></a>5.6.9 多重窗体</h3><p>工程–添加窗体–打开<br>load 窗体名称 将窗体装入内存，但不显示<br>unload 窗体名称</p>
<p>窗体名称.show 显示窗体<br>窗体名称.hide 隐藏窗体<br><code>form2.show</code>显示 form1 窗体</p>
<h3 id="5-6-10-鼠标-键盘事件"><a href="#5-6-10-鼠标-键盘事件" class="headerlink" title="5.6.10 鼠标/键盘事件"></a>5.6.10 鼠标/键盘事件</h3><p><img src="/img/VB/sbsj.png" alt="鼠标事件"></p>
<p>键盘事件：KeyPress ， KeyUp ， KeyDown</p>
<h3 id="5-6-11-对象拖放与-OLE-拖放"><a href="#5-6-11-对象拖放与-OLE-拖放" class="headerlink" title="5.6.11 对象拖放与 OLE 拖放"></a>5.6.11 对象拖放与 OLE 拖放</h3><p>对象拖放：用鼠标将对象从一个地方拖动到另一个地方</p>
<p>拖放方式属性：DragMode 为 1 自动 0 手动<br>拖放图标属性可以在设计时设置，也可在程序中设置<br><code>控件名.DragIcon = 图像控件.picture</code><br><code>控件名.DragIcon = LoadPicture("C:\Icons\mail.ico")</code></p>
<p>拖放事件</p>
<pre class="line-numbers language-vb"><code class="language-vb">sub form_dragdrop(source as control , x as single , y as single)
    source.move x,y
end sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>OLE 拖放 ：将数据从一个控件或应用程序中移动到另一个控件或应用程序。<br><strong>OLEDragMode</strong>属性—决定是自动还是手动实现“拖”操作<br><strong>OLEDropMode</strong>属性—决定是自动还是手动实现“放”操作<br>注:并不是所有的控件都有此二属性,有的只有其一。</p>
<ul>
<li>OLEDragDrop 事件—在目标控件上进行“放”操作时发生的事件。</li>
<li>OLEStartDrag 事件一源控件 OLEDrag 方法被执行或用户做“拖”，操作时发生的事件</li>
<li>OLEDragOver 事件—在拖动时,经某控件时在该控件上发生的事件</li>
</ul>
<h2 id="5-7-Active-X-控件"><a href="#5-7-Active-X-控件" class="headerlink" title="5.7 Active X 控件"></a>5.7 Active X 控件</h2><h3 id="5-7-1-SSTab-选项卡控件"><a href="#5-7-1-SSTab-选项卡控件" class="headerlink" title="5.7.1 SSTab 选项卡控件"></a>5.7.1 SSTab 选项卡控件</h3><p>工程–部件–选中 Microsoft Tabbed Dialog Control 6.0</p>
<p>style 属性：选项卡样式–0/1：office 风格/windows 风格<br>Tabs 属性：控制控件上选项卡的数目<br>Tab 属性 ：决定控件上当前被选定的项</p>
<h3 id="5-7-2-ProgressBar-进度条控件"><a href="#5-7-2-ProgressBar-进度条控件" class="headerlink" title="5.7.2 ProgressBar 进度条控件"></a>5.7.2 ProgressBar 进度条控件</h3><p>工程–部件–选中 Microsoft Windows Common Control 6.0</p>
<p>Max 属性：进度条上限<br>Min 属性：进度条下限<br>Value ：进度值<br>Scrolling ： 卷动方向形式<br>Orientation ： 纵横滚动定位<br>MousePoint ：鼠标指针</p>
<h3 id="5-7-3-Slide-滑动条控件"><a href="#5-7-3-Slide-滑动条控件" class="headerlink" title="5.7.3 Slide 滑动条控件"></a>5.7.3 Slide 滑动条控件</h3><p>工程–部件–选中 Microsoft Windows Common Control 6.0</p>
<p>TickStyle ： 决定控件上滑块及刻度的显示样式<br>TickFrequency ： 决定控件上刻度点的疏密<br>ToolTipText：指针停在该控件上时显示提示信息<br>Orientation ：决定控件在窗体上水平或垂直放置</p>
<h3 id="5-7-4-MS-Chart-控件"><a href="#5-7-4-MS-Chart-控件" class="headerlink" title="5.7.4 MS Chart 控件"></a>5.7.4 MS Chart 控件</h3><p>工程–部件–选中 Microsoft Chart Control 6.0(OLEDB)</p>
<p>BorderStyle ： 决定图表是否有外框线<br>ColumnCount ： 每一格的列数<br>RowCount ： 每一行的列数<br>ChartType ： 选择图表类型<br>TitleText ： 图题<br>ChartData 返回一个数组，该数组包含将要被该图表显示的值</p>
<p><code>MSChart1.ChartData = 数组</code></p>
<p><img src="/img/VB/tubiao.png" alt="图表控件"></p>
<h3 id="5-7-5-UpDown-控件"><a href="#5-7-5-UpDown-控件" class="headerlink" title="5.7.5 UpDown 控件"></a>5.7.5 UpDown 控件</h3><p>工程–部件–选中 Microsoft Windows Common Control-2 6.0</p>
<p>一对箭头按钮控件，单击按钮，增减数值<br>UpDown 通常与 Textbox 绑定</p>
<p>Max/Min 最大值最小值<br>Increment 指定每次单击上箭头或下箭头时 Value 的变化量</p>
<pre class="line-numbers language-vb"><code class="language-vb">private sub updown1_downclick()
    text1.updown1.value
end sub
private sub updow n1_upclick()
    text1.updown1.value
end sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-7-6-ActiveX-控件的创建"><a href="#5-7-6-ActiveX-控件的创建" class="headerlink" title="5.7.6 ActiveX 控件的创建"></a>5.7.6 ActiveX 控件的创建</h3><p>ActiveX 是 Microsoft 对于一系列策略性面向对象程序技术和工具称呼,其中主要的技术是组件对象模型(COM)。</p>
<p><img src="/img/VB/activex.png" alt="ActiveX的三种表现形式"></p>
<p>ActiveX 部件：可执行代码：exe、dll、ocx 文件</p>
<p>ActiveX 控件标准和非标准文件：以 ocx 后缀保存在 Windows\System 目录下<br>ActiveX 控件分为：控件和插入对象 、可插入对象就是一个应用程序，如 MIcrosoft Word</p>
<p>创造自己的 ActiveX 控件</p>
<ul>
<li>启动 VB，打开 ActiveX 控件</li>
<li>UserControl 对象，为 AX 控件名称，在此进行控件制作</li>
<li>在代码窗口利用工具中的添加过程，为新的 ActiveX 控件添加共有的属性、时间等</li>
<li>界面与代码设计好后，在指定目录生成指定的 ocx，完成自制 AX 控件的工作</li>
<li>另打开 VB，通过增加部件找到所自制的 AX 控件，放在工具箱上即可使用</li>
</ul>
<h2 id="5-8-文件"><a href="#5-8-文件" class="headerlink" title="5.8 文件"></a>5.8 文件</h2><p><img src="/img/VB/file.png" alt="基本概念"></p>
<h3 id="5-8-1-顺序文件"><a href="#5-8-1-顺序文件" class="headerlink" title="5.8.1 顺序文件"></a>5.8.1 顺序文件</h3><p>ASCII 文件，由任何字处理文件建立，在 VB 中建立，只能按顺序存取记录</p>
<p>打开文件–读或写文件–关闭文件</p>
<h4 id="5-8-1-1-顺序文件打开"><a href="#5-8-1-1-顺序文件打开" class="headerlink" title="5.8.1.1 顺序文件打开"></a>5.8.1.1 顺序文件打开</h4><p>格式 Open &lt;文件名&gt; for 方式 as [#]&lt;文件号&gt;</p>
<p>Input 只读 / Output 写 / Append 添加方式</p>
<p>文件号 1 到 511 之间的整数</p>
<p><code>opnn "C:\Data\Stud.dat" For Output As #1</code></p>
<h4 id="5-8-1-2-顺序文件关闭"><a href="#5-8-1-2-顺序文件关闭" class="headerlink" title="5.8.1.2 顺序文件关闭"></a>5.8.1.2 顺序文件关闭</h4><p>Close 文件号列表</p>
<p><code>Close #1</code><br><code>Close #1,2,#8</code><br><code>Close</code> 关闭所有</p>
<h4 id="5-8-1-3-顺序文件的读写"><a href="#5-8-1-3-顺序文件的读写" class="headerlink" title="5.8.1.3 顺序文件的读写"></a>5.8.1.3 顺序文件的读写</h4><p><strong>① 写</strong></p>
<ol>
<li>Write #文件号,[输出列表]</li>
</ol>
<p><code>Write #1,A1,A2,A3</code></p>
<p>说明</p>
<ul>
<li>&lt;输出列表&gt;中各项之间要用逗号分开</li>
<li>&lt;输出列表&gt;每一项可以是常量、变量或表达式</li>
<li>写到文件中的各数据间自动插入逗号,字符串自动加上双引号</li>
<li>所有数据写完后,在最后加入一个回车换行符</li>
<li>不含&lt;输出列表&gt;时,将在文件中写入一空行</li>
</ul>
<p><strong>学号、姓名、成绩 1、2</strong>保存到文件中</p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim no, na, g1, g2 As Variant
Private Sub Command1_Click()
    no = Text1.Text: na = Text2.Text
    g1 = Val(Text3.Text): g2 = Val(Text4.Text)
    Write #2, no, na, g1, g2
    Text1.Text = "": Text2.Text = "": Text3.Text = "": Text4.Text = ""
End Sub

Private Sub Command2_Click()
    Close #2
    End
End Sub

Private Sub Form_Load()
    CommonDialog1.ShowSave
    Open CommonDialog1.FileName For Append As #2
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>print #文件号，输出列表</li>
</ol>
<p><code>print #2, no ,na, g1, g2</code><br><code>print #2, no; na; g1; g2</code></p>
<p>将输出列表中的内容写入指定文件<br>说明</p>
<ul>
<li>当&lt;输出列表&gt;用逗号分隔时,采用分区格式输出</li>
<li>当&lt;输出列表&gt;用分号分隔时,采用紧凑格式输出</li>
<li>所有项将在一行内输出,输出后将自动换行</li>
<li>可以使用 Spc()函数和 Tab()函数</li>
</ul>
<p><img src="/img/VB/writeprint.png" alt="两者区别"></p>
<p><strong>② 读</strong></p>
<ol>
<li>input #文件号,变量列表</li>
<li>Line input #文件号，变量名</li>
<li>eof(文件号) 函数</li>
</ol>
<p><strong>读取文件中的程序，计算平均成绩</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim num, nam, s1, s2, ave

Private Sub Command1_Click()
    CommonDialog1.ShowOpen
    Open CommonDialog1.FileName For Input As #3
    Text1.Text = ""
    Do While Not EOF(3)
   ' 装入用Wite# 语句生成的文件
        Input #3, num, nam, s1, s2
        ave = (s1 + s2) / 2
        Text1.Text = Text1.Text & num & "   " & nam _
                        & "   " & Str(s1) & "    " & Str(s2) & _
                        "  " & Str(ave) & Chr(13) & Chr(10)
    Loop
    Close #3
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>计算每个同学的平均成绩，并同时将结果与原数据保存到另一个文件</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim num(100) As String, nam(100) As String
Dim g(100, 2) As Integer, n As Integer, ave, sum1, sum2, i

Private Sub Command1_Click()
    CommonDialog1.ShowOpen
    Open CommonDialog1.FileName For Input As #3
        n = 0
        Do While Not EOF(3)
            n = n + 1
            Input #3, num(n), nam(n), g(n, 1), g(n, 2)
        Text1.Text = Text1.Text & "   " & num(n) & _
        "   " & nam(n) & "    " & Str(g(n, 1)) & _
        "   " & Str(g(n, 2)) & "    " & Chr(13) & Chr(10)
        Loop
End Sub

Private Sub Command2_Click()
    CommonDialog1.ShowSave
    Open CommonDialog1.FileName For Output As #4
    sum1 = 0
    sum2 = 0
    Text2.Text = ""
    For i = 1 To n
        ave = (g(i, 1) + g(i, 2)) / 2
        Write #4, num(i), nam(i), g(i, 1), g(i, 2), ave
        Text2.Text = Text2.Text & "   " & num(i) & _
        "   " & nam(i) & "   " & Str(g(i, 1)) & "   " & _
        Str(g(i, 2)) & "   " & Str(ave) & vbCrLf
        sum1 = sum1 + g(i, 1): sum2 = sum2 + g(i, 2)
    Next i
    Text2.Text = Text2.Text & "average" & " " & _
    Str(sum1 / n) & "   " & Str(sum2 / n)
    Write #4, "总平均", sum1 / n, sum2 / n
End Sub

Private Sub Command3_Click()
    Close #3, #4
    End
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-8-2-随机文件"><a href="#5-8-2-随机文件" class="headerlink" title="5.8.2 随机文件"></a>5.8.2 随机文件</h3><p>读写次序任意，记录长度相等，随机文件中的记录常定义为用户自定义类型</p>
<p><strong>自定义数据类型操作</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">private/public type 自定义类型名
    元素名 下标 as 类型
end type<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/VB/sjwjsm1.png" alt=""><br><img src="/img/VB/sjwjsm2.png" alt="说明"></p>
<p><img src="/img/VB/sjwjex.png" alt="例子"><br><img src="/img/VB/sjwjex1.png" alt="例子"></p>
<h4 id="5-8-2-1-随机文件打开"><a href="#5-8-2-1-随机文件打开" class="headerlink" title="5.8.2.1 随机文件打开"></a>5.8.2.1 随机文件打开</h4><p><code>open 文件名 [for random] as 文件号 len= 记录长度</code><br>for random 可以省略<br>记录长度：就是自定义类型的大小，可以用 len 获得<br>若文件不存在，则建立新的文件</p>
<h4 id="5-8-2-2-随机文件关闭"><a href="#5-8-2-2-随机文件关闭" class="headerlink" title="5.8.2.2 随机文件关闭"></a>5.8.2.2 随机文件关闭</h4><p><code>close #2</code></p>
<h4 id="5-8-2-3-随机文件写"><a href="#5-8-2-3-随机文件写" class="headerlink" title="5.8.2.3 随机文件写"></a>5.8.2.3 随机文件写</h4><p><code>put 文件号，记录号，变量名</code></p>
<p><img src="/img/VB/sjwjxie.png" alt="写文件"></p>
<h4 id="5-8-2-4-随机文件读"><a href="#5-8-2-4-随机文件读" class="headerlink" title="5.8.2.4 随机文件读"></a>5.8.2.4 随机文件读</h4><p><code>get #文件号， 记录号， 变量名</code><br>功能： 将一个一打开的随机文件读入一个变量之中</p>
<p><img src="/img/VB/sjwjdxex0.png" alt="例子"></p>
<p><img src="/img/VB/sjwjdxex.png" alt="例子"><br><img src="/img/VB/sjwjdxex1.png" alt="例子"></p>
<h3 id="5-8-3-总结"><a href="#5-8-3-总结" class="headerlink" title="5.8.3 总结"></a>5.8.3 总结</h3><p><img src="/img/VB/filezongjie.png" alt="文件操作总结"></p>
<p>开闭 写读</p>
<ul>
<li>open 语句</li>
<li>close 语句</li>
<li>write\print 语句</li>
<li>input\line input 语句 ， input 函数</li>
</ul>
<hr>
<ul>
<li>open 语句</li>
<li>close 语句</li>
<li>put 语句</li>
<li>get 语句</li>
</ul>
<h2 id="5-9-绘图"><a href="#5-9-绘图" class="headerlink" title="5.9 绘图"></a>5.9 绘图</h2><h3 id="5-9-1-图形设计基础"><a href="#5-9-1-图形设计基础" class="headerlink" title="5.9.1 图形设计基础"></a>5.9.1 图形设计基础</h3><h4 id="5-9-1-1-坐标系统"><a href="#5-9-1-1-坐标系统" class="headerlink" title="5.9.1.1 坐标系统"></a>5.9.1.1 坐标系统</h4><p>左上角（0，0）横向 x，纵向 y</p>
<ol>
<li>刻度单位</li>
</ol>
<p><img src="/img/VB/kddw.png" alt="刻度单位"></p>
<ol start="2">
<li>改变坐标系</li>
</ol>
<p><strong>自定义坐标体系</strong></p>
<p><img src="/img/VB/zdyzbx.png" alt="自定义坐标体系"></p>
<p><code>ScaleLeft</code> <code>ScaleTop</code>属性 ， 窗体左边的坐标，上边的坐标</p>
<p><code>ScaleWidth</code> <code>ScaleHeight</code>属性 ，容器对象内部的宽度和高度，将</p>
<p><img src="/img/VB/zbxex1.png" alt="例子"></p>
<p><img src="/img/VB/zbxex2.png" alt="例子"></p>
<p><img src="/img/VB/zbxex3.png" alt="例子"></p>
<p>Scale 方法：<br><code>对象名.Scale[(x1,y1)-(x2,y2)]</code></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub picture1_click()
    dim a(5,5) as integer, i as integer , j as integer
    picture1.scale (0,0)-(6,6)
    for i=1 to 5
        picture1.currenty = i
        for j=1 to 5
            if i = j then a(i,j) = 1 else a(i,j) = 0
            picture1.currentx = j
            picture1.print a(i,j);
    next j,i
end sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/VB/scale.png" alt="例子"></p>
<ol start="3">
<li>当前坐标</li>
</ol>
<p><code>currentx</code> <code>currenty</code></p>
<ol start="4">
<li>位置大小相关属性</li>
</ol>
<p><img src="/img/VB/wzdxxg.png" alt="例子"></p>
<h4 id="5-9-1-2-颜色"><a href="#5-9-1-2-颜色" class="headerlink" title="5.9.1.2 颜色"></a>5.9.1.2 颜色</h4><p>颜色值：四字节，长整型<br>RGB    每个字节取值：00-FF （或0-255）</p>
<ol>
<li>设计阶段设置</li>
<li>运行阶段设置</li>
</ol>
<p>RGB函数：<code>RGB(red,green,blue)</code><br>eg:<code>form1.backcolor = RGB(255,0,0)</code></p>
<p>或者</p>
<p>QBColor函数： <code>QbColor(value)</code><br>value ： 0-7颜色加亮、 8-15<br>0黑1蓝2绿3青4红5紫红6黄7浅灰色</p>
<p>或者</p>
<p>使用颜色常量<br><code>vbblack</code> <code>vbred</code> <code>vbgreen</code> <code>vbyellow</code> <code>vbwhite</code><br><code>vbblue</code>  <code>vbmagenta洋红</code> <code>vbcyan青色</code> </p>
<p>或者</p>
<p>使用颜色的十六进制 <code>&amp;H00BBGGRR&amp;</code></p>
<p>使用系统颜色 <code>vbscrollbars &amp;H80000000</code>滚动条颜色</p>
<h3 id="5-9-2-图形控件"><a href="#5-9-2-图形控件" class="headerlink" title="5.9.2 图形控件"></a>5.9.2 图形控件</h3><h4 id="5-9-2-1-Picture控件"><a href="#5-9-2-1-Picture控件" class="headerlink" title="5.9.2.1 Picture控件"></a>5.9.2.1 Picture控件</h4><p>可以显示图片，可以作为其他控件的容器</p>
<ul>
<li>设计阶段</li>
<li>程序运行中：<code>LoadPicture()</code></li>
</ul>
<p><code>Autosize</code>为True时 自动调整大小与显示的图片匹配</p>
<h4 id="5-9-2-2-Image控件"><a href="#5-9-2-2-Image控件" class="headerlink" title="5.9.2.2 Image控件"></a>5.9.2.2 Image控件</h4><p>可以显示图像，内存占用小<br>Stretch属性 拉伸位图和图标，适应图像框的大小</p>
<h4 id="5-9-2-3-Shape控件"><a href="#5-9-2-3-Shape控件" class="headerlink" title="5.9.2.3 Shape控件"></a>5.9.2.3 Shape控件</h4><p>属性：Shape、FillStyle、BackColor、FillColor等属性</p>
<p>方法：<code>object.Move left[,top[,width[,height]]]</code></p>
<p><img src="/img/VB/shapeex.png" alt="例子"></p>
<h4 id="5-9-2-4-Line控件"><a href="#5-9-2-4-Line控件" class="headerlink" title="5.9.2.4 Line控件"></a>5.9.2.4 Line控件</h4><p>设计时再窗体上绘制直线</p>
<p><code>BorderStyle</code> 、 <code>BorderWidth</code></p>
<h3 id="5-9-3-绘图方法"><a href="#5-9-3-绘图方法" class="headerlink" title="5.9.3 绘图方法"></a>5.9.3 绘图方法</h3><p><img src="/img/VB/htff.png" alt="绘图方法"></p>
<h4 id="5-9-3-1-画点方法Pset"><a href="#5-9-3-1-画点方法Pset" class="headerlink" title="5.9.3.1 画点方法Pset"></a>5.9.3.1 画点方法Pset</h4><p><code>对象名.Pset[step](x,y)[,颜色]</code><br>在对象指定位置，用给定的颜色画点</p>
<ul>
<li>Step 可选，指定相对于又currentx和y 属性提供的坐标</li>
<li>x，y 点的水平和垂直坐标</li>
<li>颜色 绘制该店的RGB颜色</li>
</ul>
<p><img src="/img/VB/psetex.png" alt="例子1"></p>
<p><img src="/img/VB/psetex1.png" alt="例子2"><br><img src="/img/VB/psetex2.png" alt="例子2"></p>
<h4 id="5-9-3-2-画线、画矩形Line"><a href="#5-9-3-2-画线、画矩形Line" class="headerlink" title="5.9.3.2 画线、画矩形Line"></a>5.9.3.2 画线、画矩形Line</h4><p><code>对象名.Line[step][(x1,y1)]-[step]\(x2,y2)[,color[,B[F]]]</code></p>
<p><img src="/img/VB/line.png" alt="Line"></p>
<p><img src="/img/VB/lineex1.png" alt="例子1"></p>
<p><img src="/img/VB/lineex2.png" alt="例子2"></p>
<p><img src="/img/VB/lineex3.png" alt="例子3"><br><img src="/img/VB/lineex4.png" alt="例子3"></p>
<h4 id="5-9-3-3-画圆-Circle"><a href="#5-9-3-3-画圆-Circle" class="headerlink" title="5.9.3.3 画圆 Circle"></a>5.9.3.3 画圆 Circle</h4><p><img src="/img/VB/circle.png" alt="画圆"></p>
<p><img src="/img/VB/circleex.png" alt="画圆例子"></p>
<p><img src="/img/VB/circleex1.png" alt="画圆例子1"><br><img src="/img/VB/circleex2.png" alt="画圆例子1"></p>
<h4 id="5-9-3-4-使用point方法返回指定点的颜色"><a href="#5-9-3-4-使用point方法返回指定点的颜色" class="headerlink" title="5.9.3.4 使用point方法返回指定点的颜色"></a>5.9.3.4 使用point方法返回指定点的颜色</h4><p><img src="/img/VB/pointex.png" alt="Point例子"></p>
<h2 id="5-10-高级界面设计"><a href="#5-10-高级界面设计" class="headerlink" title="5.10 高级界面设计"></a>5.10 高级界面设计</h2><h3 id="5-10-1-多文档界面MDI"><a href="#5-10-1-多文档界面MDI" class="headerlink" title="5.10.1 多文档界面MDI"></a>5.10.1 多文档界面MDI</h3><p><img src="/img/VB/mdi.png" alt="MDI"></p>
<h2 id="5-11-开发多媒体应用程序"><a href="#5-11-开发多媒体应用程序" class="headerlink" title="5.11 开发多媒体应用程序"></a>5.11 开发多媒体应用程序</h2><p>概述：MMControl控件<br><strong>播放动作的5个步骤</strong></p>
<ul>
<li>选择播放设备 DeviceType</li>
<li>选择播放文件名 FileName</li>
<li>打开文件 Open</li>
<li>播放文件 Play</li>
<li>关闭 Close</li>
</ul>
<p><img src="/img/VB/mci.png" alt="MCI控件"></p>
<p><strong>MM控件的主要属性和事件</strong></p>
<p><img src="/img/VB/mmcontrol.png" alt="MMControl"></p>
<p><img src="/img/VB/mmccommand.png" alt="MMCommand"></p>
<p><img src="/img/VB/mmcothers.png" alt="其他属性"></p>
<p><img src="/img/VB/mmcmake.png" alt="制作播放器1"></p>
<p><img src="/img/VB/mmcmake2.png" alt="制作播放器2"></p>
<p><img src="/img/VB/api.png" alt="使用API多媒体函数实现播放"></p>
<p><img src="/img/VB/apiuse.png" alt="使用API多媒体函数实现播放"></p>
<p><img src="/img/VB/apiuse2.png" alt="使用API多媒体函数实现播放"></p>
<p><img src="/img/VB/apiuse3.png" alt="使用API多媒体函数实现播放"></p>
<p><em>直接搜API浏览器，打开文件，然后选择需要的函数，拷贝</em></p>
<p><strong>拷贝内容</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Declare Function sndPlaySound Lib "winmm.dll" Alias "sndPlaySoundA" (ByVal lpszSoundName As String, ByVal uFlags As Long) As Long
Private Const SND_ASYNC = &H1         '  play asynchronously
Private Const SND_LOOP = &H8         '  loop the sound until next sndPlaySound
Private Const SND_SYNC = &H0         '  play synchronously (default)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/img/VB/apiex.png" alt="使用API多媒体函数实现播放例子"></p>
<p><img src="/img/VB/apiex1.png" alt="使用API多媒体函数实现播放例子"></p>
<p><img src="/img/VB/apiex2.png" alt="使用API多媒体函数实现播放例子"></p>
<h2 id="5-12-数据库访问技术"><a href="#5-12-数据库访问技术" class="headerlink" title="5.12 数据库访问技术"></a>5.12 数据库访问技术</h2><p><img src="/img/VB/sjk.png" alt="数据库概念"></p>
<p><strong>数据库管理系统</strong><br>有：Access Interbase SQLServer DB2 MySql 等等</p>
<h3 id="5-12-1-关系型数据库"><a href="#5-12-1-关系型数据库" class="headerlink" title="5.12.1 关系型数据库"></a>5.12.1 关系型数据库</h3><p>表、记录与字段、关键字、表间关系、外部键、索引</p>
<p><img src="/img/VB/gxxsjk.png" alt="关系型数据库概念"></p>
<p><img src="/img/VB/gxxsjk1.png" alt="关系型数据库字段、记录、关键字"></p>
<p><img src="/img/VB/gxxsjk2.png" alt="关系型数据库表间关系"></p>
<p><img src="/img/VB/gxxsjk3.png" alt="关系型数据库外部键、索引"></p>
<h3 id="5-12-2-用可视化数据管理器建立和维护数据库"><a href="#5-12-2-用可视化数据管理器建立和维护数据库" class="headerlink" title="5.12.2 用可视化数据管理器建立和维护数据库"></a>5.12.2 用可视化数据管理器建立和维护数据库</h3><p><img src="/img/VB/kshsjglq.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq1.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq2.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq3.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq4.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq5.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq6.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq7.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq8.png" alt="可视化数据管理器"></p>
<p><img src="/img/VB/kshsjglq9.png" alt="可视化数据管理器"></p>
<h2 id="5-13-总复习"><a href="#5-13-总复习" class="headerlink" title="5.13 总复习"></a>5.13 总复习</h2><h3 id="5-13-1-同心圆"><a href="#5-13-1-同心圆" class="headerlink" title="5.13.1 同心圆"></a>5.13.1 同心圆</h3><p><img src="/img/VB/txy.png" alt="案例1"><br><img src="/img/VB/txy2.png" alt="案例1"></p>
<h3 id="5-13-2-两圆转动"><a href="#5-13-2-两圆转动" class="headerlink" title="5.13.2 两圆转动"></a>5.13.2 两圆转动</h3><p><img src="/img/VB/yzyd.png" alt="案例2"><br><img src="/img/VB/yzyd2.png" alt="案例2"></p>
<h3 id="5-13-3-密码输入，文本框飘动"><a href="#5-13-3-密码输入，文本框飘动" class="headerlink" title="5.13.3 密码输入，文本框飘动"></a>5.13.3 密码输入，文本框飘动</h3><p><img src="/img/VB/mimayd.png" alt="案例3"></p>
<h3 id="5-13-4-网络连接计时"><a href="#5-13-4-网络连接计时" class="headerlink" title="5.13.4 网络连接计时"></a>5.13.4 网络连接计时</h3><p><img src="/img/VB/wlljjs.png" alt="案例4"><br><img src="/img/VB/wlljjs2.png" alt="案例4"></p>
<h1 id="6-课程学习过程中练习"><a href="#6-课程学习过程中练习" class="headerlink" title="6. 课程学习过程中练习"></a>6. 课程学习过程中练习</h1><p>第几次课.第几道练习</p>
<h2 id="2-1-勾选要求变量声明（初学）"><a href="#2-1-勾选要求变量声明（初学）" class="headerlink" title="2.1 勾选要求变量声明（初学）"></a>2.1 勾选要求变量声明（初学）</h2><p>然后每次使用必须先定义变量</p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    Dim B As Integer, A As Integer
    B = 10
    A = A + B
    Print B, A
End Sub
'10 10
'10 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    Static B As Integer, A As Integer     '静态变量
    B = 10
    A = A + B
    Print B, A
End Sub
'10 10
'10 20
'10 30<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Dim 和 Static 都是局部变量可以将其拉到窗体级全局变量</p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
    Dim B As Integer, A As Integer
Private Sub Command1_Click()

    B = 10
    A = A + B
    Print B, A
End Sub

Private Sub Command2_Click()
    Print B, A
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-2-字符判断"><a href="#2-2-字符判断" class="headerlink" title="2.2 字符判断"></a>2.2 字符判断</h2><pre class="line-numbers language-vb"><code class="language-vb">Private Sub Text1_Change()
    If Not IsNumeric(Text1) Then
        MsgBox "Text1 输入非法数字，请重新输入"
        Text1.Text = ""
    End If
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-3-inputbox-amp-keypress"><a href="#2-3-inputbox-amp-keypress" class="headerlink" title="2.3 inputbox &amp; keypress"></a>2.3 inputbox &amp; keypress</h2><pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Label2_Click()
    Text3 = Val(Text1) + Val(Text2)
End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then Text2 = InputBox("请输入")
End Sub

Private Sub Text3_GotFocus()
    Text1 = ""
    Text2 = ""
    Text3 = ""
    Text1.SetFocus
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-1-DIY"><a href="#3-1-DIY" class="headerlink" title="3.1 DIY"></a>3.1 DIY</h2><p><strong>换行 text 的 multline 属性要为 true</strong><br><code>chr(13) + chr(10)</code><br><code>vbcrlf</code></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim ID As Boolean

Private Sub Command1_Click()
    ID = True
    Timer1.Interval = 600
    Text1 = "DIY" + Chr(13) + Chr(10) + "程序设计"  '回车换行
End Sub

Private Sub Command2_Click()
    ID = False
    Text1.Alignment = 0 '居左
    Text1.FontSize = 50
    Text1 = "1111" & vbCrLf _
    & "fads" + vbCrLf _
    & "7777" + Chr(13) + Chr(10)  '回车加换行
End Sub

Private Sub Timer1_Timer()
    Dim A As Integer
    Randomize
    A = Rnd * 4      'rnd 0-1
    Text1.ForeColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)
    If ID Then
        Text1.FontSize = Rnd * 260
        Text1.FontBold = True   '粗体字
        Select Case A
        Case 0
            Text1.FontName = "隶书"
            Text1.Alignment = 0
        Case 1
            Text1.FontName = "黑体"
            Text1.Alignment = 1
        Case 2
            Text1.FontName = "楷体"
            Text1.Alignment = 2
        End Select
    End If
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-2-for"><a href="#3-2-for" class="headerlink" title="3.2 for"></a>3.2 for</h2><p><code>cls</code>清屏</p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    Dim i As Integer, j As Integer
    For i = 1 To 3
        For j = 5 To 7
            Print i, j
        Next j
        Print "---------"
    Next i
End Sub

Private Sub Command2_Click()
    Dim a       '必须用变体
    For Each a In Form1.Controls
        a.BackColor = vbRed
    Next a
End Sub

Private Sub Command3_Click()
    Cls
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-3-for-与-if-可以互换"><a href="#3-3-for-与-if-可以互换" class="headerlink" title="3.3 for 与 if 可以互换"></a>3.3 for 与 if 可以互换</h2><p><code>goto 111</code></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    'Dim i As Integer, s As Integer
    Dim i, a, j, b
    For i = 0 To 100
        a = a + i
    Next i
111 If j <= 100 Then
        b = b + j
        j = j + 1
        GoTo 111
    E
    Print a
    Print b
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="4-1-求积"><a href="#4-1-求积" class="headerlink" title="4.1 求积"></a>4.1 求积</h2><p><img src="/img/VB/kclx4_1.png" alt="例子"></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Form DblClick
    Dim a (1 To 5) As integer, b (3 To 8)As Integer
    Dim i As Integer
    For i=1 to 5
        a(i) = i
        picture3.Print a(i)
    For i=3 to 8
        b(i) = i
        Picture4.Print b(i)
    Next i
    MsgBox"开始计算"
    Text1= tim(a())
    Text2= tim(b())
End sub
Function tim(x() As Integer)
    Dim t As double, i As Integer
    t=1
    For i= LBound (x) To UBound(x)
        t= t*x(i)
    Next i
    tim = t
End function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="4-2-控件数组–将五个-shape-从上到下移动"><a href="#4-2-控件数组–将五个-shape-从上到下移动" class="headerlink" title="4.2 控件数组–将五个 shape 从上到下移动"></a>4.2 控件数组–将五个 shape 从上到下移动</h2><p>设置好属性—复制，粘贴，名称一样的控件数组</p>
<p>shape1 重命名为 S1</p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
    Dim i As Integer

Private Sub Command1_Click()
    Timer1.Interval = 50
End Sub

Private Sub Timer1_Timer()
    For i = 0 To 4
        ' 改变颜色  ---不同颜色
        ' S1(i).BackColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)
        ' S1(i).BorderColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)
        If S1(i).Top + S1(i).Height > Form1.ScaleHeight Then
            S1(i).Top = 0
        Else
            S1(i).Top = S1(i).Top + 100
        End If
    Next i
End Sub

Option Explicit
    Dim i As Integer

Private Sub Command1_Click()
    Timer1.Interval = 50
End Sub

Private Sub Timer1_Timer()
    Dim A
    A = RGB(Rnd * 250, Rnd * 250, Rnd * 250)  ' 相同颜色
    For i = 0 To 4
        S1(i).BackColor = A
        S1(i).BorderColor = A
        ' S1(i).BackColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)
        ' S1(i).BorderColor = RGB(Rnd * 250, Rnd * 250, Rnd * 250)
        If S1(i).Top + S1(i).Height > Form1.ScaleHeight Then
            S1(i).Top = 0
        Else
            S1(i).Top = S1(i).Top + 100
        End If
    Next i
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="4-3-所有控件的移动"><a href="#4-3-所有控件的移动" class="headerlink" title="4.3 所有控件的移动"></a>4.3 所有控件的移动</h2><pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
    Dim i As Variant  ' 变体型变量

Private Sub Command1_Click()
    For Each i In Form1.Controls
        If i.Top + i.Height > Form1.ScaleHeight Then
            i.Top = 0
        Else
            i.Top = i.Top + 500
        End If
    Next i
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="4-4-模块、多窗口"><a href="#4-4-模块、多窗口" class="headerlink" title="4.4 模块、多窗口"></a>4.4 模块、多窗口</h2><p><code>form2.show</code>打开 form2<br>新建 module，然后将子过程放入 module，可以在 form1 中调用</p>
<pre class="line-numbers language-vb"><code class="language-vb">' module1:
Option Explicit

Sub fact(n As Integer, f As Long)
    Dim i As Integer
    f = 1
    For i = 1 To n
        f = f * i
    Next i
End Sub

' form1
Option Explicit

Private Sub Command1_Click()
    Dim s As Long
        Call fact(Val(Text1), s)
        Print Val(Text1); s
        Text1.SetFocus
        Text1 = ""
End Sub

Private Sub Command2_Click()
    Form2.Show
End Sub

' form2
Option Explicit

Private Sub Command1_Click()
    Dim s As Long
    Call fact(8, s)
    Print 8; s
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="7-学习作业"><a href="#7-学习作业" class="headerlink" title="7. 学习作业"></a>7. 学习作业</h1><h2 id="7-1-第一次作业"><a href="#7-1-第一次作业" class="headerlink" title="7.1 第一次作业"></a>7.1 第一次作业</h2><h3 id="1-倒计时控件"><a href="#1-倒计时控件" class="headerlink" title="1. 倒计时控件"></a>1. 倒计时控件</h3><p><img src="/img/VB/zy/zy1_1.png" alt="第一次作业"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_Click()
    Timer1.Interval = 50
End Sub

Private Sub Command2_Click()
    End
End Sub

Private Sub Timer1_Timer()
    Text2.Text = Format(Now(), "yyyy/MM/dd hh:mm:ss")
    Text3.Text = #10/1/2020# - Date & "天"
    Text1.Text = "2020-10-01"
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>剩下的随便改改 bg，caption，font 等等的</p>
<p>小知识点：</p>
<ul>
<li>Access Key: 再名称前加&amp;  <code>即&amp;s</code></li>
<li>关于日期的格式，参考<a href="https://blog.csdn.net/bigheadsheep/article/details/12013267" target="_blank" rel="noopener">Format 函数</a>这篇文章</li>
</ul>
<p>小问题：</p>
<ul>
<li>怎么把输入的日期格式化为计算数据,不会更高级的输入转化，只能先死输入</li>
</ul>
<p>解决：</p>
<ul>
<li>使用 CDate 函数将字符串转化为日期</li>
</ul>
<p>新的问题：</p>
<ul>
<li>在重新输到<code>2020-10-</code> 的时候会报错</li>
</ul>
<p>解决：</p>
<ul>
<li>添加一行代码</li>
</ul>
<p>完全版代码</p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_Click()
    Timer1.Interval = 50
End Sub

Private Sub Command2_Click()
    End
End Sub

Private Sub Text1_Click()
    Text1 = ""
End Sub

Private Sub Timer1_Timer()
    Text2.Text = Format(Now(), "yyyy/MM/dd hh:mm:ss")
    yy = Val(Left$(Text1.Text$, 4))   '  text1中的年
    mon = Val(Mid$(Text1.Text$, 6, 2)) '          月
    dday = Val(Right$(Text1.Text$, 2))  '         日

    If Text1.Text = "" Then
        Text3.Text = ""
    Else                      ' 加入判断 让到 - 的时候自动补全
        If Text1.Text = yy & "-" & mon & "-" Then
            t1 = Text1.Text & "01"
            Text3.Text = CDate(t1) - Date & "天"
        Else
            Text3.Text = CDate(Text1.Text) - Date & "天"
        End If
    End If
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-加法运算器"><a href="#2-加法运算器" class="headerlink" title="2. 加法运算器"></a>2. 加法运算器</h3><p><img src="/img/VB/zy/zy1_2.png" alt="第一次作业2"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Private Sub Command1_Click(Index As Integer)
    Text3.Text = Val(Text1.Text) + Val(Text2.Text)
End Sub

Private Sub Command2_Click(Index As Integer)
    Text1.Text = ""
    Text2.Text = ""
    Text3.Text = ""
    Text1.SetFocus
End Sub

Private Sub Command3_Click()
    End
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li><code>Text1.SetFocus</code>按下按钮后将鼠标指针重新指回<code>Text1</code>的位置，即使焦点回到加数 A 框</li>
<li>val 将字符型数据转换为数值型数据，str 将数值型转换为字符型</li>
</ul>
<h2 id="7-2-第二次作业"><a href="#7-2-第二次作业" class="headerlink" title="7.2 第二次作业"></a>7.2 第二次作业</h2><h3 id="1-华氏度与摄氏度的转换"><a href="#1-华氏度与摄氏度的转换" class="headerlink" title="1. 华氏度与摄氏度的转换"></a>1. 华氏度与摄氏度的转换</h3><p><img src="/img/VB/zy/zy2_1.png" alt="第二次作业1"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim C As Variant, F As Variant, CI As Double, FI As Double

Private Sub Form_Load()
    Label4.Enabled = False
    Timer1.Interval = 50
End Sub

Private Sub label3_click()
    C = Text1.Text
    If IsNumeric(C) Then
        CI = Val(C)
        FI = Round(9 / 5 * CI + 32, 1)
        Text2.Text = FI
    Else
        MsgBox "摄氏度不是数"
        Text1.Text = ""
    End If
End Sub

Private Sub Label4_Click()
    F = Text2.Text
    If IsNumeric(F) Then
        FI = Val(F)
        CI = Round(5 / 9 * (FI - 32), 1)
        Text1.Text = CI
    Else
        MsgBox "华氏度不是数"
        Text2.Text = ""
    End If
End Sub

Private Sub Text1_Click()
    Label3.Enabled = True: Label4.Enabled = False
    Text1.Text = "": Text2.Text = ""
End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then label3_click
End Sub

Private Sub Text2_Click()
    Label4.Enabled = True: Label3.Enabled = False
    Text1.Text = "": Text2.Text = ""
End Sub

Private Sub Text2_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then Label4_Click
End Sub

Private Sub Timer1_Timer()
    C = Text1.Text: F = Text2.Text
    If C <> "" Or F <> "" Then
        label3_click
        Label4_Click
    End If
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>VB 中的不等于<code>&lt;&gt;</code></li>
<li>enabled 可以让控件是否响应用户，如正向转换时，关闭逆向开关；逆向转换时，关闭正向开关</li>
</ul>
<h3 id="2-二次方程根的求解"><a href="#2-二次方程根的求解" class="headerlink" title="2. 二次方程根的求解"></a>2. 二次方程根的求解</h3><p><img src="/img/VB/zy/zy2_2.png" alt="第二次作业2"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim a As Variant, b As Variant, c As Variant, x1 As Variant, x2 As Variant
Dim ai As Double, bi As Double, ci As Double, dta As Double, xs1 As Double, xs2 As Double, xx1 As Double, xx2 As Double

Private Sub Command1_Click()
    a = Text1.Text: b = Text2.Text: c = Text3.Text
    If IsNumeric(a) And IsNumeric(b) And IsNumeric(c) Then
        ai = Val(a): bi = Val(b): ci = Val(c)
        dta = bi ^ 2 - 4 * ai * ci
        If dta > 0 Then
            x1 = (-bi + Sqr(dta)) / (2 * ai)
            x2 = (-bi - Sqr(dta)) / (2 * ai)
            Text4.Text = x1
            Text5.Text = x2
        ElseIf dta = 0 Then
            x1 = (-bi) / (2 * ai)
            x2 = (-bi) / (2 * ai)
            Text4.Text = x1
            Text5.Text = x2
        Else
            xs1 = Round((-bi) / (2 * ai), 2)
            xx1 = Round(Sqr(-dta) / (2 * ai), 2)
            Text4.Text = Str(xs1) & "+" & Str(xx1) & "i"
            xs2 = Round((-bi) / (2 * ai), 2)
            xx2 = Round(Sqr(-dta) / (2 * ai), 2)
            Text5.Text = Str(xs2) & "-" & Str(xx2) & "i"
        End If
    Else
        MsgBox "abc不全是数字"
    End If
End Sub

Private Sub Command2_Click()
    Text1.Text = ""
    Text2.Text = ""
    Text3.Text = ""
    Text4.Text = ""
    Text5.Text = ""
    Text1.SetFocus
End Sub

Private Sub Command3_Click()
    End
End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then Command1_Click
End Sub
Private Sub Text2_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then Command1_Click
End Sub
Private Sub Text3_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then Command1_Click
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>Dim 声明</li>
<li>ElseIf 的使用</li>
<li>MsgBox 的使用 <code>MsgBox "提示信息"</code></li>
<li>Round(x,2) 约到小数点后几位</li>
<li>keypress 的应用，可以执行事件</li>
</ul>
<h2 id="7-3-第三次作业"><a href="#7-3-第三次作业" class="headerlink" title="7.3 第三次作业"></a>7.3 第三次作业</h2><h3 id="所有水仙花数"><a href="#所有水仙花数" class="headerlink" title="所有水仙花数"></a>所有水仙花数</h3><p><img src="/img/VB/zy/zy3.png" alt="第三次作业"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    Dim a, b, c, num
    For num = 100 To 999
        a = num Mod 10
        b = num \ 10 Mod 10
        c = num \ 100
        If a ^ 3 + b ^ 3 + c ^ 3 = num Then Print num
    Next num
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li><code>15 mod 10</code>取余数 5</li>
<li><code>15 \ 10</code>整数相除得整数 1</li>
</ul>
<h2 id="7-4-第四次作业"><a href="#7-4-第四次作业" class="headerlink" title="7.4 第四次作业"></a>7.4 第四次作业</h2><h3 id="1-sub-子过程计算和"><a href="#1-sub-子过程计算和" class="headerlink" title="1. sub 子过程计算和"></a>1. sub 子过程计算和</h3><p><img src="/img/VB/zy/zy4_1.png" alt="第四次作业1"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    Dim sr As Integer, j As Integer, s As Long, f As Long
    sr = Text1.Text
    s = 0
    For j = 1 To sr
        Call Tim(j, f)
        s = s + f
    Next j
    Text2.Text = s
End Sub

Sub Tim(k As Integer, f As Long)
    Dim i As Integer
        f = 0
        For i = 1 To k
            f = f + i
        Next i
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>sub 子过程的编写和调用：call 函数名(参数，返回结果)</li>
</ul>
<h3 id="2-奖学金等级"><a href="#2-奖学金等级" class="headerlink" title="2. 奖学金等级"></a>2. 奖学金等级</h3><p><img src="/img/VB/zy/zy4_2.png" alt="第四次作业2"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit

Private Sub Command1_Click()
    Dim m1 As Long, m2 As Long, m3 As Long, jg As Long
    m1 = Text1.Text: m2 = Text2.Text: m3 = Text3.Text
    Call pd(m1, m2, m3, jg)
    If jg = 1 Then
        Text4.Text = "一等奖"
    ElseIf jg = 2 Then
        Text4.Text = "二等奖"
    ElseIf jg = 3 Then
        Text4.Text = "三等奖"
    Else
        Text4.Text = "没有奖"
    End If
End Sub

Sub pd(f1 As Long, f2 As Long, f3 As Long, jg As Long)
    Dim fpj As Long, p1 As Integer, p2 As Integer, p3 As Integer
    Dim f(1 To 3) As Integer, i As Variant
    fpj = (f1 + f2 + f3) / 3
    f(1) = f1: f(2) = f2: f(3) = f3
    p1 = 0: p2 = 0: p3 = 0
    For Each i In f
        If i = 100 Then
            p1 = p1 + 1
        End If
        If i >= 80 Then
            p2 = p2 + 1
        End If
        If i >= 75 Then
            p3 = p3 + 1
        End If
    Next i
    If (fpj > 95) Or (p1 >= 2 And p2 = 3) Then
        jg = 1
    ElseIf (fpj > 90) Or (p1 >= 1 And p3 = 3) Then
        jg = 2
    ElseIf p3 = 3 Then
        jg = 3
    End If
End Sub

Private Sub Text4_Click()
    Text1.Text = "": Text2.Text = "": Text3.Text = "": Text4.Text = ""
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>重点注意：</p>
<ul>
<li><code>for each a in f</code> 中的 a 必须是变体型变量</li>
</ul>
<h2 id="7-5-第五次作业"><a href="#7-5-第五次作业" class="headerlink" title="7.5 第五次作业"></a>7.5 第五次作业</h2><h3 id="1-RGB-三色调色板"><a href="#1-RGB-三色调色板" class="headerlink" title="1. RGB 三色调色板"></a>1. RGB 三色调色板</h3><p><img src="/img/VB/zy/zy5_1.png" alt="第五次作业1"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim r As Integer, g As Integer, b As Integer

Private Sub Command1_Click()
    Text2.ForeColor = Text1.BackColor
End Sub

Private Sub Command2_Click()
    Text2.BackColor = Text1.BackColor
End Sub

Private Sub HScroll1_Change()
    r = HScroll1.Value: g = HScroll2.Value: b = HScroll3.Value
    Text1.BackColor = RGB(r, g, b)
End Sub

Private Sub HScroll2_Change()
    r = HScroll1.Value: g = HScroll2.Value: b = HScroll3.Value
    Text1.BackColor = RGB(r, g, b)
End Sub

Private Sub HScroll3_Change()
    r = HScroll1.Value: g = HScroll2.Value: b = HScroll3.Value
    Text1.BackColor = RGB(r, g, b)
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>hscroll1.value 横向滚动条的值</li>
<li>hscroll1_change() 判断横向滚动条的值是否发生变化,变化时执行的程序</li>
<li>RGB()函数的使用</li>
</ul>
<h3 id="2-成绩合计-amp-密码验证"><a href="#2-成绩合计-amp-密码验证" class="headerlink" title="2. 成绩合计 &amp; 密码验证"></a>2. 成绩合计 &amp; 密码验证</h3><p><img src="/img/VB/zy/zy5_2.png" alt="第五次作业2"></p>
<p><strong>作业代码 1</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim i As Integer, t As Integer

Private Sub Command1_Click()
    t = 0
    For i = 0 To 4
        If Check1(i).Value Then
            t = t + Val(Text1(i).Text)
        End If
    Next i
    Text2.Text = t
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>控件数组的使用</li>
<li>check1.value 为 true 直接判断</li>
</ul>
<p><strong>作业代码 2</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">' Form2
Option Explicit
Dim reval As Integer

Private Sub bl_Click()
    reval = Shell("C:\Users\20180\Desktop\bz-live.bat", 2)
End Sub

Private Sub fb_Click()
    reval = Shell("C:\Users\20180\Desktop\fund.bat", 2)
End Sub

Private Sub Form_Click()
    PopupMenu b, 2
End Sub

Private Sub sc_Click()
    reval = Shell("C:\Users\20180\Desktop\scrcpy.bat", 2)
End Sub

Private Sub tc_Click()
    reval = Shell("C:\Users\20180\Desktop\timecal.bat", 2)
End Sub

'Form1

Option Explicit

Private Sub Command1_Click()
    If Text1.Text = "123" Then
        Form1.Hide
        Form2.Show
    Else
        Label2.Visible = True
        Label2.Caption = "password error"
        Text1.Text = ""
    End If
End Sub

Private Sub Form_Load()
    Label2.Visible = False
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>主要是菜单的编辑，工具–菜单编辑器</li>
<li>form1.hide &amp; form2.show 窗体的隐藏和显示</li>
<li><code>reval = shell("C:\Users\20180\Desktop\fund.bat",2)</code>调用程序</li>
</ul>
<h2 id="7-6-第六次作业"><a href="#7-6-第六次作业" class="headerlink" title="7.6 第六次作业"></a>7.6 第六次作业</h2><h3 id="学生成绩的录入、统计图表输出应用程序"><a href="#学生成绩的录入、统计图表输出应用程序" class="headerlink" title="学生成绩的录入、统计图表输出应用程序"></a>学生成绩的录入、统计图表输出应用程序</h3><p><img src="/img/VB/zy/zy6.png" alt="第六次作业"></p>
<p><strong>作业代码</strong></p>
<p><strong>form1</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim no, na, g1, g2 As Variant
Private Sub Command1_Click()
    no = Text1.Text: na = Text2.Text
    g1 = Val(Text3.Text): g2 = Val(Text4.Text)
    Write #2, no, na, g1, g2
    Text1.Text = "": Text2.Text = "": Text3.Text = "": Text4.Text = ""
End Sub

Private Sub Command2_Click()
    Close #2
    Form2.Show
End Sub

Private Sub Form_Load()
    CommonDialog1.ShowSave
    Open CommonDialog1.FileName For Append As #2
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>form2</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim num(100) As String, nam(100) As String
Dim g(100, 2) As Integer, n As Integer, ave, sum1, sum2, i

Private Sub Command1_Click()
    CommonDialog1.ShowOpen
    Open CommonDialog1.FileName For Input As #3
        n = 0
        Do While Not EOF(3)
            n = n + 1
            Input #3, num(n), nam(n), g(n, 1), g(n, 2)
        Text1.Text = Text1.Text & "   " & num(n) & _
        "   " & nam(n) & "    " & Str(g(n, 1)) & _
        "   " & Str(g(n, 2)) & "    " & Chr(13) & Chr(10)
        Loop
End Sub

Private Sub Command2_Click()
    CommonDialog1.ShowSave
    Open CommonDialog1.FileName For Output As #4
    sum1 = 0
    sum2 = 0
    Text2.Text = ""
    For i = 1 To n
        ave = (g(i, 1) + g(i, 2)) / 2
        Write #4, num(i), nam(i), g(i, 1), g(i, 2), ave
        Text2.Text = Text2.Text & "    " & num(i) & _
        "    " & nam(i) & "    " & Str(g(i, 1)) & "    " & _
        Str(g(i, 2)) & "    " & Str(ave) & vbCrLf
        sum1 = sum1 + g(i, 1): sum2 = sum2 + g(i, 2)
    Next i
    Text2.Text = Text2.Text & "总平均" & " " & _
    Str(sum1 / n) & "   " & Str(sum2 / n)
    Write #4, "总平均", sum1 / n, sum2 / n
End Sub

Private Sub Command3_Click()
    Close #3, #4
    End
End Sub

Private Sub Command4_Click()
    Form3.Show
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>form3</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim arrvalues(1 To 3, 1 To 3), num, nam
Dim s1, s2 As Integer
Dim i As Integer

Private Sub Command1_Click()
    CommonDialog1.ShowOpen
    Open CommonDialog1.FileName For Input As #5
    i = 1
    Do While Not EOF(5)
        Input #5, num, nam, s1, s2
        arrvalues(i, 1) = nam
        arrvalues(i, 2) = s1
        arrvalues(i, 3) = s2
        i = i + 1
    Loop
    MSChart1.ChartData = arrvalues
    Close #5
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>主要是文件的读取和写入</li>
<li>条形图的绘制<code>CommonDialog</code>控件</li>
</ul>
<h2 id="7-7-第七次作业"><a href="#7-7-第七次作业" class="headerlink" title="7.7 第七次作业"></a>7.7 第七次作业</h2><p><img src="/img/VB/zy/zy7.png" alt="第七次作业"></p>
<p><strong>作业代码</strong></p>
<pre class="line-numbers language-vb"><code class="language-vb">Option Explicit
Dim i, t, x, y, pcolor As Variant

Private Sub Form_Click()
    Picture1.Scale (-1, 1)-(1, -1)
    Picture1.DrawWidth = 3
    Picture1.Line (-1, 0)-(1, 0), vbBl
    Picture1.Line (0, 1)-(0, -1), vbBlue
    Picture1.DrawWidth = 1
    For i = -1 To 1 Step 0.1
        Picture1.Line (i, 0.05)-(i, 0)
    Next i
    Timer1.Interval = 10
End Sub

Private Sub Timer1_Timer()
    Picture1.DrawWidth = 2
    pcolor = RGB(Rnd * 255, Rnd * 255, Rnd * 255)
    For t = 0 To 2 * 3.1415925 Step 0.001
        x = Sin(2 * t) * Cos(t)
        y = Sin(2 * t) * Sin(t)
        Picture1.PSet (x, y), pcolor
        Next t
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>小知识点：</p>
<ul>
<li>Scale(x1,y1)-(x2,y2) 坐标轴的范围分成多少份</li>
<li>PSet画点，一系列的点组成先线（用for循环）</li>
</ul>
<h2 id="7-8-第八次作业"><a href="#7-8-第八次作业" class="headerlink" title="7.8 第八次作业"></a>7.8 第八次作业</h2><p><img src="/img/VB/zy/zy8.png" alt="第八次作业"></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://yq010105.github.io" rel="external nofollow noreferrer">Yun Qi</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://yq010105.github.io/2020/02/16/note-vb/">http://yq010105.github.io/2020/02/16/note-vb/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="http://yq010105.github.io" target="_blank">Yun Qi</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Note/">
                                    <span class="chip bg-color">Note</span>
                                </a>
                            
                                <a href="/tags/VB/">
                                    <span class="chip bg-color">VB</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,google,qq,wechat" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2020/02/17/q-spython/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/wallhaven/60.jpg" class="responsive-img" alt="用python解决问题">
                        
                        <span class="card-title">用python解决问题</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            用python模拟学习生活中遇到的问题，便于解决理解，大部分可能都是学概率统计的时候遇到的问题
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-02-17
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%8A%80%E6%9C%AF%E5%8A%9B/" class="post-category">
                                    技术力
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                    <a href="/tags/Questions/">
                        <span class="chip bg-color">Questions</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/02/15/note-java/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/wallhaven/17.jpg" class="responsive-img" alt="Java-Note">
                        
                        <span class="card-title">Java-Note</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Java 语言学习笔记本
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-02-15
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/" class="post-category">
                                    学习力
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Note/">
                        <span class="chip bg-color">Note</span>
                    </a>
                    
                    <a href="/tags/Java/">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1,h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1,h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2020</span>
            <a href="http://yq010105.github.io" target="_blank">Yun Qi</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <!--br-->
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">68.6k</span>&nbsp;字
            
            
            
            
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2020";
                    var startMonth = "2";
                    var startDate = "4";
                    var startHour = "15";
                    var startMinute = "34";
                    var startSecond = "18";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已被迫运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已被迫运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/yq010105" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>







    <a href="https://twitter.com/satoru43886693" class="tooltipped" target="_blank" data-tooltip="关注我的Twitter: https://twitter.com/satoru43886693" data-position="top" data-delay="50">
        <i class="fab fa-twitter"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1422718901" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1422718901" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>









    <a href="https://space.bilibili.com/168705417" class="tooltipped" target="_blank" data-tooltip="b站帐号: https://space.bilibili.com/168705417" data-position="top" data-delay="50">
        <i class="fas fa-star"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>
    <!--樱花飘落-->
    <!--script-- src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/js/sakura.js"></!--script-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    

    

    

    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

    <script>var OriginTitile=document.title;
        var st;
        document.addEventListener('visibilitychange',function(){
        if(document.hidden){
            document.title="(つェ⊂)看不见惹~"+OriginTitile;
            clearTimeout(st);
            console.log('hide');
            }
        else{
            document.title='(*´∇｀*)被你发现了~ '+OriginTitile;
            console.log('show');
            st=setTimeout(function(){
            document.title=OriginTitile;
            },6000);
            console.log('endChange=');
        }
        });
    </script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"./live2d_models/haruna/33/model.2018.spring.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":true},"react":{"opacity":0.8},"log":false});</script></body>

</html>
