<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="summary"><title>Python中openpyxl库的学习 | Yun.Qi</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.png"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Python中openpyxl库的学习</h1><a id="logo" href="/.">Yun.Qi</a><p class="summary">Note/Diary</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Python中openpyxl库的学习</h1><div class="post-meta">2020-02-22<span> | </span><span class="category"><a href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1,223</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 6</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-打开文件夹"><span class="toc-text">1. 打开文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-创建"><span class="toc-text">1.1 创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-储存"><span class="toc-text">1.2 储存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-打开已有"><span class="toc-text">1.3 打开已有</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-创建表"><span class="toc-text">2. 创建表</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-1-创建表（sheet"><span class="toc-text">2.1 创建表（sheet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-选择表"><span class="toc-text">2.2 选择表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-查看表名（sheet）"><span class="toc-text">2.3 查看表名（sheet）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-单元格"><span class="toc-text">3. 单元格</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-储存数据"><span class="toc-text">3.1 储存数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-访问单元格（call）"><span class="toc-text">3.2 访问单元格（call）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-单单元格访问"><span class="toc-text">3.2.1 单单元格访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-多单元格访问"><span class="toc-text">3.2.2 多单元格访问</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-其他"><span class="toc-text">4. 其他</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-改变-sheet-标签按钮颜色"><span class="toc-text">4.1 改变 sheet 标签按钮颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-获取最大行，最大列"><span class="toc-text">4.2 获取最大行，最大列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-获取每一行每一列"><span class="toc-text">4.3 获取每一行每一列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-根据数字得到字母，根据字母得到数字"><span class="toc-text">4.4 根据数字得到字母，根据字母得到数字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-删除工作表"><span class="toc-text">4.5 删除工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-矩阵置换（行-→-列）"><span class="toc-text">4.6 矩阵置换（行 → 列）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-设置单元格风格"><span class="toc-text">4.7 设置单元格风格</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-1-需要导入的类"><span class="toc-text">4.7.1 需要导入的类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-2-字体"><span class="toc-text">4.7.2 字体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-3-对齐方式"><span class="toc-text">4.7.3 对齐方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-4-设置行高和列宽"><span class="toc-text">4.7.4 设置行高和列宽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-5-合并和拆分单元格"><span class="toc-text">4.7.5 合并和拆分单元格</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><p><strong>Python openpyxl 的操作方法</strong></p>
<blockquote>
<p><a href="https://www.jb51.net/article/169356.htm" target="_blank" rel="noopener">参考教程</a></p>
</blockquote>
<a id="more"></a>

<h1 id="1-打开文件夹"><a href="#1-打开文件夹" class="headerlink" title="1. 打开文件夹"></a>1. 打开文件夹</h1><p><strong><code>from openpyxl import Workbook</code></strong></p>
<h2 id="1-1-创建"><a href="#1-1-创建" class="headerlink" title="1.1 创建"></a>1.1 创建</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实例化</span></span><br><span class="line">wb = Workbook()</span><br><span class="line"><span class="comment"># 激活worksheet</span></span><br><span class="line">ws = wb.active</span><br></pre></td></tr></tbody></table></figure>

<h2 id="1-2-储存"><a href="#1-2-储存" class="headerlink" title="1.2 储存"></a>1.2 储存</h2><p>每个文件操作完之后需要储存</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wb.save(<span class="string">'文件名.xlsx'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="1-3-打开已有"><a href="#1-3-打开已有" class="headerlink" title="1.3 打开已有"></a>1.3 打开已有</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wb2 = load_workbook(<span class="string">'文件名.xlsx'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h1 id="2-创建表"><a href="#2-创建表" class="headerlink" title="2. 创建表"></a>2. 创建表</h1><h1 id="2-1-创建表（sheet"><a href="#2-1-创建表（sheet" class="headerlink" title="2.1 创建表（sheet"></a>2.1 创建表（sheet</h1><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方式一：插入到最后(default)</span></span><br><span class="line">ws1 = wb.create_sheet(<span class="string">"Mysheet"</span>)</span><br><span class="line"><span class="comment"># 方式二：插入到最开始的位置</span></span><br><span class="line">ws2 = wb.create_sheet(<span class="string">"Mysheet"</span>, <span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-2-选择表"><a href="#2-2-选择表" class="headerlink" title="2.2 选择表"></a>2.2 选择表</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sheet 名称可以作为 key 进行索引</span></span><br><span class="line">ws3 = wb[<span class="string">"New Title"</span>]</span><br><span class="line">ws4 = wb.get_sheet_by_name(<span class="string">"New Title"</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-3-查看表名（sheet）"><a href="#2-3-查看表名（sheet）" class="headerlink" title="2.3 查看表名（sheet）"></a>2.3 查看表名（sheet）</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示所有表名</span></span><br><span class="line">print(wb.sheetnames)</span><br><span class="line">[<span class="string">'Sheet2'</span>, <span class="string">'New Title'</span>, <span class="string">'Sheet1'</span>]</span><br><span class="line"><span class="comment"># 遍历所有表</span></span><br><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> wb:</span><br><span class="line">    print(sheet.title)</span><br></pre></td></tr></tbody></table></figure>

<h1 id="3-单元格"><a href="#3-单元格" class="headerlink" title="3. 单元格"></a>3. 单元格</h1><h2 id="3-1-储存数据"><a href="#3-1-储存数据" class="headerlink" title="3.1 储存数据"></a>3.1 储存数据</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  方式一 数据可以直接分配到单元格中(可以输入公式)</span></span><br><span class="line">ws[<span class="string">'A1'</span>] = <span class="number">42</span></span><br><span class="line"><span class="comment"># 方式二：可以附加行，从第一列开始附加(从最下方空白处，最左开始)(可以输入多行)</span></span><br><span class="line">ws.append([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 方式三：Python 类型会被自动转换</span></span><br><span class="line">ws[<span class="string">'A3'</span>] = datetime.datetime.now().strftime(<span class="string">"%Y-%m-%d"</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-2-访问单元格（call）"><a href="#3-2-访问单元格（call）" class="headerlink" title="3.2 访问单元格（call）"></a>3.2 访问单元格（call）</h2><h3 id="3-2-1-单单元格访问"><a href="#3-2-1-单单元格访问" class="headerlink" title="3.2.1 单单元格访问"></a>3.2.1 单单元格访问</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法一</span></span><br><span class="line">c = ws[<span class="string">'A4'</span>]</span><br><span class="line"><span class="comment"># 方法二：row 行；column 列</span></span><br><span class="line">d = ws.cell(row=<span class="number">4</span>, column=<span class="number">2</span>, value=<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 方法三：只要访问就创建</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">        ws.cell(row=i, column=j)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-2-2-多单元格访问"><a href="#3-2-2-多单元格访问" class="headerlink" title="3.2.2 多单元格访问"></a>3.2.2 多单元格访问</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过切片</span></span><br><span class="line">cell_range = ws[<span class="string">'A1'</span>:<span class="string">'C2'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过行(列)</span></span><br><span class="line">colC = ws[<span class="string">'C'</span>]</span><br><span class="line">col_range = ws[<span class="string">'C:D'</span>]</span><br><span class="line">row10 = ws[<span class="number">10</span>]</span><br><span class="line">row_range = ws[<span class="number">5</span>:<span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过指定范围(行 → 行)</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">1</span>, max_col=<span class="number">3</span>, max_row=<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">        print(cell)</span><br><span class="line">&lt;Cell Sheet1.A1&gt;</span><br><span class="line">&lt;Cell Sheet1.B1&gt;</span><br><span class="line">&lt;Cell Sheet1.C1&gt;</span><br><span class="line">&lt;Cell Sheet1.A2&gt;</span><br><span class="line">&lt;Cell Sheet1.B2&gt;</span><br><span class="line">&lt;Cell Sheet1.C2&gt;　</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过指定范围(列 → 列)</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">1</span>, max_col=<span class="number">3</span>, max_row=<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">        print(cell)</span><br><span class="line">&lt;Cell Sheet1.A1&gt;</span><br><span class="line">&lt;Cell Sheet1.B1&gt;</span><br><span class="line">&lt;Cell Sheet1.C1&gt;</span><br><span class="line">&lt;Cell Sheet1.A2&gt;</span><br><span class="line">&lt;Cell Sheet1.B2&gt;</span><br><span class="line">&lt;Cell Sheet1.C2&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历所有 方法一</span></span><br><span class="line">ws = wb.active</span><br><span class="line">ws[<span class="string">'C9'</span>] = <span class="string">'hello world'</span></span><br><span class="line">tuple(ws.rows)</span><br><span class="line">((&lt;Cell Sheet.A1&gt;, &lt;Cell Sheet.B1&gt;, &lt;Cell Sheet.C1&gt;),</span><br><span class="line">(&lt;Cell Sheet.A2&gt;, &lt;Cell Sheet.B2&gt;, &lt;Cell Sheet.C2&gt;),</span><br><span class="line">...</span><br><span class="line">(&lt;Cell Sheet.A8&gt;, &lt;Cell Sheet.B8&gt;, &lt;Cell Sheet.C8&gt;),</span><br><span class="line">(&lt;Cell Sheet.A9&gt;, &lt;Cell Sheet.B9&gt;, &lt;Cell Sheet.C9&gt;))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历所有 方法二</span></span><br><span class="line">tuple(ws.columns)</span><br><span class="line">((&lt;Cell Sheet.A1&gt;,</span><br><span class="line">&lt;Cell Sheet.A2&gt;,</span><br><span class="line">&lt;Cell Sheet.A3&gt;,</span><br><span class="line">...</span><br><span class="line">&lt;Cell Sheet.B7&gt;,</span><br><span class="line">&lt;Cell Sheet.B8&gt;,</span><br><span class="line">&lt;Cell Sheet.B9&gt;),</span><br><span class="line">(&lt;Cell Sheet.C1&gt;,</span><br><span class="line">...</span><br><span class="line">&lt;Cell Sheet.C8&gt;,</span><br><span class="line">&lt;Cell Sheet.C9&gt;))</span><br></pre></td></tr></tbody></table></figure>

<h1 id="4-其他"><a href="#4-其他" class="headerlink" title="4. 其他"></a>4. 其他</h1><h2 id="4-1-改变-sheet-标签按钮颜色"><a href="#4-1-改变-sheet-标签按钮颜色" class="headerlink" title="4.1 改变 sheet 标签按钮颜色"></a>4.1 改变 sheet 标签按钮颜色</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.sheet_properties.tabColor = <span class="string">"1072BA"</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-2-获取最大行，最大列"><a href="#4-2-获取最大行，最大列" class="headerlink" title="4.2 获取最大行，最大列"></a>4.2 获取最大行，最大列</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得最大列和最大行</span></span><br><span class="line">print(sheet.max_row)</span><br><span class="line">print(sheet.max_column)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-3-获取每一行每一列"><a href="#4-3-获取每一行每一列" class="headerlink" title="4.3 获取每一行每一列"></a>4.3 获取每一行每一列</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sheet.rows为生成器, 里面是每一行的数据，每一行又由一个tuple包裹。</span><br><span class="line">sheet.columns类似，不过里面是每个tuple是每一列的单元格。</span><br><span class="line"><span class="comment"># 因为按行，所以返回A1, B1, C1这样的顺序</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.rows:</span><br><span class="line">  <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">    print(cell.value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># A1, A2, A3这样的顺序</span></span><br><span class="line"><span class="keyword">for</span> column <span class="keyword">in</span> sheet.columns:</span><br><span class="line">  <span class="keyword">for</span> cell <span class="keyword">in</span> column:</span><br><span class="line">    print(cell.value)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-4-根据数字得到字母，根据字母得到数字"><a href="#4-4-根据数字得到字母，根据字母得到数字" class="headerlink" title="4.4 根据数字得到字母，根据字母得到数字"></a>4.4 根据数字得到字母，根据字母得到数字</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl.utils <span class="keyword">import</span> get_column_letter, column_index_from_string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据列的数字返回字母</span></span><br><span class="line">print(get_column_letter(<span class="number">2</span>)) <span class="comment"># B</span></span><br><span class="line"><span class="comment"># 根据字母返回列的数字</span></span><br><span class="line">print(column_index_from_string(<span class="string">'D'</span>)) <span class="comment"># 4</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-5-删除工作表"><a href="#4-5-删除工作表" class="headerlink" title="4.5 删除工作表"></a>4.5 删除工作表</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方式一</span></span><br><span class="line">wb.remove(sheet)</span><br><span class="line"><span class="comment"># 方式二</span></span><br><span class="line"><span class="keyword">del</span> wb[sheet]</span><br></pre></td></tr></tbody></table></figure>


<h2 id="4-6-矩阵置换（行-→-列）"><a href="#4-6-矩阵置换（行-→-列）" class="headerlink" title="4.6 矩阵置换（行 → 列）"></a>4.6 矩阵置换（行 → 列）</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">rows = [</span><br><span class="line">  [<span class="string">'Number'</span>, <span class="string">'data1'</span>, <span class="string">'data2'</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="number">40</span>, <span class="number">30</span>],</span><br><span class="line">  [<span class="number">3</span>, <span class="number">40</span>, <span class="number">25</span>],</span><br><span class="line">  [<span class="number">4</span>, <span class="number">50</span>, <span class="number">30</span>],</span><br><span class="line">  [<span class="number">5</span>, <span class="number">30</span>, <span class="number">10</span>],</span><br><span class="line">  [<span class="number">6</span>, <span class="number">25</span>, <span class="number">5</span>],</span><br><span class="line">  [<span class="number">7</span>, <span class="number">50</span>, <span class="number">10</span>]]</span><br><span class="line"></span><br><span class="line">list(zip(*rows))</span><br><span class="line"></span><br><span class="line"><span class="comment"># out</span></span><br><span class="line">[(<span class="string">'Number'</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>),</span><br><span class="line"> (<span class="string">'data1'</span>, <span class="number">40</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">50</span>),</span><br><span class="line"> (<span class="string">'data2'</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">10</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意 方法会舍弃缺少数据的列(行)</span></span><br><span class="line">rows = [</span><br><span class="line">  [<span class="string">'Number'</span>, <span class="string">'data1'</span>, <span class="string">'data2'</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="number">40</span>  ], <span class="comment"># 这里少一个数据</span></span><br><span class="line">  [<span class="number">3</span>, <span class="number">40</span>, <span class="number">25</span>],</span><br><span class="line">  [<span class="number">4</span>, <span class="number">50</span>, <span class="number">30</span>],</span><br><span class="line">  [<span class="number">5</span>, <span class="number">30</span>, <span class="number">10</span>],</span><br><span class="line">  [<span class="number">6</span>, <span class="number">25</span>, <span class="number">5</span>],</span><br><span class="line">  [<span class="number">7</span>, <span class="number">50</span>, <span class="number">10</span>],</span><br><span class="line">]</span><br><span class="line"><span class="comment"># out</span></span><br><span class="line">[(<span class="string">'Number'</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>), (<span class="string">'data1'</span>, <span class="number">40</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">50</span>)]</span><br></pre></td></tr></tbody></table></figure>

<h2 id="4-7-设置单元格风格"><a href="#4-7-设置单元格风格" class="headerlink" title="4.7 设置单元格风格"></a>4.7 设置单元格风格</h2><h3 id="4-7-1-需要导入的类"><a href="#4-7-1-需要导入的类" class="headerlink" title="4.7.1 需要导入的类"></a>4.7.1 需要导入的类</h3><p><code>from openpyxl.styles import Font, colors, Alignment</code></p>
<h3 id="4-7-2-字体"><a href="#4-7-2-字体" class="headerlink" title="4.7.2 字体"></a>4.7.2 字体</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bold_itatic_24_font = Font(name=<span class="string">'等线'</span>, size=<span class="number">24</span>, italic=<span class="literal">True</span>, color=colors.RED, bold=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 代码指定了等线24号，加粗斜体，字体颜色红色。直接使用cell的font属性，将Font对象赋值给它</span></span><br><span class="line">sheet[<span class="string">'A1'</span>].font = bold_itatic_24_font</span><br></pre></td></tr></tbody></table></figure>

<h3 id="4-7-3-对齐方式"><a href="#4-7-3-对齐方式" class="headerlink" title="4.7.3 对齐方式"></a>4.7.3 对齐方式</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置B1中的数据垂直居中和水平居中</span></span><br><span class="line">sheet[<span class="string">'B1'</span>].alignment = Alignment(horizontal=<span class="string">'center'</span>, vertical=<span class="string">'center'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="4-7-4-设置行高和列宽"><a href="#4-7-4-设置行高和列宽" class="headerlink" title="4.7.4 设置行高和列宽"></a>4.7.4 设置行高和列宽</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第2行行高</span></span><br><span class="line">sheet.row_dimensions[<span class="number">2</span>].height = <span class="number">40</span></span><br><span class="line"><span class="comment"># C列列宽</span></span><br><span class="line">sheet.column_dimensions[<span class="string">'C'</span>].width = <span class="number">30</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="4-7-5-合并和拆分单元格"><a href="#4-7-5-合并和拆分单元格" class="headerlink" title="4.7.5 合并和拆分单元格"></a>4.7.5 合并和拆分单元格</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并单元格， 往左上角写入数据即可</span></span><br><span class="line">sheet.merge_cells(<span class="string">'B1:G1'</span>) <span class="comment"># 合并一行中的几个单元格</span></span><br><span class="line">sheet.merge_cells(<span class="string">'A1:C3'</span>) <span class="comment"># 合并一个矩形区域中的单元格</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="tags"><a href="/tags/Python/"><i class="fa fa-tag"></i>Python</a></div><div class="post-nav"><a class="pre" href="/2020/02/22/python-plotly/">Python中plotly的学习</a><a class="next" href="/2020/02/21/python-np/">Python中numpy库的学习</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15px;">前端</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Compete/" style="font-size: 15px;">Compete</a> <a href="/tags/Android-Studio/" style="font-size: 15px;">Android Studio</a> <a href="/tags/Bilibili/" style="font-size: 15px;">Bilibili</a> <a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 15px;">单片机</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Spider/" style="font-size: 15px;">Spider</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Note/" style="font-size: 15px;">Note</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/tags/Server/" style="font-size: 15px;">Server</a> <a href="/tags/VB/" style="font-size: 15px;">VB</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/C/" style="font-size: 15px;">C#</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/Jsoup/" style="font-size: 15px;">Jsoup</a> <a href="/tags/Questions/" style="font-size: 15px;">Questions</a> <a href="/tags/Api/" style="font-size: 15px;">Api</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Source/" style="font-size: 15px;">Source</a> <a href="/tags/Life/" style="font-size: 15px;">Life</a> <a href="/tags/Imagination/" style="font-size: 15px;">Imagination</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a><span class="category-list-count">35</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%83%B3%E8%B1%A1%E5%8A%9B/">想象力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%8A%9B/">技术力</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A0%E5%8A%9B/">无力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B5%84%E6%BA%90%E5%8A%9B/">资源力</a><span class="category-list-count">3</span></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Yun.Qi.</a> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> | Theme by<a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Maupassant</a><br/><span class="footer-birthday-text">Birthday</span><span class="footer-birthday-date">2020/02/04</span></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>