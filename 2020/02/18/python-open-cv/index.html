<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="summary"><title>Python中Opencv库的学习 | Yun.Qi</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.png"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Python中Opencv库的学习</h1><a id="logo" href="/.">Yun.Qi</a><p class="summary">Note/Diary</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Python中Opencv库的学习</h1><div class="post-meta">2020-02-18<span> | </span><span class="category"><a href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 6,762</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 31</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0-基本知识的学习"><span class="toc-text">0.基本知识的学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-1-基本操作"><span class="toc-text">0.1 基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1-1-画直线"><span class="toc-text">0.1.1 画直线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1-2-调用笔记本摄像头"><span class="toc-text">0.1.2 调用笔记本摄像头</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-2-基本属性-函数"><span class="toc-text">0.2 基本属性&#x2F;函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-3-读取视频"><span class="toc-text">0.3 读取视频</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-4-感兴趣区域"><span class="toc-text">0.4 感兴趣区域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-5-特殊选取-切分通道"><span class="toc-text">0.5 特殊选取,切分通道</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-6-边界填充"><span class="toc-text">0.6 边界填充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-7-数值计算-图像融合-大小放缩"><span class="toc-text">0.7 数值计算\图像融合\大小放缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-8-图像阈值"><span class="toc-text">0.8 图像阈值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-9-图像平滑-去掉噪音点"><span class="toc-text">0.9 图像平滑-去掉噪音点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-10-形态学-腐蚀操作-去掉毛刺"><span class="toc-text">0.10 形态学-腐蚀操作-去掉毛刺</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-11-形态学-膨胀操作"><span class="toc-text">0.11 形态学-膨胀操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-12-开运算与闭运算"><span class="toc-text">0.12 开运算与闭运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-13-梯度运算"><span class="toc-text">0.13 梯度运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-14-礼帽-黑帽"><span class="toc-text">0.14 礼帽 黑帽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-15-图像梯度-Sobel-算子"><span class="toc-text">0.15 图像梯度-Sobel 算子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-16-图像梯度-Scharr-amp-amp-Laplacian-算子"><span class="toc-text">0.16 图像梯度 Scharr&amp;&amp;Laplacian 算子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-17-Canny-边缘检测–综合"><span class="toc-text">0.17 Canny 边缘检测–综合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-18-图像金字塔"><span class="toc-text">0.18 图像金字塔</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-19-图像轮廓"><span class="toc-text">0.19 图像轮廓</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-20-模板匹配—-匹配对象在另一个图像哪里"><span class="toc-text">0.20 模板匹配—-匹配对象在另一个图像哪里</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-21-直方图"><span class="toc-text">0.21 直方图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-22-傅里叶变换"><span class="toc-text">0.22 傅里叶变换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-23-摄像头获取视频或图片获取感兴趣部分"><span class="toc-text">0.23 摄像头获取视频或图片获取感兴趣部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-23-1-选取-roi-区域定义"><span class="toc-text">0.23.1 选取 roi 区域定义</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-图像识别相关"><span class="toc-text">1. 图像识别相关</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-两张图片对比"><span class="toc-text">1.1 两张图片对比</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-根据数据生成表格，图线"><span class="toc-text">2. 根据数据生成表格，图线</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-慢慢学-opencv"><span class="toc-text">3. 慢慢学 opencv</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-在新窗口打开图片，保存图片，基操"><span class="toc-text">3.1 在新窗口打开图片，保存图片，基操</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-图像阈值化"><span class="toc-text">3.2 图像阈值化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-图像形状变化"><span class="toc-text">3.3 图像形状变化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-cv2-resize-图像缩放"><span class="toc-text">3.3.1 cv2.resize() 图像缩放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-仿射变换"><span class="toc-text">3.3.2 仿射变换</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><a id="more"></a>

<h1 id="0-基本知识的学习"><a href="#0-基本知识的学习" class="headerlink" title="0.基本知识的学习"></a>0.基本知识的学习</h1><h2 id="0-1-基本操作"><a href="#0-1-基本操作" class="headerlink" title="0.1 基本操作"></a>0.1 基本操作</h2><p>引用库<br><code>import cv2</code></p>
<p>cv2.IMREAD_COLOR:彩色图像 RGB 三通道<br>cv2.IMREAD_GRAYSCALE：灰度图像 灰度一个通道</p>
<ul>
<li><code>img = cv2.imread('1.jpg')</code>打开图像—-type(img) = numpy.ndarry</li>
<li><code>img = cv2.imread('1.jpg',cv2.IMREAD_GRAYSCALE)</code>打开为灰度图像</li>
<li><code>cv2.imshow('image',img)</code>展示图像，窗口 image</li>
<li><code>cv2.waitKey(0)</code>窗口停留时间毫秒级，0 表示按任意键退出</li>
<li><code>cv2.destroyALLWindows()</code>销毁窗口</li>
<li><code>cv2.imwrite('result.jpg',img)</code>保存图像，（文件名，图片）</li>
</ul>
<p><em>可以直接定义一个函数</em></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv_show</span><span class="params">(name,img)</span>:</span></span><br><span class="line">    cv2.imshow(name,img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyALLWindows()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="0-1-1-画直线"><a href="#0-1-1-画直线" class="headerlink" title="0.1.1 画直线"></a>0.1.1 画直线</h3><p>像素点坐标，左为零，上为零<br>左上角为坐标原点，而坐标系是从左到右 x 符合，从上到下，y 要取负</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">img = np.zeros((<span class="number">320</span>, <span class="number">320</span>, <span class="number">3</span>), np.uint8) <span class="comment">#生成一个空灰度图像</span></span><br><span class="line">print(img.shape) <span class="comment"># 输出：(320, 320, 3)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv_show</span><span class="params">(name,img)</span>:</span></span><br><span class="line">    cv2.namedWindow(name,<span class="number">0</span>)</span><br><span class="line">    cv2.imshow(name,img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图片，初始坐标，结束坐标，图线颜色，图线粗细</span></span><br><span class="line">cv2.line(img,(<span class="number">0</span>,<span class="number">100</span>),(<span class="number">100</span>,<span class="number">0</span>),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">2</span>)</span><br><span class="line">cv2.line(img,(<span class="number">0</span>,<span class="number">200</span>),(<span class="number">100</span>,<span class="number">0</span>),(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>),<span class="number">2</span>)</span><br><span class="line">cv_show(<span class="string">'line'</span>,img)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="0-1-2-调用笔记本摄像头"><a href="#0-1-2-调用笔记本摄像头" class="headerlink" title="0.1.2 调用笔记本摄像头"></a>0.1.2 调用笔记本摄像头</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">video = cv2.VideoCapture(<span class="number">0</span>) <span class="comment"># 参数是0，表示打开笔记本的内置摄像头，参数是视频文件路径则打开视频，如cap = cv2.VideoCapture("../test.avi")</span></span><br><span class="line">ret,frame = video.read() <span class="comment"># ret,frame是获cap.read()方法的两个返回值。其中ret是布尔值，如果读取帧是正确的则返回True，如果文件读取到结尾，它的返回值就为False</span></span><br><span class="line"></span><br><span class="line">cv2.waitKey(<span class="number">0</span>) <span class="comment"># 如cv2.waitKey(0)只显示当前帧图像，相当于视频暂停</span></span><br><span class="line">cv2.waitKey(<span class="number">1</span>) <span class="comment"># 表示延时1ms切换到下一帧图像，对于视频而言</span></span><br><span class="line">cv2.waitKey(<span class="number">1000</span>) <span class="comment"># 会因为延时过久而卡顿感觉到卡顿</span></span><br><span class="line"></span><br><span class="line">cv2.release()</span><br><span class="line">调用release()释放摄像头，调用destroyAllWindows()关闭所有图像窗口</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-2-基本属性-函数"><a href="#0-2-基本属性-函数" class="headerlink" title="0.2 基本属性/函数"></a>0.2 基本属性/函数</h2><p>img.shape # (414.500.3) (h,w,rgb=3)<br>img.size # h*w*rgb<br>img.dtype # uint8</p>
<h2 id="0-3-读取视频"><a href="#0-3-读取视频" class="headerlink" title="0.3 读取视频"></a>0.3 读取视频</h2><p>cv2.VideoCapture 捕获摄像头</p>
<ul>
<li><code>vc = cv2.VideoCapture('test.mp4')</code> 打开视频</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查是否正确打开</span></span><br><span class="line"><span class="keyword">if</span> vc.isOpened():</span><br><span class="line">    open. frame = vc.read()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    open = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> open:</span><br><span class="line"></span><br><span class="line"><span class="comment"># 播放视频 循环每一帧</span></span><br><span class="line"><span class="keyword">while</span> open:</span><br><span class="line">    ret, frame = vc.read()</span><br><span class="line">    <span class="keyword">if</span> frame <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> ret == <span class="literal">True</span>:</span><br><span class="line">        gray = cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)   <span class="comment">#转化为灰度</span></span><br><span class="line">        cv2.namedWindow(<span class="string">'result'</span>,<span class="number">0</span>)</span><br><span class="line">        cv2.imshow(<span class="string">'result'</span>,gray)</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">10</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>: <span class="comment"># 10刚刚好速度，27按esc退出</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">vc.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-4-感兴趣区域"><a href="#0-4-感兴趣区域" class="headerlink" title="0.4 感兴趣区域"></a>0.4 感兴趣区域</h2><p>图像截取</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">img = cv.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line">cat = img[<span class="number">0</span>:<span class="number">200</span>,<span class="number">0</span>:<span class="number">200</span>]</span><br><span class="line">cv.show(<span class="string">'cat'</span>,cat)</span><br></pre></td></tr></tbody></table></figure>

<p>图片截取，（识别技术将匹配到的数据展示）</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">image_clip = image_rgb[int(top):(int(top) + int(height)), int(left):(int(left) + int(width))]</span><br><span class="line">顺序为[y0:y1, x0:x1]</span><br></pre></td></tr></tbody></table></figure>


<h2 id="0-5-特殊选取-切分通道"><a href="#0-5-特殊选取-切分通道" class="headerlink" title="0.5 特殊选取,切分通道"></a>0.5 特殊选取,切分通道</h2><p>b：::0<br>g：::1<br>r：::2</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b,g,r = cv2.split(img)  <span class="comment"># 切分</span></span><br><span class="line">b.shape == g.shape == r.shape</span><br><span class="line"></span><br><span class="line">img = cv2.merge((b,g,r))    <span class="comment"># 合并</span></span><br><span class="line">img.shape</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-6-边界填充"><a href="#0-6-边界填充" class="headerlink" title="0.6 边界填充"></a>0.6 边界填充</h2><p>图像的边界</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上下左右填充大小</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv_show</span><span class="params">(name,img)</span>:</span></span><br><span class="line">    cv2.imshow(name,img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyALLWindows()</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">'./img/1.jpg'</span>)</span><br><span class="line"><span class="comment"># 定义边界大小</span></span><br><span class="line">top_size, bottom_size, left_size,right_size = (<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>)</span><br><span class="line"><span class="comment"># 复制法，复制最边缘像素</span></span><br><span class="line">replicate = cv2.copyMakeBorder(img,top_size,bottom_size,left_size,right_size,borderType = cv2.BORDER_REPLICATE)</span><br><span class="line"><span class="comment"># 反射法 对感兴趣的图像中的像素在两边进行复制  ba|abc|cb</span></span><br><span class="line">reflect = cv2.copyMakeBorder(img,top_size,bottom_size,left_size,right_size,borderType = cv2.BORDER_REFLECT)</span><br><span class="line"><span class="comment"># 反射法   edcb|abcdefgh|gfedc</span></span><br><span class="line">reflect2 = cv2.copyMakeBorder(img,top_size,bottom_size,left_size,right_size,borderType = cv2.BORDER_REFLECT_101)</span><br><span class="line"><span class="comment"># 外包装法  cdefgh|abcdefgh|abcdef</span></span><br><span class="line">wrap = cv2.copyMakeBorder(img,top_size,bottom_size,left_size,right_size,borderType = cv2.BORDER_WRAP)</span><br><span class="line"><span class="comment"># 常量法   常数值补充</span></span><br><span class="line">constant = cv2.copyMakeBorder(img,top_size,bottom_size,left_size,right_size,borderType = cv2.BORDER_CONSTANT)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-7-数值计算-图像融合-大小放缩"><a href="#0-7-数值计算-图像融合-大小放缩" class="headerlink" title="0.7 数值计算\图像融合\大小放缩"></a>0.7 数值计算\图像融合\大小放缩</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">img1 = cv2.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line">img2 = cv2.imread(<span class="string">'2.jpg'</span>)</span><br><span class="line"></span><br><span class="line">img11 = img1 + <span class="number">10</span>  <span class="comment"># [500,500,3] 中每一块都加10</span></span><br><span class="line">img1[:<span class="number">5</span>,:,<span class="number">0</span>].shape 只打印前五行</span><br><span class="line">img11[:<span class="number">5</span>,:,<span class="number">0</span>]</span><br><span class="line">(img1+img11)[:<span class="number">5</span>,:,<span class="number">0</span>]    如果超出，则结果取余</span><br><span class="line">cv2.add(img1,img11)[:<span class="number">5</span>,:,<span class="number">0</span>] 如果超出<span class="number">255</span>，则不取余直接用<span class="number">255</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图像融合</span></span><br><span class="line"></span><br><span class="line">img1+img2 <span class="comment">#shape不同，则加不了</span></span><br><span class="line">img1.shape  <span class="comment"># (414,500,3)</span></span><br><span class="line">img2.shape  <span class="comment"># (419,499,3)</span></span><br><span class="line">img2 = cv2.resize(img2,(<span class="number">500</span>,<span class="number">414</span>))   <span class="comment"># 改变大小</span></span><br><span class="line">img2.shape  <span class="comment"># (414,500,3)</span></span><br><span class="line"></span><br><span class="line">res = cv2.addWeighted(img1,<span class="number">0.4</span>,img2,<span class="number">0.6</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># res = img1*0.4+img2*0.6+0     权重</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图像大小放缩</span></span><br><span class="line">res = cv2.resize(img,(<span class="number">0</span>,<span class="number">0</span>),fx=<span class="number">0.5</span>,fy=<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-8-图像阈值"><a href="#0-8-图像阈值" class="headerlink" title="0.8 图像阈值"></a>0.8 图像阈值</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">cv2.threshold():</span><br><span class="line">参数：</span><br><span class="line">    img:图像对象，必须是灰度图</span><br><span class="line">    thresh:阈值 <span class="number">0</span>~<span class="number">255</span>   eg:<span class="number">127</span></span><br><span class="line">    maxval：最大值  <span class="number">255</span></span><br><span class="line">    type:</span><br><span class="line">        cv2.THRESH_BINARY:     小于阈值的像素置为<span class="number">0</span>，大于阈值的置为maxval</span><br><span class="line">            超过阈值部分取最大值maxval=<span class="number">255</span> white，否则取<span class="number">0</span> black</span><br><span class="line">            亮的地方白，暗的地方黑</span><br><span class="line">        cv2.THRESH_BINARY_INV： 小于阈值的像素置为maxval，大于阈值的置为<span class="number">0</span></span><br><span class="line">            亮的地方黑，暗的地方白</span><br><span class="line">        cv2.THRESH_TRUNC：      小于阈值的像素不变，大于阈值的置为thresh</span><br><span class="line">            指定一个截断值，大于阈值部分变成阈值，小于的不变</span><br><span class="line">        cv2.THRESH_TOZERO       小于阈值的像素置<span class="number">0</span>，大于阈值的不变</span><br><span class="line">            大于阈值部分不变，小于的全变为<span class="number">0</span></span><br><span class="line">        cv2.THRESH_TOZERO_INV   小于阈值的不变，大于阈值的像素置<span class="number">0</span></span><br><span class="line">            大于阈值变为<span class="number">0</span>   ，小于阈值的不变</span><br><span class="line">返回两个值</span><br><span class="line">    ret:阈值</span><br><span class="line">    img：阈值化处理后的图像</span><br><span class="line"></span><br><span class="line">cv2.adaptiveThreshold() 自适应阈值处理，图像不同部位采用不同的阈值进行处理</span><br><span class="line">参数：</span><br><span class="line">    img: 图像对象，<span class="number">8</span>-bit单通道图</span><br><span class="line">    maxValue:最大值</span><br><span class="line">    adaptiveMethod: 自适应方法</span><br><span class="line">        cv2.ADAPTIVE_THRESH_MEAN_C     ：阈值为周围像素的平均值</span><br><span class="line">        cv2.ADAPTIVE_THRESH_GAUSSIAN_C : 阈值为周围像素的高斯均值（按权重）</span><br><span class="line">    threshType:</span><br><span class="line">        cv2.THRESH_BINARY:     小于阈值的像素置为<span class="number">0</span>，大于阈值的置为maxValuel</span><br><span class="line">        cv2.THRESH_BINARY_INV:  小于阈值的像素置为maxValue，大于阈值的置为<span class="number">0</span></span><br><span class="line">    blocksize: 计算阈值时，自适应的窗口大小,必须为奇数 （如<span class="number">3</span>：表示附近<span class="number">3</span>个像素范围内的像素点，进行计算阈值）</span><br><span class="line">    C： 常数值，通过自适应方法计算的值，减去该常数值</span><br><span class="line">(mean value of the blocksize*blocksize neighborhood of (x, y) minus C)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-9-图像平滑-去掉噪音点"><a href="#0-9-图像平滑-去掉噪音点" class="headerlink" title="0.9 图像平滑-去掉噪音点"></a>0.9 图像平滑-去掉噪音点</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">'./img/1.jpg'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv_show</span><span class="params">(name,img)</span>:</span></span><br><span class="line">    cv2.namedWindow(name,<span class="number">0</span>)</span><br><span class="line">    cv2.imshow(name,img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyALLWindows()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 均值滤波</span></span><br><span class="line"><span class="comment"># 简单的平均卷积操作 # (3,3)卷积盒</span></span><br><span class="line">blur = cv2.blur(img,(<span class="number">3</span>,<span class="number">3</span>))  <span class="comment"># （奇数，奇数） 中心的值根据周围数改变</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方框滤波</span></span><br><span class="line"><span class="comment"># 与均值滤波相似   normalize 是否做归一化，true与均值一样</span></span><br><span class="line"><span class="comment">#                                       false 会越界&gt;255 ，所有越界值全为255</span></span><br><span class="line">box = cv2.boxFilter(img,<span class="number">-1</span>,(<span class="number">3</span>,<span class="number">3</span>),normalize =<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 高斯滤波</span></span><br><span class="line"><span class="comment"># 高斯模糊---正态分布，离中心值越远，值越小</span></span><br><span class="line">aussian = cv2.GaussianBlur(img,(<span class="number">5</span>,<span class="number">5</span>),<span class="number">1</span>)     <span class="comment"># (5,5)的盒</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中值滤波</span></span><br><span class="line"><span class="comment"># 中间的值</span></span><br><span class="line">median = cv2.medianBlur(img,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展示所有的</span></span><br><span class="line"><span class="comment"># 三张图片拼接在一起</span></span><br><span class="line">res = np.hstack((blur,aussian,median))</span><br><span class="line">resv = np.vstack((blur,aussian,median))</span><br><span class="line"></span><br><span class="line">cv_show(<span class="string">'res'</span>,res)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-10-形态学-腐蚀操作-去掉毛刺"><a href="#0-10-形态学-腐蚀操作-去掉毛刺" class="headerlink" title="0.10 形态学-腐蚀操作-去掉毛刺"></a>0.10 形态学-腐蚀操作-去掉毛刺</h2><p>边界里的盒子如果有 0 有 255，则全变为 0</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 去毛刺，r通道</span></span><br><span class="line">kernel = np.ones((<span class="number">5</span>,<span class="number">5</span>),np.uint8)    <span class="comment"># （5，5）腐蚀大小</span></span><br><span class="line">erosion = cv2.erode(img,kernel,iterations = <span class="number">2</span>)  <span class="comment"># iterations 做几次腐蚀</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-11-形态学-膨胀操作"><a href="#0-11-形态学-膨胀操作" class="headerlink" title="0.11 形态学-膨胀操作"></a>0.11 形态学-膨胀操作</h2><p><em>腐蚀后图像太细，使用膨胀</em><br>边界里的盒子如果有 0 有 255，则全变为 255 白</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kernel = np.ones((<span class="number">3</span>,<span class="number">3</span>),np.uint8)</span><br><span class="line">dilate = cv2.dilate(erosion,kernel,iterations=<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-12-开运算与闭运算"><a href="#0-12-开运算与闭运算" class="headerlink" title="0.12 开运算与闭运算"></a>0.12 开运算与闭运算</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开运算--先腐蚀后膨胀</span></span><br><span class="line">kernel = np.ones((<span class="number">5</span>,<span class="number">5</span>),np.uint8)</span><br><span class="line">opening = cv2.morphologyEx(img,cv2.MORPH_OPEN,KERNEL)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 闭运算--先膨胀后腐蚀</span></span><br><span class="line">kernel = np.ones((<span class="number">5</span>,<span class="number">5</span>),np.uint8)</span><br><span class="line">closing = cv2.morphologyEx(img,cv2.MORPH_CLOSE,kernel)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-13-梯度运算"><a href="#0-13-梯度运算" class="headerlink" title="0.13 梯度运算"></a>0.13 梯度运算</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 梯度运算 = 膨胀-腐蚀 = 轮廓</span></span><br><span class="line">kernel = np.ones((<span class="number">7</span>,<span class="number">7</span>),np.uint8)</span><br><span class="line">gradient = cv2.morphologyEx(img,cv2.MORPH_GRADIENT,kernel)  <span class="comment"># 轮廓</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-14-礼帽-黑帽"><a href="#0-14-礼帽-黑帽" class="headerlink" title="0.14 礼帽 黑帽"></a>0.14 礼帽 黑帽</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 礼帽 = 原始输入 - 开运算 = 毛刺</span></span><br><span class="line">tophat = cv2.morphologyEx(img,cv2.MORPH_TOPHAT,kernel)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 黑帽 = 闭运算 - 原始输入 = 毛刺+更胖整体 - 毛刺</span></span><br><span class="line">blackhat = cv2.morphologyEx(img,cv2.MORPH_BLACKHAT,kernel)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-15-图像梯度-Sobel-算子"><a href="#0-15-图像梯度-Sobel-算子" class="headerlink" title="0.15 图像梯度-Sobel 算子"></a>0.15 图像梯度-Sobel 算子</h2><p><img src="/img/opencv/1.jpg" alt="sobel"><br>梯度：边缘位置的像素数值不同，数值差越大，梯度越大<br>边缘检测，物体分辨<br>右减左，下减上   从右到左，从下至上</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dst = cv2.Sobel(img,ddepth,dx,dy,ksize)</span></span><br><span class="line"><span class="comment"># ddepth:图像深度 -1</span></span><br><span class="line"><span class="comment"># dx dy：水平，竖直 1 0</span></span><br><span class="line"><span class="comment"># ksize：盒的大小</span></span><br><span class="line"></span><br><span class="line">sobelx = cv2.Sobel(img,cv2.CV_64F,<span class="number">1</span>,<span class="number">0</span>,ksize = <span class="number">3</span>)</span><br><span class="line"><span class="comment"># cv2.CV_64F 负数形式</span></span><br><span class="line"><span class="comment"># 白-黑是正数，黑-白是负数，所有负数会被截断为0，所以要取绝对值</span></span><br><span class="line"></span><br><span class="line">sobelx = cv2.convertScaleAbs(sobelx)</span><br><span class="line"><span class="comment"># 取绝对值</span></span><br><span class="line"></span><br><span class="line">sobely = cv2.Sobel(img,cv2.CV_64F,<span class="number">0</span>,<span class="number">1</span>,ksize = <span class="number">3</span>)</span><br><span class="line"><span class="comment"># y方向</span></span><br><span class="line">sobely = cv2.convertScaleAbs(sobely)</span><br><span class="line"></span><br><span class="line"><span class="comment"># x,y分别求出，再求和</span></span><br><span class="line">sobelxy = cv2.addWeighted(sobelx,<span class="number">0.5</span>,sobely,<span class="number">0.5</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不建议直接计算，及dx，dy都为 1</span></span><br><span class="line"><span class="comment"># 轮廓会更加的虚</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-16-图像梯度-Scharr-amp-amp-Laplacian-算子"><a href="#0-16-图像梯度-Scharr-amp-amp-Laplacian-算子" class="headerlink" title="0.16 图像梯度 Scharr&amp;&amp;Laplacian 算子"></a>0.16 图像梯度 Scharr&amp;&amp;Laplacian 算子</h2><p>scharr – 更敏感 – 描绘轮廓更细致<br><img src="/img/opencv/2.jpg" alt="sobel"></p>
<p>laplacian – 二阶导 – 更更敏感，对噪音点敏感，很少单独使用<br><img src="/img/opencv/3.png" alt="sobel"></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scharrx = cv2.Scharr(img,cv2.CV_64F,1,0)</span><br><span class="line">scharry = cv2.Scharr(img,cv2.CV_64F,0,1)</span><br><span class="line">scharrx = cv2.convertScaleAbs(scharrx)</span><br><span class="line">scharry = cv2.convertScaleAbs(scharry)</span><br><span class="line">scharrxy = cv2.addWeighted(scharrx,0.5,scharry,0.5,0)</span><br><span class="line"></span><br><span class="line">laplacian = cv2.Laplacian(img,cv2.CV_64F)</span><br><span class="line">laplacian = cv2.convertScaleAbs(laplacian)</span><br><span class="line"></span><br><span class="line">res = np.hstack((scharrxy,laplacian))</span><br></pre></td></tr></tbody></table></figure>

<p>三种算子区别<br><img src="/img/opencv/123%E5%8C%BA%E5%88%AB.png" alt="三种算子区别"></p>
<h2 id="0-17-Canny-边缘检测–综合"><a href="#0-17-Canny-边缘检测–综合" class="headerlink" title="0.17 Canny 边缘检测–综合"></a>0.17 Canny 边缘检测–综合</h2><ul>
<li>高斯滤波器，平滑处理，滤除噪声</li>
<li>计算图像中每个像素点的梯度强度和方向</li>
<li>应用非极大值抑制，消除小的不明显的地方<br>a 检测出目标可能性 90%，b 是 80%，则会抑制掉 b，把 b 丢掉</li>
<li>应用双阈值，检测来确定真实的和潜在的边缘</li>
<li>通过抑制孤立的弱边缘最终完成边缘检测</li>
</ul>
<p>① 高斯滤波器<br>归一化平滑处理<br>② 梯度和方向，Sobel 算子<br>③ 非极大值抑制<br>a. 线性插值法<br>b. 简便算法;八个方向分别比较<br>④ 双阈值检测<br>maxVal|minVal<br>梯度值&gt;maxVal 边界<br>minVal &lt; 梯度 &lt; maxVal 连有边界，保留，否则舍弃<br>梯度 &lt; minVal 舍弃<br>⑤ 最终结果<br>canny 函数</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">img = cv2.imread(<span class="string">'1.jpg'</span>,cv2.IMREAD_GRAYSCALE)</span><br><span class="line"></span><br><span class="line">v1 = cv2.Canny(img,<span class="number">80</span>,<span class="number">150</span>)  <span class="comment"># minVal,maxVal</span></span><br><span class="line">v2 = cv2.Canny(img,<span class="number">50</span>,<span class="number">150</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-18-图像金字塔"><a href="#0-18-图像金字塔" class="headerlink" title="0.18 图像金字塔"></a>0.18 图像金字塔</h2><p>越往上走图像越小<br>图像 800*800 变为 400*400<br>各层分别提取</p>
<ul>
<li>高斯金字塔（高斯滤波）</li>
</ul>
<ol>
<li>向下采样，缩小，往金字塔顶走<br>将偶数行和列去掉，1234 去掉 24，行列变为原来的一半<br>4*4 — 2*2</li>
<li>向上采样，放大<br>将数据高斯分布给周边新加列行<br>2*2 — 4*4</li>
</ol>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">img = cv2.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line"><span class="comment"># 向上</span></span><br><span class="line">up = cv2.pyrUp(img)</span><br><span class="line"><span class="comment"># 向下</span></span><br><span class="line">down = cv2.pyrDown(img)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先上 再下，，会变模糊</span></span><br><span class="line">down_up = cv2.pyrDown(up)</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/img/opencv/%E6%8B%89%E6%99%AE%E6%8B%89%E6%96%AF.png" alt="拉普拉斯金字塔"></p>
<ul>
<li>拉普拉斯金字塔<br>原始 - 先 down 再 up = result<br>result - down up = reslt1</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">down = cv2.pyrDown(img)</span><br><span class="line">down_up = cv2.pyrUp(down)</span><br><span class="line">result = img - down_up</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-19-图像轮廓"><a href="#0-19-图像轮廓" class="headerlink" title="0.19 图像轮廓"></a>0.19 图像轮廓</h2><p>图像边缘–零散<br>图像轮廓–完整<br>cv2.findContours(img,mode,method)</p>
<ul>
<li>mode:轮廓检测模式<br>RETR_EXTERNAL 只检测外轮廓<br>RETR_LIST 检索所有的轮廓，将其保存到一条链表中<br>RETR_CCOMP 检索所有轮廓，并将他们组织为两层，顶层是各部分的外部边界，第二层空洞边界<br>RETR_TREE（常用）检测所有轮廓，并重构嵌套轮廓的整个层次</li>
<li>method:轮廓逼近方法<br>CHAIN_APPROX_NONE：以 freeman 链码方式输出轮廓，其他方法输出多边形<br>CHAIN_APPROX_SIMPLE：压缩水平，垂直，斜的部分</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">img = cv2.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line">gray = cv2.cvColor(img,cv2.COLOR_BGR2GRAY)</span><br><span class="line"><span class="comment"># 使用二值图像---更好的边缘检测</span></span><br><span class="line">ret, thresh = cv2.threshold(gray,<span class="number">122</span>,<span class="number">255</span>,cv2.THRESH_BINARY)</span><br><span class="line"><span class="comment"># cv2.imshow('result',thresh)</span></span><br><span class="line"></span><br><span class="line">binary,contours,hierarchy = cv2.findContours(thresh,cv2.RETR_TREE,cv2.CHAIN_APPROX_NONE)</span><br><span class="line"><span class="comment"># binary 二值图像</span></span><br><span class="line"><span class="comment"># contours 轮廓信息</span></span><br><span class="line"><span class="comment"># hierarchy 层级</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制轮廓,必须先备份</span></span><br><span class="line">draw_img = img.copy()</span><br><span class="line">res = cv2.drawContours(draw_img,contours,<span class="number">-1</span>,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">2</span>)</span><br><span class="line"><span class="comment"># draw_img 原图像上绘制</span></span><br><span class="line"><span class="comment"># contours 轮廓信息</span></span><br><span class="line"><span class="comment"># -1 所有轮廓，（几个轮廓） 0 第一个轮廓外圈，1 轮廓里圈</span></span><br><span class="line"><span class="comment"># (0,0,255) BGR 红色的线</span></span><br><span class="line"><span class="comment"># 2 线条宽度--不能太大，能看出轮廓内外层差异</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 轮廓得到以后,具体轮廓拿出来，contours为list</span></span><br><span class="line">cnt = contours[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算面积</span></span><br><span class="line">cv2.contourArea(cnt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 周长 true 闭合</span></span><br><span class="line">cu2.arcLength(cnt,<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>轮廓近似</strong></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 轮廓近似，将轮廓变得规则起来</span></span><br><span class="line"><span class="comment"># 用直线近似曲线,曲线上找一点，到直线的距离最大，</span></span><br><span class="line"><span class="comment"># d&lt;T 可以近似     d&gt;T,不可以直接用一条直线近似，而是分割开来，继续判断</span></span><br><span class="line">img = cv2.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line">gray = cv2.cvColor(img,cv2.COLOR_BGR2GRAY)</span><br><span class="line">ret, thresh = cv2.threshold(gray,<span class="number">122</span>,<span class="number">255</span>,cv2.THRESH_BINARY)</span><br><span class="line">binary,contours,hierarchy = cv2.findContours(thresh,cv2.RETR_TREE,cv2.CHAIN_APPROX_NONE)</span><br><span class="line">cnt = contours[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">draw_img = img.copy()</span><br><span class="line">res = cv2.drawContours(draw_img,[cnt],<span class="number">-1</span>,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">epsilon = <span class="number">0.1</span>*cv2.arcLength(cnt,<span class="literal">True</span>)   <span class="comment"># 周长百分比做阈值</span></span><br><span class="line"><span class="comment"># 0.1百分比，越大，轮廓变化越大</span></span><br><span class="line">approx = cv2.approxPolyDP(cnt,epsilon,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">draw_img = img.copy()</span><br><span class="line">res = cv2.drawContours(draw_img,[approx],<span class="number">-1</span>,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>边界矩形(外接矩形)</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cnt = contours[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 外接矩形</span></span><br><span class="line">x,y,w,h = cv2.boundingRect(cnt)</span><br><span class="line">img = cv2.rectangle(img,(x,y),(x+w,y+h),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 矩形面积</span></span><br><span class="line">area = cv2.contourArea(cnt)</span><br><span class="line">x,y,w,h = cv2.boundingRect(cnt)</span><br><span class="line">rect_area = w*h</span><br><span class="line">extent = float(area) / rect_area</span><br><span class="line">print(<span class="string">f'轮廓面积与边界矩形比:<span class="subst">{extent}</span>'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>外接圆</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(x,y).radius = cv2.minEnclosingCircle(cnt)</span><br><span class="line">center = (int(x),int(y))</span><br><span class="line">radius = int(radius)</span><br><span class="line">img = cv2.circle(img,center,radius,(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>),<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-20-模板匹配—-匹配对象在另一个图像哪里"><a href="#0-20-模板匹配—-匹配对象在另一个图像哪里" class="headerlink" title="0.20 模板匹配—-匹配对象在另一个图像哪里"></a>0.20 模板匹配—-匹配对象在另一个图像哪里</h2><p>从左到右，从上到下，进行匹配<br>匹配计算方法</p>
<ul>
<li>TM_SQDIFF—-平方项匹配，值越小，越相关</li>
<li>TM_CCORR—–计算相关性，值越大，越相关</li>
<li>TM_CCOEFF—-计算相关系数，值越大，越相关</li>
<li>TM_SQDIFF_NORMED:计算归一化平方不同，越接近 0，越相关</li>
<li>TM_CCORR_NORMED:计算归一化相关性，越接近 1，越相关</li>
<li>TM_CCOEFF_NORMED:计算归一化的相关系数，越接近 1，越相关</li>
<li>最好用归一化的方法<br>返回结果<br>匹配的地方大小：<br>原图结果 A*B,模板大小 a*b,返回结果矩阵：(A-a+1)*(B-b+1)</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">img = cv2.imread(<span class="string">'1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># (263,263)</span></span><br><span class="line">template = cv2.imread(<span class="string">'11.jpg'</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># (110,85)</span></span><br><span class="line">h,w = template.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">res = cv2.matchTemplate(img,template,cv2.TM_SQDIFE)</span><br><span class="line"><span class="comment"># (154,179)</span></span><br><span class="line"></span><br><span class="line">min_val,max_val,min_loc,max_loc = cv2.minMaxLoc(res)</span><br><span class="line"><span class="comment"># 最小值，最大值，最小值位置，最大值位置</span></span><br><span class="line"><span class="comment"># 该方法关注最小值位置 框左上角的点，根据res.shape画出图像</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># top_left &amp; res.shape得到最好匹配结果</span></span><br><span class="line">top_left = min_loc</span><br><span class="line">bottom_right = (top_left[<span class="number">0</span>] + w,top_left[<span class="number">1</span>] + h)</span><br><span class="line">img2 = img.copy()</span><br><span class="line">cv2.rectangle(img2,top_left,bottom_right,<span class="number">255</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 展示出来</span></span><br><span class="line">cv_show(<span class="string">'res'</span>,img2)</span><br></pre></td></tr></tbody></table></figure>

<p>匹配多个对象</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 匹配多个对象</span></span><br><span class="line">img_rgb = cv2.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line">img_gray = cv2.cvtColor(img_rgb,cv2.COLOR_BGR2GRAY)</span><br><span class="line">template = cv2.imread(<span class="string">'11.jpg'</span>,<span class="number">0</span>)</span><br><span class="line">h,w = template.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">res = cv2.matchTemplate(img_gray,template,cv2.TM_CCOEFF_NORMED)</span><br><span class="line">threshold = <span class="number">0.8</span></span><br><span class="line"><span class="comment"># 取匹配程度大于0.8的坐标</span></span><br><span class="line">loc = np.where(res&gt;= threshold)</span><br><span class="line"><span class="keyword">for</span> pt <span class="keyword">in</span> zip(*loc[::<span class="number">1</span>]):   <span class="comment"># * 表示可选参数</span></span><br><span class="line">    bottom_right = (pt[<span class="number">0</span>]+w,pt[<span class="number">1</span>]+h)</span><br><span class="line">    cv2.rectangle(img_rgb,pt,bootom_right,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),<span class="number">2</span>)</span><br><span class="line">cv2.imshow(<span class="string">'img'</span>,img_rgb)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-21-直方图"><a href="#0-21-直方图" class="headerlink" title="0.21 直方图"></a>0.21 直方图</h2><p>图片像素的统计直方图<br>cv2.calcHist(img,channels,mask,histSize,ranges)<br>img – 图片<br>channels–通道 0 – 自动灰度图 ‘b’ ‘g’ ‘r’<br>mask–淹模图像，掩码，统计某一部分<br>创建掩码<br>mask = np.zeros(img,shape[:2],np.uint8)<br>选择掩码保存部分<br>mask[100:300,100:400] = 255 白色保存部分 # masked_img = cv2.bitwise_and(img,img,mask=mask)<br>hisSize – BIN 的数目，直方图范围<br>ranges – 像素值取值反围</p>
<p><code>hist = cv2.calcHist([img],[0],None,[256],[0,256])</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">img =cv2.imread(<span class="string">'1.jpg'</span>)</span><br><span class="line">hist = cv2.calcHist([img],[<span class="number">0</span>],<span class="literal">None</span>,[<span class="number">256</span>],[<span class="number">0</span>,<span class="number">256</span>])</span><br><span class="line"><span class="comment"># 画出直方图</span></span><br><span class="line">plt.hist(img,ravel(),<span class="number">256</span>):</span><br><span class="line">plt.show</span><br></pre></td></tr></tbody></table></figure>

<p>直方图均衡化</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果统计出来的直方图 不太平均</span></span><br><span class="line"><span class="comment"># 平均化</span></span><br><span class="line">equ = cv2.equalizeHist(img)</span><br><span class="line">plt.hist(equ,ravel(),<span class="number">256</span>)</span><br><span class="line">plt.show</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果更加的明显</span></span><br><span class="line"><span class="comment"># 一个部分分给其他部分，进行均衡</span></span><br><span class="line"><span class="comment"># 分模块进行均衡化</span></span><br><span class="line"><span class="comment"># 但有的图会出现边界</span></span><br></pre></td></tr></tbody></table></figure>

<p>自适应直方图均衡化</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">clahe = cv2.createCLAHE(clipLimit = <span class="number">2.0</span>,tileGridSize = (<span class="number">8</span>，<span class="number">8</span>))</span><br><span class="line">res_clahe = clahe.apply(img)</span><br><span class="line">cv2.imshow(<span class="string">'result'</span>,res_clahe)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-22-傅里叶变换"><a href="#0-22-傅里叶变换" class="headerlink" title="0.22 傅里叶变换"></a>0.22 傅里叶变换</h2><p>现实中的事物都是运动的<br>而傅里叶的频域中一切都是静止的，现实中的东西在频域中分为高频，低频</p>
<ul>
<li>高频：变化剧烈的灰度分量，eg：边界</li>
<li>低频：变化缓慢的灰度变量，eg：一片大海<br><img src="/img/opencv/%E5%82%85%E9%87%8C%E5%8F%B6.png" alt="傅里叶"><br>滤波<br>低通滤波器：只保留低频，图像变得模糊<br>高通滤波器：只保留高频，图像细节增强</li>
</ul>
<p>在 频域中处理，更加方便</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cv2.dft()</span><br><span class="line"><span class="comment"># 逆变换</span></span><br><span class="line">cv2.idft()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">'1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 输入图像必须先转换成float32格式</span></span><br><span class="line">img_float32 = np.float32(img)</span><br><span class="line"><span class="comment"># 得到的结果中 频率为0的部分在左上角，通常要转换到中心位置，用shift变换</span></span><br><span class="line">dft = cv2.dft(img_float32,flags = cv2.DFT_COMPLEX_OUTPUT)</span><br><span class="line">dft_shift = np.fft.fftshift(dft)</span><br><span class="line"><span class="comment"># cv2.dft()返回结果是双通道的，通常还要转换为图像格式</span></span><br><span class="line">magnitude_spectrum = <span class="number">20</span>*np.log(cv2.magnitude(dft_shift[:,:,<span class="number">0</span>],dft_shift[:,:,<span class="number">1</span>]))</span><br></pre></td></tr></tbody></table></figure>

<p>低通：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv_show</span><span class="params">(name,img)</span>:</span></span><br><span class="line">    cv2.namedWindow(name,<span class="number">0</span>)</span><br><span class="line">    cv2.imshow(name,img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">'./img/clock1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 输入图像必须先转换成float32格式</span></span><br><span class="line">img_float32 = np.float32(img)</span><br><span class="line"><span class="comment"># 得到的结果中 频率为0的部分在左上角，通常要转换到中心位置，用shift变换</span></span><br><span class="line">dft = cv2.dft(img_float32,flags = cv2.DFT_COMPLEX_OUTPUT)</span><br><span class="line">dft_shift = np.fft.fftshift(dft)</span><br><span class="line"><span class="comment"># cv2.dft()返回结果是双通道的，通常还要转换为图像格式</span></span><br><span class="line"><span class="comment"># magnitude_spectrum = 20*np.log(cv2.magnitude(dft_shift[:,:,0],dft_shift[:,:,1]))</span></span><br><span class="line"></span><br><span class="line">rows,cols = img.shape</span><br><span class="line">crow,ccol = int(rows/<span class="number">2</span>) , int(cols/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要magn里面</span></span><br><span class="line"><span class="comment"># 创建一个掩码  zeros 全为0 全不要</span></span><br><span class="line">mask = np.zeros((rows,cols,<span class="number">2</span>),np.uint8)</span><br><span class="line">mask[crow<span class="number">-30</span>:crow+<span class="number">30</span>,ccol<span class="number">-30</span>:ccol+<span class="number">30</span>] = <span class="number">1</span>   <span class="comment"># 中间为低频，低频要</span></span><br><span class="line">fshift = dft_shift*mask</span><br><span class="line"><span class="comment"># shift 回去</span></span><br><span class="line">f_ishift = np.fft.ifftshift(fshift)</span><br><span class="line"></span><br><span class="line">img_back = cv2.idft(f_ishift)</span><br><span class="line">img_back = cv2.magnitude(img_back[:,:,<span class="number">0</span>],img_back[:,:,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">121</span>), plt.imshow(img,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'input image'</span>), plt.xticks([]),plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>), plt.imshow(img_back, cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'magnitude spectrum'</span>), plt.xticks([]),plt.yticks([])</span><br><span class="line">plt.show()</span><br><span class="line">图像模糊</span><br></pre></td></tr></tbody></table></figure>

<p>高通</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cv_show</span><span class="params">(name,img)</span>:</span></span><br><span class="line">    cv2.namedWindow(name,<span class="number">0</span>)</span><br><span class="line">    cv2.imshow(name,img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">'./img/clock1.jpg'</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 输入图像必须先转换成float32格式</span></span><br><span class="line">img_float32 = np.float32(img)</span><br><span class="line"><span class="comment"># 得到的结果中 频率为0的部分在左上角，通常要转换到中心位置，用shift变换</span></span><br><span class="line">dft = cv2.dft(img_float32,flags = cv2.DFT_COMPLEX_OUTPUT)</span><br><span class="line">dft_shift = np.fft.fftshift(dft)</span><br><span class="line"><span class="comment"># cv2.dft()返回结果是双通道的，通常还要转换为图像格式</span></span><br><span class="line"><span class="comment"># magnitude_spectrum = 20*np.log(cv2.magnitude(dft_shift[:,:,0],dft_shift[:,:,1]))</span></span><br><span class="line"></span><br><span class="line">rows,cols = img.shape</span><br><span class="line">crow,ccol = int(rows/<span class="number">2</span>) , int(cols/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全为1 全要</span></span><br><span class="line">mask = np.ones((rows,cols,<span class="number">2</span>),np.uint8)</span><br><span class="line">mask[crow<span class="number">-30</span>:crow+<span class="number">30</span>,ccol<span class="number">-30</span>:ccol+<span class="number">30</span>] = <span class="number">0</span>   <span class="comment"># 中间为0，中间不要，即低频不要</span></span><br><span class="line">fshift = dft_shift*mask</span><br><span class="line"><span class="comment"># shift 回去</span></span><br><span class="line">f_ishift = np.fft.ifftshift(fshift)</span><br><span class="line"></span><br><span class="line">img_back = cv2.idft(f_ishift)</span><br><span class="line">img_back = cv2.magnitude(img_back[:,:,<span class="number">0</span>],img_back[:,:,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展示</span></span><br><span class="line">plt.subplot(<span class="number">121</span>), plt.imshow(img,cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'input image'</span>), plt.xticks([]),plt.yticks([])</span><br><span class="line">plt.subplot(<span class="number">122</span>), plt.imshow(img_back, cmap = <span class="string">'gray'</span>)</span><br><span class="line">plt.title(<span class="string">'magnitude spectrum'</span>), plt.xticks([]),plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>

<h2 id="0-23-摄像头获取视频或图片获取感兴趣部分"><a href="#0-23-摄像头获取视频或图片获取感兴趣部分" class="headerlink" title="0.23 摄像头获取视频或图片获取感兴趣部分"></a>0.23 摄像头获取视频或图片获取感兴趣部分</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">video_show</span><span class="params">()</span>:</span></span><br><span class="line">    choose_video = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        ret1,frame = video.read()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ret1:</span><br><span class="line">            print(<span class="string">"视频获取失败！"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        cv2.imshow(<span class="string">"Video_show"</span>,frame)</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) &amp; <span class="number">0xff</span> == ord(<span class="string">"q"</span>):</span><br><span class="line">            <span class="comment"># rects = []</span></span><br><span class="line">            <span class="comment"># fromCenter = False</span></span><br><span class="line">            <span class="comment"># Select multiple rectangles</span></span><br><span class="line">            <span class="comment"># select_data = cv2.selectROI("Image", frame, rects, fromCenter)</span></span><br><span class="line">            select_data = cv2.selectROI(<span class="string">"Video_show"</span>,frame)</span><br><span class="line">            choose_video = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> choose_video :</span><br><span class="line">            <span class="comment">#获取选择框内的图像</span></span><br><span class="line">            choose_data = frame[select_data[<span class="number">1</span>]:select_data[<span class="number">1</span>]+select_data[<span class="number">3</span>],select_data[<span class="number">0</span>]:select_data[<span class="number">0</span>]+select_data[<span class="number">2</span>]]</span><br><span class="line">            cv2.imshow(<span class="string">"choose_video"</span>,choose_data)</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) &amp; <span class="number">0xff</span> == ord(<span class="string">"p"</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    video.release()</span><br><span class="line">    <span class="comment"># cv2.destroyAllWindows()</span></span><br><span class="line">    <span class="keyword">return</span> choose_data</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    video = cv2.VideoCapture(<span class="number">0</span>)</span><br><span class="line">    video_show()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="0-23-1-选取-roi-区域定义"><a href="#0-23-1-选取-roi-区域定义" class="headerlink" title="0.23.1 选取 roi 区域定义"></a>0.23.1 选取 roi 区域定义</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1：使用表示矩形区域的Rect，参数有矩形左上角坐标、矩形的长和宽</span></span><br><span class="line"><span class="comment"># Mat imageROI;</span></span><br><span class="line">imageROI = image(Rect(<span class="number">500</span>,<span class="number">250</span>,logo.cols,logo.rows));</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2：指定感兴趣的行或列的范围（Range），Range是指从起始索引到终止索引（不包括终止索引）的一段连续序列</span></span><br><span class="line"><span class="comment"># Mat imageROI;</span></span><br><span class="line">imageROI = image(Range(<span class="number">250</span>,<span class="number">250</span>+logoImage.rows),Range(<span class="number">200</span>,<span class="number">200</span>+logoImage.cols));</span><br></pre></td></tr></tbody></table></figure>

<h1 id="1-图像识别相关"><a href="#1-图像识别相关" class="headerlink" title="1. 图像识别相关"></a>1. 图像识别相关</h1><h2 id="1-1-两张图片对比"><a href="#1-1-两张图片对比" class="headerlink" title="1.1 两张图片对比"></a>1.1 两张图片对比</h2><p><strong>返回一张对比后的图片</strong></p>
<p>轮子安装<br><code>pip install pillow</code><br><code>pip install PIL</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageChops</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compare_images</span><span class="params">(path_one, path_two, diff_save_location)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    比较图片，如果有不同则生成展示不同的图片</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @参数一: path_one: 第一张图片的路径</span></span><br><span class="line"><span class="string">    @参数二: path_two: 第二张图片的路径</span></span><br><span class="line"><span class="string">    @参数三: diff_save_location: 不同图的保存路径</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    image_one = Image.open(path_one)</span><br><span class="line">    image_two = Image.open(path_two)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        diff = ImageChops.difference(image_one, image_two)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> diff.getbbox() <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 图片间没有任何不同则直接退出</span></span><br><span class="line">            print(<span class="string">"【+】We are the same!"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            diff.save(diff_save_location)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        text = (<span class="string">"表示图片大小和box对应的宽度不一致，参考API说明：Pastes another image into this image."</span></span><br><span class="line">                <span class="string">"The box argument is either a 2-tuple giving the upper left corner, a 4-tuple defining the left, upper, "</span></span><br><span class="line">                <span class="string">"right, and lower pixel coordinate, or None (same as (0, 0)). If a 4-tuple is given, the size of the pasted "</span></span><br><span class="line">                <span class="string">"image must match the size of the region.使用2纬的box避免上述问题"</span>)</span><br><span class="line">        print(<span class="string">"【{0}】{1}"</span>.format(e, text))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    name1 = <span class="string">'./对比图片/'</span> + input(<span class="string">'输入要对比的图片名字---带后缀格式----：'</span>)</span><br><span class="line">    name2 = <span class="string">'./对比图片/'</span> + input(<span class="string">'第二张图片的名字：'</span>)</span><br><span class="line">    name = <span class="string">'对比结果'</span> + input(<span class="string">'你的对比结果后缀是什么：'</span>)</span><br><span class="line">    compare_images(name1, name2, name)</span><br><span class="line">    print(<span class="string">'-------已完成-------'</span>)</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p><a href="https://www.cnblogs.com/botoo/p/8416315.html" target="_blank" rel="noopener">参考教程</a></p>
</blockquote>
<h1 id="2-根据数据生成表格，图线"><a href="#2-根据数据生成表格，图线" class="headerlink" title="2. 根据数据生成表格，图线"></a>2. 根据数据生成表格，图线</h1><p><strong><a href="https://yq010105.github.io/2020/02/22/python-openpyxl/">openpyxl</a> and <a href="https://yq010105.github.io/2020/02/22/python-plotly/">plotly</a> or <a href="https://yq010105.github.io/2020/02/21/python-plt/">plt</a></strong></p>
<h1 id="3-慢慢学-opencv"><a href="#3-慢慢学-opencv" class="headerlink" title="3. 慢慢学 opencv"></a>3. 慢慢学 opencv</h1><p><a href="https://www.cnblogs.com/silence-cho/p/10926248.html" target="_blank" rel="noopener">先行教程</a></p>
<h2 id="3-1-在新窗口打开图片，保存图片，基操"><a href="#3-1-在新窗口打开图片，保存图片，基操" class="headerlink" title="3.1 在新窗口打开图片，保存图片，基操"></a>3.1 在新窗口打开图片，保存图片，基操</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line">img_path = <span class="string">'./img/'</span> + input(<span class="string">'输入图像路径：--带后缀--'</span>)</span><br><span class="line"><span class="comment"># 读取图片</span></span><br><span class="line">h = cv2.imread(img_path,cv2.IMREAD_GRAYSCALE)</span><br><span class="line"><span class="comment"># 创建一个窗口</span></span><br><span class="line">cv2.namedWindow(<span class="string">'printwindow'</span>)</span><br><span class="line">cv2.namedWindow(<span class="string">'window'</span>,<span class="number">0</span>)    <span class="comment"># 0 自由改变窗口大小</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 改变图片颜色</span></span><br><span class="line">imgviewx = cv2.cvtColor(imgviewx,cv2.COLOR_BGR2GRAY)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示图片，（窗口名，读入的图像）</span></span><br><span class="line">cv2.imshow(<span class="string">'printwindow'</span>,h)</span><br><span class="line"><span class="comment"># 窗口等待任意键盘按键输入，0为一直等待</span></span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 保存图片</span></span><br><span class="line">cv2.imwrite(<span class="string">'./img/result.jpg'</span>,imgviewx)</span><br><span class="line"><span class="comment"># 销毁窗口</span></span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-2-图像阈值化"><a href="#3-2-图像阈值化" class="headerlink" title="3.2 图像阈值化"></a>3.2 图像阈值化</h2><p><strong>参数说明：</strong></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">cv2.threshold():</span><br><span class="line">参数：</span><br><span class="line">    img:图像对象，必须是灰度图</span><br><span class="line">    thresh:阈值</span><br><span class="line">    maxval：最大值</span><br><span class="line">    type:</span><br><span class="line">        cv2.THRESH_BINARY:     小于阈值的像素置为<span class="number">0</span>，大于阈值的置为maxval</span><br><span class="line">        cv2.THRESH_BINARY_INV： 小于阈值的像素置为maxval，大于阈值的置为<span class="number">0</span></span><br><span class="line">        cv2.THRESH_TRUNC：      小于阈值的像素不变，大于阈值的置为thresh</span><br><span class="line">        cv2.THRESH_TOZERO       小于阈值的像素置<span class="number">0</span>，大于阈值的不变</span><br><span class="line">        cv2.THRESH_TOZERO_INV   小于阈值的不变，大于阈值的像素置<span class="number">0</span></span><br><span class="line">返回两个值</span><br><span class="line">    ret:阈值</span><br><span class="line">    img：阈值化处理后的图像</span><br><span class="line"></span><br><span class="line">cv2.adaptiveThreshold() 自适应阈值处理，图像不同部位采用不同的阈值进行处理</span><br><span class="line">参数：</span><br><span class="line">    img: 图像对象，<span class="number">8</span>-bit单通道图</span><br><span class="line">    maxValue:最大值</span><br><span class="line">    adaptiveMethod: 自适应方法</span><br><span class="line">        cv2.ADAPTIVE_THRESH_MEAN_C     ：阈值为周围像素的平均值</span><br><span class="line">        cv2.ADAPTIVE_THRESH_GAUSSIAN_C : 阈值为周围像素的高斯均值（按权重）</span><br><span class="line">    threshType:</span><br><span class="line">        cv2.THRESH_BINARY:     小于阈值的像素置为<span class="number">0</span>，大于阈值的置为maxValuel</span><br><span class="line">        cv2.THRESH_BINARY_INV:  小于阈值的像素置为maxValue，大于阈值的置为<span class="number">0</span></span><br><span class="line">    blocksize: 计算阈值时，自适应的窗口大小,必须为奇数 （如<span class="number">3</span>：表示附近<span class="number">3</span>个像素范围内的像素点，进行计算阈值）</span><br><span class="line">    C： 常数值，通过自适应方法计算的值，减去该常数值</span><br><span class="line">(mean value of the blocksize*blocksize neighborhood of (x, y) minus C)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>例子</strong></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line">imgpath = <span class="string">'./img/'</span> + input(<span class="string">'输入图像路径'</span>)</span><br><span class="line">imgviewx = cv2.imread(imgpath)</span><br><span class="line"><span class="comment"># 将图像转化为灰度</span></span><br><span class="line">imgviewx = cv2.cvtColor(imgviewx,cv2.COLOR_BGR2GRAY)</span><br><span class="line"><span class="comment"># 边界设置</span></span><br><span class="line">imgresult = cv2.copyMakeBorder(imgviewx,<span class="number">20</span>,<span class="number">20</span>,<span class="number">20</span>,<span class="number">20</span>,cv2.BORDER_DEFAULT)</span><br><span class="line"></span><br><span class="line">ret,threl = cv2.threshold(imgviewx,<span class="number">127</span>,<span class="number">255</span>,cv2.THRESH_BINARY)</span><br><span class="line"></span><br><span class="line">cv2.namedWindow(<span class="string">'window2'</span>,<span class="number">0</span>)</span><br><span class="line">cv2.imshow(<span class="string">'window2'</span>,threl)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">cv2.destroyALLWindows()</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-3-图像形状变化"><a href="#3-3-图像形状变化" class="headerlink" title="3.3 图像形状变化"></a>3.3 图像形状变化</h2><h3 id="3-3-1-cv2-resize-图像缩放"><a href="#3-3-1-cv2-resize-图像缩放" class="headerlink" title="3.3.1 cv2.resize() 图像缩放"></a>3.3.1 cv2.resize() 图像缩放</h3><p>参数</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cv2.resize() 放大和缩小图像</span><br><span class="line">    参数：</span><br><span class="line">        src: 输入图像对象</span><br><span class="line">        dsize：输出矩阵/图像的大小，为<span class="number">0</span>时计算方式如下：dsize = Size(round(fx*src.cols),round(fy*src.rows))</span><br><span class="line">        fx: 水平轴的缩放因子，为<span class="number">0</span>时计算方式：  (double)dsize.width/src.cols</span><br><span class="line">        fy: 垂直轴的缩放因子，为<span class="number">0</span>时计算方式：  (double)dsize.heigh/src.rows</span><br><span class="line">        interpolation：插值算法</span><br><span class="line">            cv2.INTER_NEAREST : 最近邻插值法</span><br><span class="line">            cv2.INTER_LINEAR   默认值，双线性插值法</span><br><span class="line">            cv2.INTER_AREA        基于局部像素的重采样（resampling using pixel area relation）。对于图像抽取（image decimation）来说，这可能是一个更好的方法。但如果是放大图像时，它和最近邻法的效果类似。</span><br><span class="line">            cv2.INTER_CUBIC        基于<span class="number">4</span>x4像素邻域的<span class="number">3</span>次插值法</span><br><span class="line">            cv2.INTER_LANCZOS4     基于<span class="number">8</span>x8像素邻域的Lanczos插值</span><br><span class="line"></span><br><span class="line">    cv2.INTER_AREA 适合于图像缩小， cv2.INTER_CUBIC (slow) &amp; cv2.INTER_LINEAR 适合于图像放大</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 缩小图像为原来的一半</span></span><br><span class="line">img = cv2.imread(<span class="string">'messi5.jpg'</span>)</span><br><span class="line"></span><br><span class="line">res = cv2.resize(img,<span class="literal">None</span>,fx=<span class="number">2</span>, fy=<span class="number">2</span>, interpolation = cv2.INTER_CUBIC)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line"></span><br><span class="line">height, width = img.shape[:<span class="number">2</span>]</span><br><span class="line">res = cv2.resize(img,(<span class="number">2</span>*width, <span class="number">2</span>*height), interpolation = cv2.INTER_CUBIC)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-3-2-仿射变换"><a href="#3-3-2-仿射变换" class="headerlink" title="3.3.2 仿射变换"></a>3.3.2 仿射变换</h3><p>仿射变换（从二维坐标到二维坐标之间的线性变换，且保持二维图形的“平直性”和“平行性”。仿射变换可以通过一系列的原子变换的复合来实现，包括平移，缩放，翻转，旋转和剪切）<br><strong>参数</strong></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cv2.warpAffine()   仿射变换（从二维坐标到二维坐标之间的线性变换，且保持二维图形的“平直性”和“平行性”。仿射变换可以通过一系列的原子变换的复合来实现，包括平移，缩放，翻转，旋转和剪切）</span><br><span class="line">    参数：</span><br><span class="line">        img: 图像对象</span><br><span class="line">        M：<span class="number">2</span>*<span class="number">3</span> transformation matrix (转变矩阵)</span><br><span class="line">        dsize：输出矩阵的大小,注意格式为（cols，rows）  即width对应cols，height对应rows</span><br><span class="line">        flags：可选，插值算法标识符，有默认值INTER_LINEAR，</span><br><span class="line">               如果插值算法为WARP_INVERSE_MAP, warpAffine函数使用如下矩阵进行图像转dst(x,y)=src(M11*x+M12*y+M13,M21*x+M22*y+M23)</span><br><span class="line">        borderMode：可选， 边界像素模式，有默认值BORDER_CONSTANT</span><br><span class="line">        borderValue:可选，边界取值，有默认值Scalar()即<span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="tags"><a href="/tags/Python/"><i class="fa fa-tag"></i>Python</a><a href="/tags/Compete/"><i class="fa fa-tag"></i>Compete</a></div><div class="post-nav"><a class="pre" href="/2020/02/19/example-mengya/">萌芽杯项目的python代码</a><a class="next" href="/2020/02/18/learn-selector-jsoup/">厚墨书源学习如何制作</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15px;">前端</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Compete/" style="font-size: 15px;">Compete</a> <a href="/tags/Bilibili/" style="font-size: 15px;">Bilibili</a> <a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 15px;">单片机</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Note/" style="font-size: 15px;">Note</a> <a href="/tags/Spider/" style="font-size: 15px;">Spider</a> <a href="/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/Server/" style="font-size: 15px;">Server</a> <a href="/tags/Jsoup/" style="font-size: 15px;">Jsoup</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/VB/" style="font-size: 15px;">VB</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/C/" style="font-size: 15px;">C#</a> <a href="/tags/Questions/" style="font-size: 15px;">Questions</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Source/" style="font-size: 15px;">Source</a> <a href="/tags/Api/" style="font-size: 15px;">Api</a> <a href="/tags/Life/" style="font-size: 15px;">Life</a> <a href="/tags/Imagination/" style="font-size: 15px;">Imagination</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a><span class="category-list-count">34</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%83%B3%E8%B1%A1%E5%8A%9B/">想象力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%8A%9B/">技术力</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A0%E5%8A%9B/">无力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B5%84%E6%BA%90%E5%8A%9B/">资源力</a><span class="category-list-count">3</span></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Yun.Qi.</a> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> | Theme by<a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Maupassant</a><br/><span class="footer-birthday-text">Birthday</span><span class="footer-birthday-date">2020/02/04</span></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>