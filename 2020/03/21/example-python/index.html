<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="summary"><title>自己写的几个python小程序 | Yun.Qi</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.png"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">自己写的几个python小程序</h1><a id="logo" href="/.">Yun.Qi</a><p class="summary">Note/Diary</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/diary/"><i class="fa fa-book"> Diary</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">自己写的几个python小程序</h1><div class="post-meta">2020-03-21<span> | </span><span class="category"><a href="/categories/%E6%8A%80%E6%9C%AF%E5%8A%9B/">技术力</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2,660</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 15</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-每日手动记录支付宝基金余额"><span class="toc-text">1. 每日手动记录支付宝基金余额</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-只有一支基金时的代码"><span class="toc-text">1.1 只有一支基金时的代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-三支基金时的代码"><span class="toc-text">1.2 三支基金时的代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-图中图——将一幅图套娃"><span class="toc-text">2. 图中图——将一幅图套娃</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-好奇心——用程序检查哪些网站能打开"><span class="toc-text">3. 好奇心——用程序检查哪些网站能打开</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-初步，只能检查-IP-地址-不成熟的探索"><span class="toc-text">3.1 初步，只能检查 IP 地址##不成熟的探索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-开始加一点细节，也不太完善"><span class="toc-text">3.2 开始加一点细节，也不太完善</span></a></li></ol></li></ol></div></div><div class="post-content"><a id="more"></a>

<h1 id="1-每日手动记录支付宝基金余额"><a href="#1-每日手动记录支付宝基金余额" class="headerlink" title="1. 每日手动记录支付宝基金余额"></a>1. 每日手动记录支付宝基金余额</h1><h2 id="1-1-只有一支基金时的代码"><a href="#1-1-只有一支基金时的代码" class="headerlink" title="1.1 只有一支基金时的代码"></a>1.1 只有一支基金时的代码</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> xl</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> plotly.offline <span class="keyword">as</span> ptly</span><br><span class="line"><span class="keyword">import</span> plotly.graph_objs <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">daily_init</span><span class="params">()</span>:</span></span><br><span class="line">    wb = Workbook()</span><br><span class="line">    ws = wb.active</span><br><span class="line">    ws[<span class="string">'A1'</span>] = <span class="string">'日期'</span></span><br><span class="line">    ws[<span class="string">'B1'</span>] = <span class="string">'基金余额'</span></span><br><span class="line">    ws[<span class="string">'A2'</span>] = <span class="string">'03/21/20'</span></span><br><span class="line">    ws[<span class="string">'B2'</span>] = <span class="number">10.00</span></span><br><span class="line">    wb.save(<span class="string">'fund.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">daily_save</span><span class="params">()</span>:</span></span><br><span class="line">    filex = <span class="string">"fund.xlsx"</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filex):</span><br><span class="line">        wb = xl.load_workbook(<span class="string">'fund.xlsx'</span>)</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wb = Workbook()</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line"></span><br><span class="line">    ws = wb.active</span><br><span class="line">    ws[<span class="string">'A1'</span>] = <span class="string">'日期'</span></span><br><span class="line">    ws[<span class="string">'B1'</span>] = <span class="string">'基金余额'</span></span><br><span class="line">    ws[<span class="string">'A2'</span>] = <span class="string">'03/21/20'</span></span><br><span class="line">    ws[<span class="string">'B2'</span>] = <span class="number">10.00</span></span><br><span class="line"></span><br><span class="line">    today = datag()</span><br><span class="line">    td_yues = today[<span class="number">1</span>]</span><br><span class="line">    td_yue = td_yues[sheet.max_row<span class="number">-2</span>]</span><br><span class="line">    daily = float(input(<span class="string">"\n请输入今天的收益/亏损："</span>))</span><br><span class="line">    yue = td_yue + daily</span><br><span class="line"></span><br><span class="line">    dt = time.strftime(<span class="string">"%D"</span>, time.localtime())</span><br><span class="line">    maxrow = sheet.max_row + <span class="number">1</span></span><br><span class="line">    ws.cell(row=maxrow,column=<span class="number">1</span>,value=dt)</span><br><span class="line">    ws.cell(row=maxrow,column=<span class="number">2</span>,value=yue)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">f'\n数据已保存:<span class="subst">{dt}</span> \t <span class="subst">{yue}</span> \n'</span>)</span><br><span class="line">    wb.save(<span class="string">'fund.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">datag</span><span class="params">()</span>:</span></span><br><span class="line">    filex = <span class="string">'fund.xlsx'</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filex):</span><br><span class="line">        wb = xl.load_workbook(<span class="string">'fund.xlsx'</span>)</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wb = Workbook()</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line"></span><br><span class="line">    ws = wb.active</span><br><span class="line">    dts = []</span><br><span class="line">    yues = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">1</span>,max_col=<span class="number">1</span>,max_row=sheet.max_row ):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            dts.append(str(cell.value))</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">2</span>,max_col=<span class="number">2</span>,max_row=sheet.max_row ):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues.append(cell.value)</span><br><span class="line">    wb.save(<span class="string">'fund.xlsx'</span>)</span><br><span class="line">    <span class="keyword">return</span> dts,yues</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">datalook</span><span class="params">()</span>:</span></span><br><span class="line">    wb = xl.load_workbook(<span class="string">'fund.xlsx'</span>)</span><br><span class="line">    sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line">    ws = wb.active</span><br><span class="line">    dts = []</span><br><span class="line">    yues = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">1</span>,max_col=<span class="number">1</span>,max_row=sheet.max_row ):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            dts.append(str(cell.value))</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">2</span>,max_col=<span class="number">2</span>,max_row=sheet.max_row ):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues.append(cell.value)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(sheet.max_row<span class="number">-1</span>):</span><br><span class="line">        print(dts[i],end=<span class="string">'\t'</span>)</span><br><span class="line">        print(yues[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># def check():</span></span><br><span class="line"><span class="comment">#     # 读取Excel中Sheet中的数据</span></span><br><span class="line"><span class="comment">#     data = pd.DataFrame(pd.read_excel('fund.xlsx', 'Sheet'))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # 查看读取数据内容</span></span><br><span class="line"><span class="comment">#     print(data)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # 查看是否有重复行</span></span><br><span class="line"><span class="comment">#     re_row = data.duplicated()</span></span><br><span class="line"><span class="comment">#     print(re_row)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # 查看去除重复行的数据</span></span><br><span class="line"><span class="comment">#     no_re_row = data.drop_duplicates()</span></span><br><span class="line"><span class="comment">#     print(no_re_row)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # 查看基于[物品]列去除重复行的数据</span></span><br><span class="line"><span class="comment">#     wp = data.drop_duplicates(['日期'])</span></span><br><span class="line"><span class="comment">#     print(wp)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # 将去除重复行的数据输出到excel表中</span></span><br><span class="line"><span class="comment">#     no_re_row.to_excel("fund.xlsx")</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">qs</span><span class="params">()</span>:</span></span><br><span class="line">    dys = datag()</span><br><span class="line">    dts = dys[<span class="number">0</span>]</span><br><span class="line">    yues = dys[<span class="number">1</span>]</span><br><span class="line">    data = []</span><br><span class="line"></span><br><span class="line">    trace1 = go.Scatter(x=dts,</span><br><span class="line">                        y=yues,</span><br><span class="line">                        mode=<span class="string">'lines+markers'</span>,  <span class="comment"># mode可选'markers','lines','lines+markers'</span></span><br><span class="line">                        name= <span class="string">'Money'</span>,</span><br><span class="line">                        marker=dict(size=<span class="number">10</span>,  <span class="comment"># 若设为变量则可用散点大小表示变量大小</span></span><br><span class="line">                                    color=<span class="string">'rgba(152, 0, 0, .8)'</span>,</span><br><span class="line">                                    line=dict(width=<span class="number">2</span>,</span><br><span class="line">                                                color=<span class="string">'rgb(0, 0, 0)'</span></span><br><span class="line">                                                ),</span><br><span class="line">                                    opacity=[]</span><br><span class="line">                                    )</span><br><span class="line">                        )</span><br><span class="line">    data.append(trace1)</span><br><span class="line">    axis_template = dict(</span><br><span class="line">        showgrid=<span class="literal">True</span>,  <span class="comment"># 网格</span></span><br><span class="line">        zeroline=<span class="literal">True</span>,  <span class="comment"># 是否显示基线,即沿着(0,0)画出x轴和y轴</span></span><br><span class="line">        nticks=<span class="number">20</span>,</span><br><span class="line">        showline=<span class="literal">True</span>,</span><br><span class="line">        title=<span class="string">'Date'</span>,</span><br><span class="line">        mirror=<span class="string">'all'</span>,</span><br><span class="line">        zerolinecolor=<span class="string">"#FF0000"</span></span><br><span class="line">    )</span><br><span class="line">    ayis_template = dict(</span><br><span class="line">        showgrid=<span class="literal">True</span>,  <span class="comment"># 网格</span></span><br><span class="line">        zeroline=<span class="literal">True</span>,  <span class="comment"># 是否显示基线,即沿着(0,0)画出x轴和y轴</span></span><br><span class="line">        nticks=<span class="number">20</span>,</span><br><span class="line">        showline=<span class="literal">True</span>,</span><br><span class="line">        title=<span class="string">'Money'</span>,</span><br><span class="line">        mirror=<span class="string">'all'</span>,</span><br><span class="line">        zerolinecolor=<span class="string">"#FF0000"</span></span><br><span class="line">    )</span><br><span class="line">    layout = go.Layout(font=dict(family=<span class="string">'Courier New, monospace'</span>, size=<span class="number">18</span>, color=<span class="string">'#3D3D3D'</span>),</span><br><span class="line">                        title=<span class="string">'基金实况'</span> ,xaxis=axis_template,yaxis=ayis_template</span><br><span class="line">                        )</span><br><span class="line">    fig = go.Figure(data=data, layout=layout)</span><br><span class="line">    ptly.plot(fig, filename=<span class="string">'fund.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    filexx = <span class="string">'fund.xlsx'</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filexx):</span><br><span class="line">        print(<span class="string">'----什么？这是你的第一次？好了，已经帮你弄好了（指初始化）----'</span>)</span><br><span class="line">        daily_init()</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = int(input(<span class="string">'今天是否保存过数据了呢？0/1：'</span>))</span><br><span class="line">        <span class="keyword">if</span> p == <span class="number">1</span> :</span><br><span class="line">            print(<span class="string">'\n----哦，你已经好了？那算了----\n'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            daily_save()</span><br><span class="line">            print(<span class="string">'----好了，保存好了----\n'</span>)</span><br><span class="line">    pd = int(input(<span class="string">'想不想看一下趋势图-0/1：'</span>))</span><br><span class="line">    <span class="keyword">if</span> pd == <span class="number">1</span> :</span><br><span class="line">        print(<span class="string">'\n----那就给你看一下吧----\n'</span>)</span><br><span class="line">        qs()</span><br><span class="line">        datalook()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'\n----既然不想看，那就算了吧----'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>然后可以再桌面新建一个<code>fund.bat</code>脚本直接运行</p>
<figure class="highlight bat"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">e:</span></span><br><span class="line"><span class="function"><span class="title">cd</span> <span class="title">E</span>:/<span class="title">learn</span>/<span class="title">py</span>/<span class="title">fund</span>	# 进入到<span class="title">fund</span>所在目录</span></span><br><span class="line"><span class="function"><span class="title">python</span> <span class="title">fund.py</span>		# 运行<span class="title">python</span>文件</span></span><br><span class="line"><span class="function"><span class="title">pause</span>				# 让屏幕停留</span></span><br></pre></td></tr></tbody></table></figure>

<p>功能：可以记录日常的基金走势，然后记录数据</p>
<p>不足：不能够自动删除 excel 中的重复的数据，（如同一天的数据）</p>
<h2 id="1-2-三支基金时的代码"><a href="#1-2-三支基金时的代码" class="headerlink" title="1.2 三支基金时的代码"></a>1.2 三支基金时的代码</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> xl</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> plotly.offline <span class="keyword">as</span> ptly</span><br><span class="line"><span class="keyword">import</span> plotly.graph_objs <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据初始化</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">daily_init</span><span class="params">()</span>:</span></span><br><span class="line">    wb = Workbook()</span><br><span class="line">    ws = wb.active</span><br><span class="line">    ws[<span class="string">'A1'</span>] = <span class="string">'日期'</span></span><br><span class="line">    ws[<span class="string">'B1'</span>] = <span class="string">'总额'</span></span><br><span class="line">    ws[<span class="string">'C1'</span>] = <span class="string">'嘉合'</span></span><br><span class="line">    ws[<span class="string">'D1'</span>] = <span class="string">'白酒'</span></span><br><span class="line">    ws[<span class="string">'E1'</span>] = <span class="string">'沪深'</span></span><br><span class="line"></span><br><span class="line">    ws[<span class="string">'A2'</span>] = <span class="string">'04/04/20'</span></span><br><span class="line">    ws[<span class="string">'B2'</span>] = <span class="number">810.00</span></span><br><span class="line">    ws[<span class="string">'C2'</span>] = <span class="number">100.00</span></span><br><span class="line">    ws[<span class="string">'D2'</span>] = <span class="number">210.00</span></span><br><span class="line">    ws[<span class="string">'E2'</span>] = <span class="number">500.00</span></span><br><span class="line">    wb.save(<span class="string">'fund3.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据保存</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">daily_save</span><span class="params">()</span>:</span></span><br><span class="line">    filex = <span class="string">"fund3.xlsx"</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filex):</span><br><span class="line">        wb = xl.load_workbook(<span class="string">'fund3.xlsx'</span>)</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wb = Workbook()</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line"></span><br><span class="line">    ws = wb.active</span><br><span class="line">    ws[<span class="string">'A1'</span>] = <span class="string">'日期'</span></span><br><span class="line">    ws[<span class="string">'B1'</span>] = <span class="string">'总额'</span></span><br><span class="line">    ws[<span class="string">'C1'</span>] = <span class="string">'嘉合'</span></span><br><span class="line">    ws[<span class="string">'D1'</span>] = <span class="string">'白酒'</span></span><br><span class="line">    ws[<span class="string">'E1'</span>] = <span class="string">'沪深'</span></span><br><span class="line"></span><br><span class="line">    ws[<span class="string">'A2'</span>] = <span class="string">'04/04/20'</span></span><br><span class="line">    ws[<span class="string">'B2'</span>] = <span class="number">810.00</span></span><br><span class="line">    ws[<span class="string">'C2'</span>] = <span class="number">100.00</span></span><br><span class="line">    ws[<span class="string">'D2'</span>] = <span class="number">210.00</span></span><br><span class="line">    ws[<span class="string">'E2'</span>] = <span class="number">500.00</span></span><br><span class="line"></span><br><span class="line">    today = datag()</span><br><span class="line">    td_yues1 = today[<span class="number">1</span>]</span><br><span class="line">    td_yue1 = td_yues1[sheet.max_row<span class="number">-2</span>]</span><br><span class="line">    td_yues2 = today[<span class="number">2</span>]</span><br><span class="line">    td_yue2 = td_yues2[sheet.max_row<span class="number">-2</span>]</span><br><span class="line">    td_yues3 = today[<span class="number">3</span>]</span><br><span class="line">    td_yue3 = td_yues3[sheet.max_row<span class="number">-2</span>]</span><br><span class="line"></span><br><span class="line">    daily1 = float(input(<span class="string">"\n请输入嘉和今天的收益/亏损："</span>))</span><br><span class="line">    daily2 = float(input(<span class="string">"\n请输入白酒今天的收益/亏损："</span>))</span><br><span class="line">    daily3 = float(input(<span class="string">"\n请输入沪深今天的收益/亏损："</span>))</span><br><span class="line">    yue1 = td_yue1 + daily1</span><br><span class="line">    yue2 = td_yue2 + daily2</span><br><span class="line">    yue3 = td_yue3 + daily3</span><br><span class="line">    yue0 = round(yue1,<span class="number">2</span>) + round(yue2,<span class="number">2</span>) + round(yue3,<span class="number">2</span>)</span><br><span class="line">    dt = time.strftime(<span class="string">"%D"</span>, time.localtime())</span><br><span class="line">    maxrow = sheet.max_row + <span class="number">1</span></span><br><span class="line">    ws.cell(row=maxrow, column=<span class="number">1</span>, value=dt)</span><br><span class="line">    ws.cell(row=maxrow, column=<span class="number">2</span>, value=yue0)</span><br><span class="line">    ws.cell(row=maxrow, column=<span class="number">3</span>, value=yue1)</span><br><span class="line">    ws.cell(row=maxrow, column=<span class="number">4</span>, value=yue2)</span><br><span class="line">    ws.cell(row=maxrow, column=<span class="number">5</span>, value=yue3)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">f'\n数据已保存:<span class="subst">{dt}</span> \t <span class="subst">{yue0}</span> == <span class="subst">{yue1}</span> + <span class="subst">{yue2}</span> + <span class="subst">{yue3}</span> \n'</span>)</span><br><span class="line">    wb.save(<span class="string">'fund3.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据获取</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">datag</span><span class="params">()</span>:</span></span><br><span class="line">    filex = <span class="string">'fund3.xlsx'</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filex):</span><br><span class="line">        wb = xl.load_workbook(<span class="string">'fund3.xlsx'</span>)</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        wb = Workbook()</span><br><span class="line">        sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line"></span><br><span class="line">    ws = wb.active</span><br><span class="line">    dts = []</span><br><span class="line"></span><br><span class="line">    yues1 = []</span><br><span class="line">    yues2 = []</span><br><span class="line">    yues3 = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">1</span>, max_col=<span class="number">1</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            dts.append(str(cell.value))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">3</span>, max_col=<span class="number">3</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues1.append(cell.value)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">4</span>, max_col=<span class="number">4</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues2.append(cell.value)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">5</span>, max_col=<span class="number">5</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues3.append(cell.value)</span><br><span class="line">    wb.save(<span class="string">'fund3.xlsx'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dts, yues1, yues2, yues3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 看数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">datalook</span><span class="params">()</span>:</span></span><br><span class="line">    wb = xl.load_workbook(<span class="string">'fund3.xlsx'</span>)</span><br><span class="line">    sheet = wb[<span class="string">'Sheet'</span>]</span><br><span class="line">    ws = wb.active</span><br><span class="line">    dts = []</span><br><span class="line">    yues0 = []</span><br><span class="line">    yues1 = []</span><br><span class="line">    yues2 = []</span><br><span class="line">    yues3 = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">1</span>, max_col=<span class="number">1</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            dts.append(str(cell.value))</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">2</span>, max_col=<span class="number">2</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues0.append(cell.value)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">3</span>, max_col=<span class="number">3</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues1.append(cell.value)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">4</span>, max_col=<span class="number">4</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues2.append(cell.value)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, min_col=<span class="number">5</span>, max_col=<span class="number">5</span>, max_row=sheet.max_row):</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">            yues3.append(cell.value)</span><br><span class="line">    yues0r = [round(i,<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> yues0]</span><br><span class="line">    print(<span class="string">'日期'</span>,end=<span class="string">'\t\t'</span>)</span><br><span class="line">    print(<span class="string">'总额'</span>,end=<span class="string">'\t\t'</span>)</span><br><span class="line">    print(<span class="string">'嘉合'</span>,end=<span class="string">'\t'</span>)</span><br><span class="line">    print(<span class="string">'白酒'</span>,end=<span class="string">'\t'</span>)</span><br><span class="line">    print(<span class="string">'沪深'</span>,end=<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(sheet.max_row<span class="number">-1</span>):</span><br><span class="line">        print(dts[i], end=<span class="string">'\t'</span>)</span><br><span class="line">        print(yues0r[i],end=<span class="string">'\t\t'</span>)</span><br><span class="line">        print(yues1[i],end=<span class="string">'\t'</span>)</span><br><span class="line">        print(yues2[i],end=<span class="string">'\t'</span>)</span><br><span class="line">        print(yues3[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 看趋势图</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">qs</span><span class="params">()</span>:</span></span><br><span class="line">    dys = datag()</span><br><span class="line">    dts = dys[<span class="number">0</span>]</span><br><span class="line">    yues1 = dys[<span class="number">1</span>]</span><br><span class="line">    yues2 = dys[<span class="number">2</span>]</span><br><span class="line">    yues3 = dys[<span class="number">3</span>]</span><br><span class="line">    data = []</span><br><span class="line"></span><br><span class="line">    trace1 = go.Scatter(x=dts,</span><br><span class="line">                        y=yues1,</span><br><span class="line">                        mode=<span class="string">'lines+markers'</span>,  <span class="comment"># mode可选'markers','lines','lines+markers'</span></span><br><span class="line">                        name=<span class="string">'嘉和'</span>,</span><br><span class="line">                        marker=dict(size=<span class="number">10</span>,  <span class="comment"># 若设为变量则可用散点大小表示变量大小</span></span><br><span class="line">                                    color=<span class="string">'rgba(152, 0, 0, .8)'</span>,</span><br><span class="line">                                    line=dict(width=<span class="number">2</span>,</span><br><span class="line">                                              color=<span class="string">'rgb(0, 0, 0)'</span></span><br><span class="line">                                              ),</span><br><span class="line">                                    opacity=[]</span><br><span class="line">                                    )</span><br><span class="line">                        )</span><br><span class="line">    trace2 = go.Scatter(x=dts,</span><br><span class="line">                        y=yues2,</span><br><span class="line">                        mode=<span class="string">'lines+markers'</span>,  <span class="comment"># mode可选'markers','lines','lines+markers'</span></span><br><span class="line">                        name=<span class="string">'白酒'</span>,</span><br><span class="line">                        marker=dict(size=<span class="number">10</span>,  <span class="comment"># 若设为变量则可用散点大小表示变量大小</span></span><br><span class="line">                                    color=<span class="string">'rgba( 0,152, 0, .8)'</span>,</span><br><span class="line">                                    line=dict(width=<span class="number">2</span>,</span><br><span class="line">                                              color=<span class="string">'rgb(0, 0, 0)'</span></span><br><span class="line">                                              ),</span><br><span class="line">                                    opacity=[]</span><br><span class="line">                                    )</span><br><span class="line">                        )</span><br><span class="line">    trace3 = go.Scatter(x=dts,</span><br><span class="line">                        y=yues3,</span><br><span class="line">                        mode=<span class="string">'lines+markers'</span>,  <span class="comment"># mode可选'markers','lines','lines+markers'</span></span><br><span class="line">                        name=<span class="string">'沪深'</span>,</span><br><span class="line">                        marker=dict(size=<span class="number">10</span>,  <span class="comment"># 若设为变量则可用散点大小表示变量大小</span></span><br><span class="line">                                    color=<span class="string">'rgba( 0, 0, 152,.8)'</span>,</span><br><span class="line">                                    line=dict(width=<span class="number">2</span>,</span><br><span class="line">                                              color=<span class="string">'rgb(0, 0, 0)'</span></span><br><span class="line">                                              ),</span><br><span class="line">                                    opacity=[]</span><br><span class="line">                                    )</span><br><span class="line">                        )</span><br><span class="line"></span><br><span class="line">    data = [trace1, trace2, trace3]</span><br><span class="line">    axis_template = dict(</span><br><span class="line">        showgrid=<span class="literal">True</span>,  <span class="comment"># 网格</span></span><br><span class="line">        zeroline=<span class="literal">True</span>,  <span class="comment"># 是否显示基线,即沿着(0,0)画出x轴和y轴</span></span><br><span class="line">        nticks=<span class="number">20</span>,</span><br><span class="line">        showline=<span class="literal">True</span>,</span><br><span class="line">        title=<span class="string">'Date'</span>,</span><br><span class="line">        mirror=<span class="string">'all'</span>,</span><br><span class="line">        zerolinecolor=<span class="string">"#FF0000"</span></span><br><span class="line">    )</span><br><span class="line">    ayis_template = dict(</span><br><span class="line">        showgrid=<span class="literal">True</span>,  <span class="comment"># 网格</span></span><br><span class="line">        zeroline=<span class="literal">True</span>,  <span class="comment"># 是否显示基线,即沿着(0,0)画出x轴和y轴</span></span><br><span class="line">        nticks=<span class="number">20</span>,</span><br><span class="line">        showline=<span class="literal">True</span>,</span><br><span class="line">        title=<span class="string">'Money'</span>,</span><br><span class="line">        mirror=<span class="string">'all'</span>,</span><br><span class="line">        zerolinecolor=<span class="string">"#FF0000"</span></span><br><span class="line">    )</span><br><span class="line">    layout = go.Layout(font=dict(family=<span class="string">'Courier New, monospace'</span>, size=<span class="number">18</span>, color=<span class="string">'#3D3D3D'</span>),</span><br><span class="line">                       title=<span class="string">'基金实况'</span>, xaxis=axis_template, yaxis=ayis_template</span><br><span class="line">                       )</span><br><span class="line">    fig = go.Figure(data=data, layout=layout)</span><br><span class="line">    ptly.plot(fig, filename=<span class="string">'fund3.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    filexx = <span class="string">'fund3.xlsx'</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filexx):</span><br><span class="line">        print(<span class="string">'----什么？这是你的第一次？好了，已经帮你弄好了（指初始化）----'</span>)</span><br><span class="line">        daily_init()</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = int(input(<span class="string">'今天是否保存过数据了呢？0/1：'</span>))</span><br><span class="line">        <span class="keyword">if</span> p == <span class="number">1</span>:</span><br><span class="line">            print(<span class="string">'\n----哦，你已经好了？那算了----\n'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            daily_save()</span><br><span class="line">            print(<span class="string">'----好了，保存好了----\n'</span>)</span><br><span class="line">    pd = int(input(<span class="string">'想不想看一下趋势图-0/1：'</span>))</span><br><span class="line">    <span class="keyword">if</span> pd == <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">'\n----那就给你看一下吧----\n'</span>)</span><br><span class="line">        qs()</span><br><span class="line">        datalook()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'\n----既然不想看，那就算了吧----'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>

<h1 id="2-图中图——将一幅图套娃"><a href="#2-图中图——将一幅图套娃" class="headerlink" title="2. 图中图——将一幅图套娃"></a>2. 图中图——将一幅图套娃</h1><p><a href="https://space.bilibili.com/39665558" target="_blank" rel="noopener">迷糊老师</a>的程序，hhh 很好玩，b 站<a href="https://www.bilibili.com/video/BV1QE411P7GV" target="_blank" rel="noopener">迷糊老师视频</a></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill_img_with_img</span><span class="params">(imgParent, imgChild)</span>:</span></span><br><span class="line">    imgSize =(imgParent.width*imgChild.width, imgParent.height*imgChild.height)</span><br><span class="line">    imgRet = Image.new(<span class="string">'L'</span>, imgSize, <span class="string">'white'</span>)</span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> range(imgParent.width):</span><br><span class="line">        print(i)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> range(imgParent.height):</span><br><span class="line">            <span class="keyword">if</span> imgParent.getpixel((w, h)) &lt; <span class="number">127</span>:</span><br><span class="line">                imgRet.paste(imgChild,(w*imgChild.width, h*imgChild.height))</span><br><span class="line">    <span class="keyword">return</span> imgRet</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    imgParent = Image.open(<span class="string">'parent.jpg'</span>)</span><br><span class="line">    imgParent = imgParent.convert(<span class="string">'L'</span>)</span><br><span class="line"></span><br><span class="line">    imgChild = Image.open(<span class="string">'child2.png'</span>)</span><br><span class="line">    imgChild = imgChild.convert(<span class="string">'L'</span>)</span><br><span class="line"></span><br><span class="line">    imgRet = fill_img_with_img(imgParent,imgChild)</span><br><span class="line"></span><br><span class="line">    imgRet.save(<span class="string">'result.png'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h1 id="3-好奇心——用程序检查哪些网站能打开"><a href="#3-好奇心——用程序检查哪些网站能打开" class="headerlink" title="3. 好奇心——用程序检查哪些网站能打开"></a>3. 好奇心——用程序检查哪些网站能打开</h1><h2 id="3-1-初步，只能检查-IP-地址-不成熟的探索"><a href="#3-1-初步，只能检查-IP-地址-不成熟的探索" class="headerlink" title="3.1 初步，只能检查 IP 地址##不成熟的探索"></a>3.1 初步，只能检查 IP 地址##不成熟的探索</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> error , request</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'re.txt'</span>,<span class="string">"w"</span>,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">255</span>):</span><br><span class="line">    htmls = []</span><br><span class="line">    https = []</span><br><span class="line">    http = <span class="string">'http://123.56.22.'</span> + str(i)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        reponse = request.urlopen(http)</span><br><span class="line">        https.append(http)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        print(<span class="string">f'这是第<span class="subst">{j}</span>个网站了'</span>)</span><br><span class="line">        f.write(<span class="string">'url'</span> + <span class="string">'\t'</span> + http + <span class="string">'\n'</span> )</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span> error.URLError <span class="keyword">as</span> e:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">        print(<span class="string">f'访问页面出错1,<span class="subst">{k}</span>次了'</span>)</span><br><span class="line">    <span class="keyword">except</span> urllib.error.URLError:</span><br><span class="line">        print(<span class="string">'访问页面出错2'</span>)</span><br><span class="line"><span class="comment"># print(f'总共是{https}')</span></span><br><span class="line">f.close()</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3-2-开始加一点细节，也不太完善"><a href="#3-2-开始加一点细节，也不太完善" class="headerlink" title="3.2 开始加一点细节，也不太完善"></a>3.2 开始加一点细节，也不太完善</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="tags"><a href="/tags/Python/"><i class="fa fa-tag"></i>Python</a></div><div class="post-nav"><a class="pre" href="/2020/03/25/note-hcj/">前端开发的基础知识</a><a class="next" href="/2020/03/18/tools-wt/">WindowsTerminal的配置</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15px;">前端</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Bilibili/" style="font-size: 15px;">Bilibili</a> <a href="/tags/Compete/" style="font-size: 15px;">Compete</a> <a href="/tags/Spider/" style="font-size: 15px;">Spider</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Note/" style="font-size: 15px;">Note</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/Jsoup/" style="font-size: 15px;">Jsoup</a> <a href="/tags/Server/" style="font-size: 15px;">Server</a> <a href="/tags/VB/" style="font-size: 15px;">VB</a> <a href="/tags/C/" style="font-size: 15px;">C#</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/Questions/" style="font-size: 15px;">Questions</a> <a href="/tags/Api/" style="font-size: 15px;">Api</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Source/" style="font-size: 15px;">Source</a> <a href="/tags/Life/" style="font-size: 15px;">Life</a> <a href="/tags/Imagination/" style="font-size: 15px;">Imagination</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E5%8A%9B/">学习力</a><span class="category-list-count">32</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%83%B3%E8%B1%A1%E5%8A%9B/">想象力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%8A%9B/">技术力</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A0%E5%8A%9B/">无力</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B5%84%E6%BA%90%E5%8A%9B/">资源力</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/07/review-vb/">VB的作业和复习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/26/css-project-study/">CSS学习中跟着老师做的几个项目</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/09/learn-ks/">快捷键——让学习更高效</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/08/note-cs/">C#-Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/python-threading/">Python多线程学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/yq-fund/">理财笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/02/python-pyqt/">Python中PyQt库的学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/31/python-schedule/">Python中schedule库的学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/31/python-pil/">Python中PIL库的学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/25/note-hcj/">前端开发的基础知识</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Yun.Qi.</a> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> | Theme by<a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Maupassant</a><br/><span class="footer-birthday-text">Birthday</span><span class="footer-birthday-date">2020/02/04</span></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>